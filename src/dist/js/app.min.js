function Trader(e,t,a,r,i){this.name=e,this.amount=t,this.inAt=a,this.comment=i,this.isShort=r,this.difference=0,this.drawable=new Drawable,this.drawable.color="#ffffff",this.drawable.borderColor="#B3B369",this.drawable.borderWidth=2,this.drawable.borderScaling=!1,this.drawable.textFont="SourceSansPro",this.drawable.textAnchor=new Vector2D(0,1),this.drawable.textBackground="#ffffff",this.drawable.textPadding=new Vector2D(0,0),this.drawable.textScaling=!1,this.drawable.textPos=new Vector2D(1,-1),this.drawable.textColor="#2C3E50",this.drawable.pos=new Vector2D(0,0),this.drawable.radius=25,this.drawable.show=!1,this["new"]=!0,this.open=!1,this.changeStockPrice=function(e){var r="[b]"+this.name+"[/b][align=right][color=",i=Math.floor((e-this.inAt)*this.amount*100)/100,n="#36B5DB",o="#E74C3C";this.isShort?this.difference=-i:this.difference=i,r+=this.difference>=0?n+"]":o+"]",r+=this.difference.toLocaleString("be-NL",{style:"currency",currency:"EUR"})+"[/color][/align]\n[i][color=",r+=this.isShort?o+"]":n+"]",r+=t,r+=this.isShort?" short at ":" long at ",r+=a.toLocaleString("be-NL",{style:"currency",currency:"EUR"})+"[/color][/i]\n",this.drawable.setText(r+this.comment)},this.draw=function(e,t){if(this.drawable.show){var a=this.drawable.pos.rotate(this.drawable.rotation);e.save(),e.globalAlpha*=this.drawable.opacity,e.translate(a.x,a.y),this.drawable.drawCircle(e),this.drawable.drawImageInCircle(e),this.drawable.drawBorderForCircle(e,t),e.restore()}},this.postDraw=function(e,t){if(this.drawable.show){var a=this.drawable.pos.rotate(this.drawable.rotation);e.save(),e.globalAlpha*=this.drawable.opacity,e.translate(a.x,a.y),this.drawable.drawText(e,t),e.restore()}},this.clicked=function(){var e=this;this.open?(this.drawable.animate("textSize",0,200,"easeInOut",null),this.drawable.animateVector("textPadding",new Vector2D(0,0),200,"easeInOut",function(t,a){t&&(e.open=!1)})):(this.drawable.animate("textSize",12,200,"easeInOut",null),this.drawable.animateVector("textPadding",new Vector2D(10,10),200,"easeInOut",function(t,a){t&&(e.open=!0)}))},this["delete"]=function(e,t){var a=0;"undefined"!=typeof t&&(a=t);for(var r=e.length;r>a;a++)if("undefined"!=typeof e[a].traders){var i=e[a].traders.indexOf(this);if(i>-1){e[a].traders.splice(i,1),e[a].calcTraders(),0===e[a].traders.length&&e[a].animateDelete(e,a);break}}},this.interaction=function(e,t){var a=e.subVector(this.drawable.pos.rotate(this.drawable.rotation).mul(t)),r=0;return 0!==this.drawable.radius&&(r=this.drawable.radius*t),0!==this.drawable.size.length()&&(r=this.drawable.size.length()*t),a.length()<=r&&this.drawable.show?(this["new"]&&(this["new"]=!1,this.drawable.borderColor="#eeeeee"),this):!1}}var Trade=function(e,a,r,i){this.id=e,this.stockPrice=a,this.traders=r,this.drawable=new Drawable,this.difference=0;for(var n=0,o=this.traders.length;o>n;n++)this.traders[n].changeStockPrice(this.stockPrice),this.difference+=this.traders[n].difference;if(this.difference=Math.floor(100*this.difference)/100,this.drawable.setText(this.difference.toLocaleString("be-NL",{style:"currency",currency:"EUR"})),this.difference>=0?(this.drawable.textBackground="#36B5DB",this.drawable.textReplaceColor="#36B5DB"):(this.drawable.textBackground="#E74C3C",this.drawable.textReplaceColor="#E74C3C"),this.lineColor="#B3B369",this.open=!1,this.drawable.textSize=10,this.drawable.radius=Math.floor(35*Math.random()+35),this.drawable.imgFill=!1,null===i){for(var s=Math.floor(Math.random()*window.innerWidth-window.innerWidth/2),d=Math.floor(Math.random()*(window.innerHeight-50)-(window.innerHeight-50)/2);new Vector2D(s,d).length()<100+this.drawable.radius||new Vector2D(s,d).length()>new Vector2D(window.innerWidth,window.innerHeight-50).div(2).length()-this.drawable.radius;)s=Math.floor(Math.random()*window.innerWidth-window.innerWidth/2),d=Math.floor(Math.random()*(window.innerHeight-50)-(window.innerHeight-50)/2);this.drawable.animateVector("pos",new Vector2D(s,d),1e3,"easeInOut",null)}else this.drawable.animateVector("pos",i,1e3,"easeInOut",null);this.drawable.color="#ffffff",this.drawable.borderWidth=2,this.drawable.borderColor="#B3B369",this.drawable.borderScaling=!1,this.drawable.textColor="#ffffff",this.drawable.textFont="SourceSansPro",this.drawable.textAnchor=new Vector2D(.5,.5),this.drawable.textPos=new Vector2D(0,.5),this.drawable.textPadding=new Vector2D(10,10),this.drawable.textReplace=15;var l=this;setInterval(function(){var e=Math.random()/10,t=Math.floor(2*Math.random());1===t&&(e=-e),l.stockPrice=Math.floor(100*(l.stockPrice+e))/100,l.difference=0;for(var a=0,r=l.traders.length;r>a;a++)l.traders[a].changeStockPrice(l.stockPrice),l.difference+=l.traders[a].difference;l.difference=Math.floor(100*l.difference)/100,l.open?(l.difference>=0?l.drawable.textReplaceColor="#36B5DB":l.drawable.textReplaceColor="#E74C3C",l.drawable.textBackground="#2C3E50",l.drawable.setText(l.stockPrice.toLocaleString("be-NL",{style:"currency",currency:"EUR"}))):(l.drawable.setText(l.difference.toLocaleString("be-NL",{style:"currency",currency:"EUR"})),l.difference>=0?(l.drawable.textBackground="#36B5DB",l.drawable.textReplaceColor="#36B5DB"):(l.drawable.textBackground="#E74C3C",l.drawable.textReplaceColor="#E74C3C")),l.drawable.requestRedraw=!0},2e3),this.interaction=function(e,a){var r=e.subVector(this.drawable.pos.mul(a)),i=0;if(0!==this.drawable.radius&&(i=this.drawable.radius*a),0!==this.drawable.size.length()&&(i=this.drawable.size.length()*a),r.length()<=i)return this;for(var n=e.subVector(this.drawable.pos.mul(a)),o=0,s=this.traders.length;s>o;o++){var d=this.traders[o].interaction(n,a);if(d!==!1){for(var l=0,c=this.traders.length;c>l;l++)t=this.traders[l],t.open&&t.clicked();return d}}return!1},this.calcTraders=function(){for(var e=180/(this.traders.length+1),t=0,a=this.traders.length;a>t;t++){var r=e*(t+1-(this.traders.length+1)/2)-90;this.traders[t].drawable.animate("rotation",r,300,"easeInOut",null)}},this.calcTraders(),this.preDraw=function(e,t){if(this.drawable.show){e.save(),e.globalAlpha*=this.drawable.opacity,e.strokeStyle=this.lineColor,e.lineWidth=.5;for(var a=!1,r=0,i=this.traders.length;i>r;r++)this.traders[r]["new"]&&(a=!0);a?this.lineColor="#B3B369":this.lineColor="#2C3E50",e.beginPath(),e.moveTo(0,0),e.lineTo(this.drawable.pos.x,this.drawable.pos.y),e.closePath(),e.stroke(),e.restore()}},this.draw=function(e,t){if(this.drawable.show){e.save(),e.translate(this.drawable.pos.x,this.drawable.pos.y),e.globalAlpha*=this.drawable.opacity;for(var a=!1,r=0,i=this.traders.length;i>r;r++)this.traders[r].draw(e,t),this.traders[r]["new"]&&(a=!0);a?this.drawable.borderColor="#B3B369":this.drawable.borderColor="#eeeeee",this.drawable.drawCircle(e),this.drawable.drawImageInCircle(e),this.drawable.drawBorderForCircle(e,t),this.drawable.drawText(e,t),e.restore()}},this["delete"]=function(e){for(var t=e.indexOf(this),a=0,r=this.traders.length;r>a;a++)this.traders[0]["delete"](e,t)},this.animateDelete=function(e,t){this.drawable.animate("textSize",0,300,"easeInOut",null),this.drawable.animate("textReplace",0,300,"easeInOut",null),this.drawable.animateVector("textPadding",new Vector2D(0,0),300,"easeInOut",null),this.drawable.animate("opacity",0,300,"easeInOut",null),this.drawable.animate("radius",0,300,"easeInOut",function(){e.splice(t,1)})},this.postDraw=function(e,t){if(this.drawable.show){e.save(),e.globalAlpha*=this.drawable.opacity,e.translate(this.drawable.pos.x,this.drawable.pos.y);for(var a=0,r=this.traders.length;r>a;a++)this.traders[a].postDraw(e,t);e.restore()}},this.clicked=function(){var e=0,t=0,a=null,r=this;if(this.open){var i=function(e,t){t.show=!1};for(t=this.traders.length;t>e;e++)a=this.traders[e],a.open&&a.clicked(),a.drawable.animateVector("pos",new Vector2D(0,0),300,"easeInOut",i);this.drawable.animateVector("textPadding",new Vector2D(0,0),150,"easeIn",function(e,t){t.animateVector("textPadding",new Vector2D(10,10),150,"easeOut",null)}),this.drawable.animate("textReplace",0,150,"easeIn",function(e,t){t.animate("textReplace",15,150,"easeOut",null)}),this.drawable.animate("textSize",0,150,"easeIn",function(e,t){t.setText(r.difference.toLocaleString("be-NL",{style:"currency",currency:"EUR"})),r.difference>=0?t.textBackground="#36B5DB":t.textBackground="#E74C3C",r.open=!1,t.animate("textSize",10,150,"easeOut",null)})}else{for(t=this.traders.length;t>e;e++)a=this.traders[e],a.drawable.show=!0,a.drawable.animateVector("pos",new Vector2D(0,this.drawable.radius+a.drawable.radius+15),300,"easeInOut",null);this.drawable.animateVector("textPadding",new Vector2D(0,0),150,"easeIn",function(e,t){t.animateVector("textPadding",new Vector2D(10,10),150,"easeOut",null)}),this.drawable.animate("textReplace",0,150,"easeIn",function(e,t){t.animate("textReplace",15,150,"easeOut",null)}),this.drawable.animate("textSize",0,150,"easeIn",function(e,t){t.textBackground="#2C3E50",t.setText(r.stockPrice.toLocaleString("be-NL",{style:"currency",currency:"EUR"})),r.open=!0,t.animate("textSize",10,150,"easeOut",null)})}},this.requestRedraw=function(){for(var e=0,t=this.traders.length;t>e;e++)this.traders[e].drawable.requestRedraw&&(this.drawable.requestRedraw=!0,this.traders[e].drawable.requestRedraw=!1);return this.drawable.requestRedraw?(this.drawable.requestRedraw=!1,!0):!1}},tradeCanvas=function(e){if(null!==document.getElementById("trades")){var t=[],a=[],r=new Drawable,i=new Drawable;r.setImage(e.profilepicture,function(){p.draw()}),r.radius=100,r.color="#ffffff",r.borderColor="#eeeeee",r.borderScaling=!1,r.borderWidth=2,r.textSize=12,r.textColor="#ffffff",r.textFont="SourceSansPro",r.textAnchor=new Vector2D(.5,.5),r.textPos=new Vector2D(0,.5),r.textPadding=new Vector2D(10,10),r.textReplace=15,r.draw=function(e,t){this.drawCircle(e),this.drawImageInCircle(e),this.drawBorderForCircle(e,t),this.drawText(e,t)},i.setImage("dist/images/misc/trash.svg",function(){p.draw()}),i.radius=50,i.color="#eeeeee",i.borderColor="#eeeeee",i.borderScaling=!1,i.borderWidth=2,i.pos=new Vector2D(window.innerWidth-100,window.innerHeight-150),i.interaction=function(e){var t=e.subVector(p.margin).subVector(this.pos),a=this.radius*p.scale;return t.length()<=a&&this.show},i.draw=function(e,t){var a=this.pos.subVector(p.offset).subVector(p.center).mul(1/p.scale);e.save(),e.translate(a.x,a.y),this.drawCircle(e),this.drawImageInCircle(e),this.drawBorderForCircle(e,t),e.restore()};for(var n=0,o=0,s=e.trades.length;s>o;o++){var d=e.trades[o];if(void 0!==d.StopStockPrice||d.StopStockPrice<0){var l,c;"undefined"==typeof d.parentTrade&&(c=new Trader(e.firstname+" "+e.lastname,d.AmountInvested/d.StartStockPrice,d.StartStockPrice,d.IsShort,d.Comment),c.drawable.setImage(e.profilepicture));for(var h=!1,w=0,u=a.length;u>w;w++)if(l=a[w],l.id===d.Company._id){h=!0,l.traders.push(c);break}h||(l={id:d.Company._id,stockPrice:d.Company.CurrentStockPrice,traders:[c],image:d.Company.Image},a.push(l))}}for(var f=0,b=a.length;b>f;f++){var g=new Trade(a[f].id,a[f].stockPrice,a[f].traders,null);g.drawable.setImage(a[f].image),t.push(g)}t.push(r),t.push(i),n>=0?(r.textBackground="#36B5DB",r.textReplaceColor="#36B5DB"):(r.textBackground="#E74C3C",r.textReplaceColor="#E74C3C"),r.setText((Math.floor(100*n)/100).toLocaleString("be-NL",{style:"currency",currency:"EUR"}));var p=new Canvas(0,50,window.innerWidth,window.innerHeight-50,"trades",t);p.drawCallback=function(){for(var e=0,t=0,a=p.objects.length;a>t;t++)"undefined"!=typeof p.objects[t].difference&&(e+=p.objects[t].difference);e>=0?(r.textBackground="#36B5DB",r.textReplaceColor="#36B5DB"):(r.textBackground="#E74C3C",r.textReplaceColor="#E74C3C"),r.setText((Math.floor(100*e)/100).toLocaleString("be-NL",{style:"currency",currency:"EUR"}))},document.body.addEventListener("touchstart",function(e){e.preventDefault()}),document.getElementById("trades").addEventListener("mousedown",function(e){m(e)}),document.getElementById("trades").addEventListener("touchstart",function(e){var t=e.touches[0];m(t)});var m=function(e){p.interactionStart(e,function(e,t){var a;e instanceof Trade&&(a=p.objects.indexOf(e),p.objects.push(p.objects.splice(a,1)[0])),e instanceof Trader&&(e.drawable.returnPos=e.drawable.pos),"self"===e&&(a=p.objects.indexOf(i),p.objects.splice(a,1),p.objects.push(i),p.draw()),p.selected=e,p.mousePos=t})};document.getElementById("trades").addEventListener("mousemove",function(e){v(e)}),document.getElementById("trades").addEventListener("touchmove",function(e){var t=e.touches[0];v(t)});var v=function(e){p.interactionMove(e,function(t,a,r){t instanceof Trade&&(t.drawable.opacity=.5,t.drawable.pos=a),t instanceof Trader&&(t.drawable.opacity=.5,t.drawable.pos=t.drawable.pos.addVector(r.rotate(-t.drawable.rotation).mul(1/p.scale))),i.interaction(new Vector2D(e.pageX,e.pageY))?i.color="#E74C3C":i.color="#eeeeee",p.draw()})};document.getElementById("trades").addEventListener("mouseup",function(e){x(e)}),document.getElementById("trades").addEventListener("touchend",function(e){var t=e.touches[0];x(t)});var x=function(e){p.interactionStop(function(t,a){var r,n;if(t){if(a instanceof Trade)for(a.drawable.opacity=1,r=0,n=p.objects.length;n>r;r++)p.objects[r].open&&p.objects[r]!==a&&p.objects[r].clicked();if(a instanceof Trader&&(a.drawable.opacity=1),"self"===a)for(r=0,n=p.objects.length;n>r;r++)p.objects[r].open&&p.objects[r].clicked();"function"==typeof a.clicked&&a.clicked()}else a instanceof Trade&&(a.drawable.opacity=1,i.interaction(new Vector2D(e.pageX,e.pageY))&&a["delete"](p.objects)),a instanceof Trader&&(a.drawable.opacity=1,a.drawable.returnPos.length()!==a.drawable.pos.length()&&a.drawable.returnPos.x!==a.drawable.pos.x&&a.drawable.animateVector("pos",a.drawable.returnPos,500,"easeInOut",null),i.interaction(new Vector2D(e.pageX,e.pageY))&&a["delete"](p.objects));i.color="#eeeeee"}),p.draw()};document.getElementById("trades").addEventListener("wheel",function(e){C(e)}),document.getElementById("trades").addEventListener("DOMMouseScroll",function(e){C(e)});var C=function(e){e.preventDefault();var t=0;t="undefined"!=typeof e.wheelDelta?e.wheelDelta/300:-e.detail/50;var a=p.scale+t;a>1.8&&(a=1.8),.4>a&&(a=.4),a=Math.floor(100*a)/100,p.scale=a,i.radius=50/p.scale,document.getElementById("scaleCanvas").value=p.scale,p.draw()};document.getElementById("scaleCanvas").addEventListener("mousemove",function(){p.scale=parseFloat(this.value),i.radius=50/p.scale,p.draw()}),document.getElementById("resetOffset").addEventListener("click",function(){p.moveToCenter()}),window.addEventListener("resize",function(){p.setSize(window.innerWidth,window.innerHeight-50),i.pos=new Vector2D(window.innerWidth-100,window.innerHeight-150)})}};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRyYWRlci5qcyIsInRyYWRlLmpzIiwidHJhZGVDYW52YXMuanMiXSwibmFtZXMiOlsiVHJhZGVyIiwibmFtZSIsImFtb3VudCIsImluQXQiLCJpc1Nob3J0IiwiY29tbWVudCIsInRoaXMiLCJkaWZmZXJlbmNlIiwiZHJhd2FibGUiLCJEcmF3YWJsZSIsImNvbG9yIiwiYm9yZGVyQ29sb3IiLCJib3JkZXJXaWR0aCIsImJvcmRlclNjYWxpbmciLCJ0ZXh0Rm9udCIsInRleHRBbmNob3IiLCJWZWN0b3IyRCIsInRleHRCYWNrZ3JvdW5kIiwidGV4dFBhZGRpbmciLCJ0ZXh0U2NhbGluZyIsInRleHRQb3MiLCJ0ZXh0Q29sb3IiLCJwb3MiLCJyYWRpdXMiLCJzaG93Iiwib3BlbiIsImNoYW5nZVN0b2NrUHJpY2UiLCJzdG9ja1ByaWNlIiwicHJlc2V0IiwiZGlmZiIsIk1hdGgiLCJmbG9vciIsIm5lZyIsInRvTG9jYWxlU3RyaW5nIiwic3R5bGUiLCJjdXJyZW5jeSIsInNldFRleHQiLCJkcmF3IiwiY3R4Iiwic2NhbGUiLCJwIiwicm90YXRlIiwicm90YXRpb24iLCJzYXZlIiwiZ2xvYmFsQWxwaGEiLCJvcGFjaXR5IiwidHJhbnNsYXRlIiwieCIsInkiLCJkcmF3Q2lyY2xlIiwiZHJhd0ltYWdlSW5DaXJjbGUiLCJkcmF3Qm9yZGVyRm9yQ2lyY2xlIiwicmVzdG9yZSIsInBvc3REcmF3IiwiZHJhd1RleHQiLCJjbGlja2VkIiwibWUiLCJhbmltYXRlIiwiYW5pbWF0ZVZlY3RvciIsImZpbmlzaGVkIiwiZWxlbWVudCIsInRyYWRlcyIsImluZGV4IiwiaSIsImwiLCJsZW5ndGgiLCJ0cmFkZXJzIiwiaW5kIiwiaW5kZXhPZiIsInNwbGljZSIsImNhbGNUcmFkZXJzIiwiYW5pbWF0ZURlbGV0ZSIsImludGVyYWN0aW9uIiwibW91c2VQb3MiLCJtb3VzZURpZmZlcmVuY2UiLCJzdWJWZWN0b3IiLCJtdWwiLCJzaXplIiwiVHJhZGUiLCJpZCIsInRleHRSZXBsYWNlQ29sb3IiLCJsaW5lQ29sb3IiLCJ0ZXh0U2l6ZSIsInJhbmRvbSIsImltZ0ZpbGwiLCJ3aW5kb3ciLCJpbm5lcldpZHRoIiwiaW5uZXJIZWlnaHQiLCJkaXYiLCJ0ZXh0UmVwbGFjZSIsInNldEludGVydmFsIiwiZCIsInBPbSIsInJlcXVlc3RSZWRyYXciLCJyZWxQb3MiLCJvIiwiaiIsIm0iLCJ0IiwiYW5nbGUiLCJhbHBoYSIsInByZURyYXciLCJzdHJva2VTdHlsZSIsImxpbmVXaWR0aCIsIm5ld1RyYWRlciIsImJlZ2luUGF0aCIsIm1vdmVUbyIsImxpbmVUbyIsImNsb3NlUGF0aCIsInN0cm9rZSIsImYiLCJkb25lIiwidHJhZGVDYW52YXMiLCJ1c2VyIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsIm9iamVjdHMiLCJjb21wYW5pZXMiLCJwcm9maWxlIiwidHJhc2giLCJzZXRJbWFnZSIsInByb2ZpbGVwaWN0dXJlIiwiY2FudmFzIiwibWFyZ2luIiwib2Zmc2V0IiwiY2VudGVyIiwidW5kZWZpbmVkIiwiU3RvcFN0b2NrUHJpY2UiLCJjIiwidHJhZGVyIiwicGFyZW50VHJhZGUiLCJmaXJzdG5hbWUiLCJsYXN0bmFtZSIsIkFtb3VudEludmVzdGVkIiwiU3RhcnRTdG9ja1ByaWNlIiwiSXNTaG9ydCIsIkNvbW1lbnQiLCJjb21wYW55Rm91bmQiLCJDb21wYW55IiwiX2lkIiwicHVzaCIsIkN1cnJlbnRTdG9ja1ByaWNlIiwiaW1hZ2UiLCJJbWFnZSIsImsiLCJuIiwidHJhZGUiLCJDYW52YXMiLCJkcmF3Q2FsbGJhY2siLCJib2R5IiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImludGVyYWN0aW9uU3RhcnQiLCJ0b3VjaCIsInRvdWNoZXMiLCJvYmplY3QiLCJyZXR1cm5Qb3MiLCJzZWxlY3RlZCIsImludGVyYWN0aW9uTW92ZSIsImFkZFZlY3RvciIsInBhZ2VYIiwicGFnZVkiLCJpbnRlcmFjdGlvblN0b3AiLCJjbGljayIsInNjcm9sbEludGVyYWN0aW9uIiwiZGVsdGEiLCJ3aGVlbERlbHRhIiwiZGV0YWlsIiwidmFsdWUiLCJwYXJzZUZsb2F0IiwibW92ZVRvQ2VudGVyIiwic2V0U2l6ZSJdLCJtYXBwaW5ncyI6IkFBQUEsUUFBQUEsUUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsR0FDQUMsS0FBQUwsS0FBQUEsRUFDQUssS0FBQUosT0FBQUEsRUFDQUksS0FBQUgsS0FBQUEsRUFDQUcsS0FBQUQsUUFBQUEsRUFDQUMsS0FBQUYsUUFBQUEsRUFDQUUsS0FBQUMsV0FBQSxFQUNBRCxLQUFBRSxTQUFBLEdBQUFDLFVBRUFILEtBQUFFLFNBQUFFLE1BQUEsVUFFQUosS0FBQUUsU0FBQUcsWUFBQSxVQUNBTCxLQUFBRSxTQUFBSSxZQUFBLEVBQ0FOLEtBQUFFLFNBQUFLLGVBQUEsRUFDQVAsS0FBQUUsU0FBQU0sU0FBQSxnQkFDQVIsS0FBQUUsU0FBQU8sV0FBQSxHQUFBQyxVQUFBLEVBQUEsR0FDQVYsS0FBQUUsU0FBQVMsZUFBQSxVQUNBWCxLQUFBRSxTQUFBVSxZQUFBLEdBQUFGLFVBQUEsRUFBQSxHQUNBVixLQUFBRSxTQUFBVyxhQUFBLEVBQ0FiLEtBQUFFLFNBQUFZLFFBQUEsR0FBQUosVUFBQSxFQUFBLElBQ0FWLEtBQUFFLFNBQUFhLFVBQUEsVUFFQWYsS0FBQUUsU0FBQWMsSUFBQSxHQUFBTixVQUFBLEVBQUEsR0FFQVYsS0FBQUUsU0FBQWUsT0FBQSxHQUVBakIsS0FBQUUsU0FBQWdCLE1BQUEsRUFFQWxCLEtBQUFBLFFBQUEsRUFDQUEsS0FBQW1CLE1BQUEsRUFFQW5CLEtBQUFvQixpQkFBQSxTQUFBQyxHQUNBLEdBQUFDLEdBQUEsTUFBQXRCLEtBQUFMLEtBQUEsMkJBQ0E0QixFQUFBQyxLQUFBQyxPQUFBSixFQUFBckIsS0FBQUgsTUFBQUcsS0FBQUosT0FBQSxLQUFBLElBQ0FvQixFQUFBLFVBQ0FVLEVBQUEsU0FDQTFCLE1BQUFGLFFBR0FFLEtBQUFDLFlBQUFzQixFQUZBdkIsS0FBQUMsV0FBQXNCLEVBS0FELEdBREF0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QUFBbkYsTUFBQUEsRUFDQWdGLEVBQUFoRyxPQUFBLEdBQUFtRyxFQUFBbkYsTUFDQTJFLFNBQUFDLGVBQUEsZUFBQXNELE1BQUEvQyxFQUFBbkYsTUFDQW1GLEVBQUFyRixPQUlBNkUsVUFBQUMsZUFBQSxlQUFBbUMsaUJBQUEsWUFBQSxXQUNBNUIsRUFBQW5GLE1BQUFtSSxXQUFBcEssS0FBQW1LLE9BQ0FsRCxFQUFBaEcsT0FBQSxHQUFBbUcsRUFBQW5GLE1BQ0FtRixFQUFBckYsU0FJQTZFLFNBQUFDLGVBQUEsZUFBQW1DLGlCQUFBLFFBQUEsV0FDQTVCLEVBQUFpRCxpQkFJQXRGLE9BQUFpRSxpQkFBQSxTQUFBLFdBQ0E1QixFQUFBa0QsUUFBQXZGLE9BQUFDLFdBQUFELE9BQUFFLFlBQUEsSUFDQWdDLEVBQUFqRyxJQUFBLEdBQUFOLFVBQUFxRSxPQUFBQyxXQUFBLElBQUFELE9BQUFFLFlBQUEiLCJmaWxlIjoiYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIFRyYWRlcihuYW1lLCBhbW91bnQsIGluQXQsIGlzU2hvcnQsIGNvbW1lbnQpIHtcbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgIHRoaXMuYW1vdW50ID0gYW1vdW50O1xuICAgIHRoaXMuaW5BdCA9IGluQXQ7XG4gICAgdGhpcy5jb21tZW50ID0gY29tbWVudDtcbiAgICB0aGlzLmlzU2hvcnQgPSBpc1Nob3J0O1xuICAgIHRoaXMuZGlmZmVyZW5jZSA9IDA7XG4gICAgdGhpcy5kcmF3YWJsZSA9IG5ldyBEcmF3YWJsZSgpO1xuXG4gICAgdGhpcy5kcmF3YWJsZS5jb2xvciA9IFwiI2ZmZmZmZlwiO1xuXG4gICAgdGhpcy5kcmF3YWJsZS5ib3JkZXJDb2xvciA9IFwiI0IzQjM2OVwiO1xuICAgIHRoaXMuZHJhd2FibGUuYm9yZGVyV2lkdGggPSAyO1xuICAgIHRoaXMuZHJhd2FibGUuYm9yZGVyU2NhbGluZyA9IGZhbHNlO1xuICAgIHRoaXMuZHJhd2FibGUudGV4dEZvbnQgPSBcIlNvdXJjZVNhbnNQcm9cIjtcbiAgICB0aGlzLmRyYXdhYmxlLnRleHRBbmNob3IgPSBuZXcgVmVjdG9yMkQoMCwgMSk7XG4gICAgdGhpcy5kcmF3YWJsZS50ZXh0QmFja2dyb3VuZCA9IFwiI2ZmZmZmZlwiO1xuICAgIHRoaXMuZHJhd2FibGUudGV4dFBhZGRpbmcgPSBuZXcgVmVjdG9yMkQoMCwgMCk7XG4gICAgdGhpcy5kcmF3YWJsZS50ZXh0U2NhbGluZyA9IGZhbHNlO1xuICAgIHRoaXMuZHJhd2FibGUudGV4dFBvcyA9IG5ldyBWZWN0b3IyRCgxLCAtMSk7XG4gICAgdGhpcy5kcmF3YWJsZS50ZXh0Q29sb3IgPSBcIiMyQzNFNTBcIjtcblxuICAgIHRoaXMuZHJhd2FibGUucG9zID0gbmV3IFZlY3RvcjJEKDAsIDApO1xuXG4gICAgdGhpcy5kcmF3YWJsZS5yYWRpdXMgPSAyNTtcblxuICAgIHRoaXMuZHJhd2FibGUuc2hvdyA9IGZhbHNlO1xuXG4gICAgdGhpcy5uZXcgPSB0cnVlO1xuICAgIHRoaXMub3BlbiA9IGZhbHNlO1xuXG4gICAgdGhpcy5jaGFuZ2VTdG9ja1ByaWNlID0gZnVuY3Rpb24oc3RvY2tQcmljZSkge1xuICAgICAgICB2YXIgcHJlc2V0ID0gXCJbYl1cIiArIHRoaXMubmFtZSArIFwiWy9iXVthbGlnbj1yaWdodF1bY29sb3I9XCI7XG4gICAgICAgIHZhciBkaWZmID0gTWF0aC5mbG9vcigoc3RvY2tQcmljZSAtIHRoaXMuaW5BdCkgKiB0aGlzLmFtb3VudCAqIDEwMCkgLyAxMDA7XG4gICAgICAgIHZhciBwb3MgPSBcIiMzNkI1REJcIjtcbiAgICAgICAgdmFyIG5lZyA9IFwiI0U3NEMzQ1wiO1xuICAgICAgICBpZighdGhpcy5pc1Nob3J0KSB7XG4gICAgICAgICAgICB0aGlzLmRpZmZlcmVuY2UgPSBkaWZmO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5kaWZmZXJlbmNlID0gLWRpZmY7XG4gICAgICAgIH1cbiAgICAgICAgaWYodGhpcy5kaWZmZXJlbmNlID49IDApIHtcbiAgICAgICAgICAgIHByZXNldCArPSBwb3MgKyBcIl1cIjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHByZXNldCArPSBuZWcgKyBcIl1cIjtcbiAgICAgICAgfVxuICAgICAgICBwcmVzZXQgKz0gdGhpcy5kaWZmZXJlbmNlLnRvTG9jYWxlU3RyaW5nKCdiZS1OTCcsIHtzdHlsZTogJ2N1cnJlbmN5JywgY3VycmVuY3k6ICdFVVInfSkgKyBcIlsvY29sb3JdWy9hbGlnbl1cXG5baV1bY29sb3I9XCI7XG4gICAgICAgIGlmKCF0aGlzLmlzU2hvcnQpIHtcbiAgICAgICAgICAgIHByZXNldCArPSBwb3MgKyBcIl1cIjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHByZXNldCArPSBuZWcgKyBcIl1cIjtcbiAgICAgICAgfVxuICAgICAgICBwcmVzZXQgKz0gYW1vdW50O1xuICAgICAgICBpZighdGhpcy5pc1Nob3J0KSB7XG4gICAgICAgICAgICBwcmVzZXQgKz0gXCIgbG9uZyBhdCBcIjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHByZXNldCArPSBcIiBzaG9ydCBhdCBcIjtcbiAgICAgICAgfVxuICAgICAgICBwcmVzZXQgKz0gaW5BdC50b0xvY2FsZVN0cmluZygnYmUtTkwnLCB7c3R5bGU6ICdjdXJyZW5jeScsIGN1cnJlbmN5OiAnRVVSJ30pICsgXCJbL2NvbG9yXVsvaV1cXG5cIjtcbiAgICAgICAgdGhpcy5kcmF3YWJsZS5zZXRUZXh0KHByZXNldCArIHRoaXMuY29tbWVudCk7XG4gICAgfTtcblxuICAgIHRoaXMuZHJhdyA9IGZ1bmN0aW9uKGN0eCwgc2NhbGUpIHtcbiAgICAgICAgaWYodGhpcy5kcmF3YWJsZS5zaG93KSB7XG4gICAgICAgICAgICB2YXIgcCA9IHRoaXMuZHJhd2FibGUucG9zLnJvdGF0ZSh0aGlzLmRyYXdhYmxlLnJvdGF0aW9uKTtcbiAgICAgICAgICAgIGN0eC5zYXZlKCk7XG4gICAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgKj0gdGhpcy5kcmF3YWJsZS5vcGFjaXR5O1xuICAgICAgICAgICAgY3R4LnRyYW5zbGF0ZShwLngsIHAueSk7XG4gICAgICAgICAgICB0aGlzLmRyYXdhYmxlLmRyYXdDaXJjbGUoY3R4KTtcbiAgICAgICAgICAgIHRoaXMuZHJhd2FibGUuZHJhd0ltYWdlSW5DaXJjbGUoY3R4KTtcbiAgICAgICAgICAgIHRoaXMuZHJhd2FibGUuZHJhd0JvcmRlckZvckNpcmNsZShjdHgsIHNjYWxlKTtcbiAgICAgICAgICAgIGN0eC5yZXN0b3JlKCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5wb3N0RHJhdyA9IGZ1bmN0aW9uKGN0eCwgc2NhbGUpIHtcbiAgICAgICAgaWYodGhpcy5kcmF3YWJsZS5zaG93KSB7XG4gICAgICAgICAgICB2YXIgcCA9IHRoaXMuZHJhd2FibGUucG9zLnJvdGF0ZSh0aGlzLmRyYXdhYmxlLnJvdGF0aW9uKTtcbiAgICAgICAgICAgIGN0eC5zYXZlKCk7XG4gICAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgKj0gdGhpcy5kcmF3YWJsZS5vcGFjaXR5O1xuICAgICAgICAgICAgY3R4LnRyYW5zbGF0ZShwLngsIHAueSk7XG4gICAgICAgICAgICB0aGlzLmRyYXdhYmxlLmRyYXdUZXh0KGN0eCwgc2NhbGUpO1xuICAgICAgICAgICAgY3R4LnJlc3RvcmUoKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB0aGlzLmNsaWNrZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIG1lID0gdGhpcztcbiAgICAgICAgaWYoIXRoaXMub3Blbikge1xuICAgICAgICAgICAgdGhpcy5kcmF3YWJsZS5hbmltYXRlKFwidGV4dFNpemVcIiwgMTIsIDIwMCwgXCJlYXNlSW5PdXRcIiwgbnVsbCk7XG4gICAgICAgICAgICB0aGlzLmRyYXdhYmxlLmFuaW1hdGVWZWN0b3IoXCJ0ZXh0UGFkZGluZ1wiLCBuZXcgVmVjdG9yMkQoMTAsIDEwKSwgMjAwLCBcImVhc2VJbk91dFwiLCBmdW5jdGlvbihmaW5pc2hlZCwgZWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGlmKGZpbmlzaGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIG1lLm9wZW4gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5kcmF3YWJsZS5hbmltYXRlKFwidGV4dFNpemVcIiwgMCwgMjAwLCBcImVhc2VJbk91dFwiLCBudWxsKTtcbiAgICAgICAgICAgIHRoaXMuZHJhd2FibGUuYW5pbWF0ZVZlY3RvcihcInRleHRQYWRkaW5nXCIsIG5ldyBWZWN0b3IyRCgwLCAwKSwgMjAwLCBcImVhc2VJbk91dFwiLCBmdW5jdGlvbihmaW5pc2hlZCwgZWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGlmKGZpbmlzaGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIG1lLm9wZW4gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB0aGlzLmRlbGV0ZSA9IGZ1bmN0aW9uKHRyYWRlcywgaW5kZXgpIHtcbiAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICBpZih0eXBlb2YgaW5kZXggIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICBpID0gaW5kZXg7XG4gICAgICAgIH1cbiAgICAgICAgZm9yKHZhciBsID0gdHJhZGVzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgaWYodHlwZW9mIHRyYWRlc1tpXS50cmFkZXJzICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIHZhciBpbmQgPSB0cmFkZXNbaV0udHJhZGVycy5pbmRleE9mKHRoaXMpO1xuICAgICAgICAgICAgICAgIGlmIChpbmQgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICB0cmFkZXNbaV0udHJhZGVycy5zcGxpY2UoaW5kLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgdHJhZGVzW2ldLmNhbGNUcmFkZXJzKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmKHRyYWRlc1tpXS50cmFkZXJzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJhZGVzW2ldLmFuaW1hdGVEZWxldGUodHJhZGVzLCBpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB0aGlzLmludGVyYWN0aW9uID0gZnVuY3Rpb24obW91c2VQb3MsIHNjYWxlKSB7XG4gICAgICAgIHZhciBtb3VzZURpZmZlcmVuY2UgPSBtb3VzZVBvcy5zdWJWZWN0b3IodGhpcy5kcmF3YWJsZS5wb3Mucm90YXRlKHRoaXMuZHJhd2FibGUucm90YXRpb24pLm11bChzY2FsZSkpO1xuICAgICAgICB2YXIgZGlmZmVyZW5jZSA9IDA7XG4gICAgICAgIGlmICh0aGlzLmRyYXdhYmxlLnJhZGl1cyAhPT0gMCkge1xuICAgICAgICAgICAgZGlmZmVyZW5jZSA9IHRoaXMuZHJhd2FibGUucmFkaXVzICogc2NhbGU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZHJhd2FibGUuc2l6ZS5sZW5ndGgoKSAhPT0gMCkge1xuICAgICAgICAgICAgZGlmZmVyZW5jZSA9IHRoaXMuZHJhd2FibGUuc2l6ZS5sZW5ndGgoKSAqIHNjYWxlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtb3VzZURpZmZlcmVuY2UubGVuZ3RoKCkgPD0gZGlmZmVyZW5jZSAmJiB0aGlzLmRyYXdhYmxlLnNob3cpIHtcbiAgICAgICAgICAgIGlmKHRoaXMubmV3KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5uZXcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLmRyYXdhYmxlLmJvcmRlckNvbG9yID0gXCIjZWVlZWVlXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG59IiwidmFyIFRyYWRlID0gZnVuY3Rpb24oaWQsIHN0b2NrUHJpY2UsIHRyYWRlcnMsIHBvcykge1xuICAgIHRoaXMuaWQgPSBpZDtcbiAgICB0aGlzLnN0b2NrUHJpY2UgPSBzdG9ja1ByaWNlO1xuICAgIHRoaXMudHJhZGVycyA9IHRyYWRlcnM7XG4gICAgdGhpcy5kcmF3YWJsZSA9IG5ldyBEcmF3YWJsZSgpO1xuXG4gICAgdGhpcy5kaWZmZXJlbmNlID0gMDtcbiAgICBmb3IodmFyIGkgPSAwLCBsID0gdGhpcy50cmFkZXJzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICB0aGlzLnRyYWRlcnNbaV0uY2hhbmdlU3RvY2tQcmljZSh0aGlzLnN0b2NrUHJpY2UpO1xuICAgICAgICB0aGlzLmRpZmZlcmVuY2UgKz0gdGhpcy50cmFkZXJzW2ldLmRpZmZlcmVuY2U7XG4gICAgfVxuICAgIHRoaXMuZGlmZmVyZW5jZSA9IE1hdGguZmxvb3IodGhpcy5kaWZmZXJlbmNlICogMTAwKSAvIDEwMDtcbiAgICB0aGlzLmRyYXdhYmxlLnNldFRleHQodGhpcy5kaWZmZXJlbmNlLnRvTG9jYWxlU3RyaW5nKCdiZS1OTCcsIHsgc3R5bGU6ICdjdXJyZW5jeScsIGN1cnJlbmN5OiAnRVVSJ30pKTtcbiAgICBpZih0aGlzLmRpZmZlcmVuY2UgPj0gMCkge1xuICAgICAgICB0aGlzLmRyYXdhYmxlLnRleHRCYWNrZ3JvdW5kID0gXCIjMzZCNURCXCI7XG4gICAgICAgIHRoaXMuZHJhd2FibGUudGV4dFJlcGxhY2VDb2xvciA9IFwiIzM2QjVEQlwiO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuZHJhd2FibGUudGV4dEJhY2tncm91bmQgPSBcIiNFNzRDM0NcIjtcbiAgICAgICAgdGhpcy5kcmF3YWJsZS50ZXh0UmVwbGFjZUNvbG9yID0gXCIjRTc0QzNDXCI7XG4gICAgfVxuICAgIHRoaXMubGluZUNvbG9yID0gXCIjQjNCMzY5XCI7XG4gICAgdGhpcy5vcGVuID0gZmFsc2U7XG5cbiAgICB0aGlzLmRyYXdhYmxlLnRleHRTaXplID0gMTA7XG4gICAgdGhpcy5kcmF3YWJsZS5yYWRpdXMgPSBNYXRoLmZsb29yKChNYXRoLnJhbmRvbSgpICogMzUpICsgMzUpO1xuICAgIHRoaXMuZHJhd2FibGUuaW1nRmlsbCA9IGZhbHNlO1xuICAgIGlmKHBvcyA9PT0gbnVsbCkge1xuICAgICAgICB2YXIgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHdpbmRvdy5pbm5lcldpZHRoIC0gKHdpbmRvdy5pbm5lcldpZHRoIC8gMikpO1xuICAgICAgICB2YXIgeSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqICh3aW5kb3cuaW5uZXJIZWlnaHQgLSA1MCkgLSAoKHdpbmRvdy5pbm5lckhlaWdodCAtIDUwKSAvIDIpKTtcbiAgICAgICAgd2hpbGUobmV3IFZlY3RvcjJEKHgsIHkpLmxlbmd0aCgpIDwgKDEwMCArIHRoaXMuZHJhd2FibGUucmFkaXVzKSB8fCBuZXcgVmVjdG9yMkQoeCwgeSkubGVuZ3RoKCkgPiAobmV3IFZlY3RvcjJEKHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQgLSA1MCkuZGl2KDIpLmxlbmd0aCgpIC0gdGhpcy5kcmF3YWJsZS5yYWRpdXMpKSB7XG4gICAgICAgICAgICB4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogd2luZG93LmlubmVyV2lkdGggLSAod2luZG93LmlubmVyV2lkdGggLyAyKSk7XG4gICAgICAgICAgICB5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKHdpbmRvdy5pbm5lckhlaWdodCAtIDUwKSAtICgod2luZG93LmlubmVySGVpZ2h0IC0gNTApIC8gMikpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZHJhd2FibGUuYW5pbWF0ZVZlY3RvcihcInBvc1wiLCBuZXcgVmVjdG9yMkQoeCwgeSksIDEwMDAsIFwiZWFzZUluT3V0XCIsIG51bGwpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdGhpcy5kcmF3YWJsZS5hbmltYXRlVmVjdG9yKFwicG9zXCIsIHBvcywgMTAwMCwgXCJlYXNlSW5PdXRcIiwgbnVsbCk7XG4gICAgfVxuICAgIHRoaXMuZHJhd2FibGUuY29sb3IgPSBcIiNmZmZmZmZcIjtcbiAgICB0aGlzLmRyYXdhYmxlLmJvcmRlcldpZHRoID0gMjtcbiAgICB0aGlzLmRyYXdhYmxlLmJvcmRlckNvbG9yID0gXCIjQjNCMzY5XCI7XG4gICAgdGhpcy5kcmF3YWJsZS5ib3JkZXJTY2FsaW5nID0gZmFsc2U7XG4gICAgdGhpcy5kcmF3YWJsZS50ZXh0Q29sb3IgPSBcIiNmZmZmZmZcIjtcbiAgICB0aGlzLmRyYXdhYmxlLnRleHRGb250ID0gXCJTb3VyY2VTYW5zUHJvXCI7XG4gICAgdGhpcy5kcmF3YWJsZS50ZXh0QW5jaG9yID0gbmV3IFZlY3RvcjJEKDAuNSwgMC41KTtcbiAgICB0aGlzLmRyYXdhYmxlLnRleHRQb3MgPSBuZXcgVmVjdG9yMkQoMCwgMC41KTtcbiAgICB0aGlzLmRyYXdhYmxlLnRleHRQYWRkaW5nID0gbmV3IFZlY3RvcjJEKDEwLCAxMCk7XG4gICAgdGhpcy5kcmF3YWJsZS50ZXh0UmVwbGFjZSA9IDE1O1xuXG4gICAgdmFyIG1lID0gdGhpcztcbiAgICBzZXRJbnRlcnZhbChmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGQgPSBNYXRoLnJhbmRvbSgpIC8gMTA7XG4gICAgICAgIHZhciBwT20gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAyKTtcbiAgICAgICAgaWYocE9tID09PSAxKSB7XG4gICAgICAgICAgICBkID0gLWQ7XG4gICAgICAgIH1cbiAgICAgICAgbWUuc3RvY2tQcmljZSA9IE1hdGguZmxvb3IoKG1lLnN0b2NrUHJpY2UgKyBkKSAqIDEwMCkgLyAxMDA7XG4gICAgICAgIG1lLmRpZmZlcmVuY2UgPSAwO1xuICAgICAgICBmb3IodmFyIGkgPSAwLCBsID0gbWUudHJhZGVycy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgIG1lLnRyYWRlcnNbaV0uY2hhbmdlU3RvY2tQcmljZShtZS5zdG9ja1ByaWNlKTtcbiAgICAgICAgICAgIG1lLmRpZmZlcmVuY2UgKz0gbWUudHJhZGVyc1tpXS5kaWZmZXJlbmNlO1xuICAgICAgICB9XG4gICAgICAgIG1lLmRpZmZlcmVuY2UgPSBNYXRoLmZsb29yKG1lLmRpZmZlcmVuY2UgKiAxMDApIC8gMTAwO1xuICAgICAgICBpZighbWUub3Blbikge1xuICAgICAgICAgICAgbWUuZHJhd2FibGUuc2V0VGV4dChtZS5kaWZmZXJlbmNlLnRvTG9jYWxlU3RyaW5nKCdiZS1OTCcsIHsgc3R5bGU6ICdjdXJyZW5jeScsIGN1cnJlbmN5OiAnRVVSJ30pKTtcbiAgICAgICAgICAgIGlmKG1lLmRpZmZlcmVuY2UgPj0gMCkge1xuICAgICAgICAgICAgICAgIG1lLmRyYXdhYmxlLnRleHRCYWNrZ3JvdW5kID0gXCIjMzZCNURCXCI7XG4gICAgICAgICAgICAgICAgbWUuZHJhd2FibGUudGV4dFJlcGxhY2VDb2xvciA9IFwiIzM2QjVEQlwiO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBtZS5kcmF3YWJsZS50ZXh0QmFja2dyb3VuZCA9IFwiI0U3NEMzQ1wiO1xuICAgICAgICAgICAgICAgIG1lLmRyYXdhYmxlLnRleHRSZXBsYWNlQ29sb3IgPSBcIiNFNzRDM0NcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmKG1lLmRpZmZlcmVuY2UgPj0gMCkge1xuICAgICAgICAgICAgICAgIG1lLmRyYXdhYmxlLnRleHRSZXBsYWNlQ29sb3IgPSBcIiMzNkI1REJcIjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbWUuZHJhd2FibGUudGV4dFJlcGxhY2VDb2xvciA9IFwiI0U3NEMzQ1wiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbWUuZHJhd2FibGUudGV4dEJhY2tncm91bmQgPSBcIiMyQzNFNTBcIjtcbiAgICAgICAgICAgIG1lLmRyYXdhYmxlLnNldFRleHQobWUuc3RvY2tQcmljZS50b0xvY2FsZVN0cmluZygnYmUtTkwnLCB7IHN0eWxlOiAnY3VycmVuY3knLCBjdXJyZW5jeTogJ0VVUid9KSk7XG4gICAgICAgIH1cbiAgICAgICAgbWUuZHJhd2FibGUucmVxdWVzdFJlZHJhdyA9IHRydWU7XG4gICAgfSwgMjAwMCk7XG5cbiAgICB0aGlzLmludGVyYWN0aW9uID0gZnVuY3Rpb24obW91c2VQb3MsIHNjYWxlKSB7XG4gICAgICAgIHZhciBtb3VzZURpZmZlcmVuY2UgPSBtb3VzZVBvcy5zdWJWZWN0b3IodGhpcy5kcmF3YWJsZS5wb3MubXVsKHNjYWxlKSk7XG4gICAgICAgIHZhciBkaWZmZXJlbmNlID0gMDtcbiAgICAgICAgaWYodGhpcy5kcmF3YWJsZS5yYWRpdXMgIT09IDApIHtcbiAgICAgICAgICAgIGRpZmZlcmVuY2UgPSB0aGlzLmRyYXdhYmxlLnJhZGl1cyAqIHNjYWxlO1xuICAgICAgICB9XG4gICAgICAgIGlmKHRoaXMuZHJhd2FibGUuc2l6ZS5sZW5ndGgoKSAhPT0gMCkge1xuICAgICAgICAgICAgZGlmZmVyZW5jZSA9IHRoaXMuZHJhd2FibGUuc2l6ZS5sZW5ndGgoKSAqIHNjYWxlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtb3VzZURpZmZlcmVuY2UubGVuZ3RoKCkgPD0gZGlmZmVyZW5jZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJlbFBvcyA9IG1vdXNlUG9zLnN1YlZlY3Rvcih0aGlzLmRyYXdhYmxlLnBvcy5tdWwoc2NhbGUpKTtcbiAgICAgICAgZm9yKHZhciBpID0gMCwgbCA9IHRoaXMudHJhZGVycy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBvID0gdGhpcy50cmFkZXJzW2ldLmludGVyYWN0aW9uKHJlbFBvcywgc2NhbGUpO1xuICAgICAgICAgICAgaWYobyAhPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICBmb3IodmFyIGogPSAwLCBtID0gdGhpcy50cmFkZXJzLmxlbmd0aDsgaiA8IG07IGorKykge1xuICAgICAgICAgICAgICAgICAgICB0ID0gdGhpcy50cmFkZXJzW2pdO1xuICAgICAgICAgICAgICAgICAgICBpZiAodC5vcGVuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0LmNsaWNrZWQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gbztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcblxuICAgIHRoaXMuY2FsY1RyYWRlcnMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGFuZ2xlID0gMTgwIC8gKHRoaXMudHJhZGVycy5sZW5ndGggKyAxKTtcbiAgICAgICAgZm9yKHZhciBpID0gMCwgbCA9IHRoaXMudHJhZGVycy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhbHBoYSA9IChhbmdsZSAqIChpICsgMSAtICgodGhpcy50cmFkZXJzLmxlbmd0aCArIDEpIC8gMikpKSAtIDkwO1xuICAgICAgICAgICAgdGhpcy50cmFkZXJzW2ldLmRyYXdhYmxlLmFuaW1hdGUoXCJyb3RhdGlvblwiLCBhbHBoYSwgMzAwLCBcImVhc2VJbk91dFwiLCBudWxsKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5jYWxjVHJhZGVycygpO1xuXG4gICAgdGhpcy5wcmVEcmF3ID0gZnVuY3Rpb24oY3R4LCBzY2FsZSkge1xuICAgICAgICBpZih0aGlzLmRyYXdhYmxlLnNob3cpIHtcbiAgICAgICAgICAgIGN0eC5zYXZlKCk7XG4gICAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgKj0gdGhpcy5kcmF3YWJsZS5vcGFjaXR5O1xuICAgICAgICAgICAgY3R4LnN0cm9rZVN0eWxlID0gdGhpcy5saW5lQ29sb3I7XG4gICAgICAgICAgICBjdHgubGluZVdpZHRoID0gMC41O1xuICAgICAgICAgICAgdmFyIG5ld1RyYWRlciA9IGZhbHNlO1xuICAgICAgICAgICAgZm9yKHZhciBpID0gMCwgbCA9IHRoaXMudHJhZGVycy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZih0aGlzLnRyYWRlcnNbaV0ubmV3KSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld1RyYWRlciA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYobmV3VHJhZGVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5saW5lQ29sb3IgPSBcIiNCM0IzNjlcIjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5saW5lQ29sb3IgPSBcIiMyQzNFNTBcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgIGN0eC5tb3ZlVG8oMCwgMCk7XG4gICAgICAgICAgICBjdHgubGluZVRvKHRoaXMuZHJhd2FibGUucG9zLngsIHRoaXMuZHJhd2FibGUucG9zLnkpO1xuICAgICAgICAgICAgY3R4LmNsb3NlUGF0aCgpO1xuICAgICAgICAgICAgY3R4LnN0cm9rZSgpO1xuICAgICAgICAgICAgY3R4LnJlc3RvcmUoKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB0aGlzLmRyYXcgPSBmdW5jdGlvbihjdHgsIHNjYWxlKSB7XG4gICAgICAgIGlmKHRoaXMuZHJhd2FibGUuc2hvdykge1xuICAgICAgICAgICAgY3R4LnNhdmUoKTtcbiAgICAgICAgICAgIGN0eC50cmFuc2xhdGUodGhpcy5kcmF3YWJsZS5wb3MueCwgdGhpcy5kcmF3YWJsZS5wb3MueSk7XG4gICAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgKj0gdGhpcy5kcmF3YWJsZS5vcGFjaXR5O1xuICAgICAgICAgICAgdmFyIG5ld1RyYWRlciA9IGZhbHNlO1xuICAgICAgICAgICAgZm9yKHZhciBpID0gMCwgbCA9IHRoaXMudHJhZGVycy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRyYWRlcnNbaV0uZHJhdyhjdHgsIHNjYWxlKTtcbiAgICAgICAgICAgICAgICBpZih0aGlzLnRyYWRlcnNbaV0ubmV3KSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld1RyYWRlciA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYobmV3VHJhZGVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kcmF3YWJsZS5ib3JkZXJDb2xvciA9IFwiI0IzQjM2OVwiO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRyYXdhYmxlLmJvcmRlckNvbG9yID0gXCIjZWVlZWVlXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmRyYXdhYmxlLmRyYXdDaXJjbGUoY3R4KTtcbiAgICAgICAgICAgIHRoaXMuZHJhd2FibGUuZHJhd0ltYWdlSW5DaXJjbGUoY3R4KTtcbiAgICAgICAgICAgIHRoaXMuZHJhd2FibGUuZHJhd0JvcmRlckZvckNpcmNsZShjdHgsIHNjYWxlKTtcbiAgICAgICAgICAgIHRoaXMuZHJhd2FibGUuZHJhd1RleHQoY3R4LCBzY2FsZSk7XG4gICAgICAgICAgICBjdHgucmVzdG9yZSgpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHRoaXMuZGVsZXRlID0gZnVuY3Rpb24odHJhZGVzKSB7XG4gICAgICAgIHZhciBpbmRleCA9IHRyYWRlcy5pbmRleE9mKHRoaXMpO1xuICAgICAgICBmb3IodmFyIGkgPSAwLCBsID0gdGhpcy50cmFkZXJzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgdGhpcy50cmFkZXJzWzBdLmRlbGV0ZSh0cmFkZXMsIGluZGV4KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB0aGlzLmFuaW1hdGVEZWxldGUgPSBmdW5jdGlvbih0cmFkZXMsIGluZGV4KSB7XG4gICAgICAgIHRoaXMuZHJhd2FibGUuYW5pbWF0ZShcInRleHRTaXplXCIsIDAsIDMwMCwgXCJlYXNlSW5PdXRcIiwgbnVsbCk7XG4gICAgICAgIHRoaXMuZHJhd2FibGUuYW5pbWF0ZShcInRleHRSZXBsYWNlXCIsIDAsIDMwMCwgXCJlYXNlSW5PdXRcIiwgbnVsbCk7XG4gICAgICAgIHRoaXMuZHJhd2FibGUuYW5pbWF0ZVZlY3RvcihcInRleHRQYWRkaW5nXCIsIG5ldyBWZWN0b3IyRCgwLCAwKSwgMzAwLCBcImVhc2VJbk91dFwiLCBudWxsKTtcbiAgICAgICAgdGhpcy5kcmF3YWJsZS5hbmltYXRlKFwib3BhY2l0eVwiLCAwLCAzMDAsIFwiZWFzZUluT3V0XCIsIG51bGwpO1xuICAgICAgICB0aGlzLmRyYXdhYmxlLmFuaW1hdGUoXCJyYWRpdXNcIiwgMCwgMzAwLCBcImVhc2VJbk91dFwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRyYWRlcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgdGhpcy5wb3N0RHJhdyA9IGZ1bmN0aW9uKGN0eCwgc2NhbGUpIHtcbiAgICAgICAgaWYodGhpcy5kcmF3YWJsZS5zaG93KSB7XG4gICAgICAgICAgICBjdHguc2F2ZSgpO1xuICAgICAgICAgICAgY3R4Lmdsb2JhbEFscGhhICo9IHRoaXMuZHJhd2FibGUub3BhY2l0eTtcbiAgICAgICAgICAgIGN0eC50cmFuc2xhdGUodGhpcy5kcmF3YWJsZS5wb3MueCwgdGhpcy5kcmF3YWJsZS5wb3MueSk7XG4gICAgICAgICAgICBmb3IodmFyIGkgPSAwLCBsID0gdGhpcy50cmFkZXJzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgICAgIHRoaXMudHJhZGVyc1tpXS5wb3N0RHJhdyhjdHgsIHNjYWxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGN0eC5yZXN0b3JlKCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5jbGlja2VkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBpID0gMCwgbCA9IDAsIHQgPSBudWxsLCBtZSA9IHRoaXM7XG4gICAgICAgIGlmKCF0aGlzLm9wZW4pIHtcbiAgICAgICAgICAgIGZvcihsID0gdGhpcy50cmFkZXJzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgICAgIHQgPSB0aGlzLnRyYWRlcnNbaV07XG4gICAgICAgICAgICAgICAgdC5kcmF3YWJsZS5zaG93ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0LmRyYXdhYmxlLmFuaW1hdGVWZWN0b3IoXCJwb3NcIiwgbmV3IFZlY3RvcjJEKDAsIHRoaXMuZHJhd2FibGUucmFkaXVzICsgdC5kcmF3YWJsZS5yYWRpdXMgKyAxNSksIDMwMCwgXCJlYXNlSW5PdXRcIiwgbnVsbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmRyYXdhYmxlLmFuaW1hdGVWZWN0b3IoXCJ0ZXh0UGFkZGluZ1wiLCBuZXcgVmVjdG9yMkQoMCwgMCksIDE1MCwgXCJlYXNlSW5cIiwgZnVuY3Rpb24oZG9uZSwgZHJhd2FibGUpIHtcbiAgICAgICAgICAgICAgICBkcmF3YWJsZS5hbmltYXRlVmVjdG9yKFwidGV4dFBhZGRpbmdcIiwgbmV3IFZlY3RvcjJEKDEwLCAxMCksIDE1MCwgXCJlYXNlT3V0XCIsIG51bGwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLmRyYXdhYmxlLmFuaW1hdGUoXCJ0ZXh0UmVwbGFjZVwiLCAwLCAxNTAsIFwiZWFzZUluXCIsIGZ1bmN0aW9uKGRvbmUsIGRyYXdhYmxlKSB7XG4gICAgICAgICAgICAgICAgZHJhd2FibGUuYW5pbWF0ZShcInRleHRSZXBsYWNlXCIsIDE1LCAxNTAsIFwiZWFzZU91dFwiLCBudWxsKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5kcmF3YWJsZS5hbmltYXRlKFwidGV4dFNpemVcIiwgMCwgMTUwLCBcImVhc2VJblwiLCBmdW5jdGlvbihkb25lLCBkcmF3YWJsZSkge1xuICAgICAgICAgICAgICAgIGRyYXdhYmxlLnRleHRCYWNrZ3JvdW5kID0gXCIjMkMzRTUwXCI7XG4gICAgICAgICAgICAgICAgZHJhd2FibGUuc2V0VGV4dChtZS5zdG9ja1ByaWNlLnRvTG9jYWxlU3RyaW5nKCdiZS1OTCcsIHsgc3R5bGU6ICdjdXJyZW5jeScsIGN1cnJlbmN5OiAnRVVSJ30pKTtcbiAgICAgICAgICAgICAgICBtZS5vcGVuID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBkcmF3YWJsZS5hbmltYXRlKFwidGV4dFNpemVcIiwgMTAsIDE1MCwgXCJlYXNlT3V0XCIsIG51bGwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgZiA9IGZ1bmN0aW9uKGRvbmUsIGRyYXdhYmxlKSB7XG4gICAgICAgICAgICAgICAgZHJhd2FibGUuc2hvdyA9IGZhbHNlO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGZvcihsID0gdGhpcy50cmFkZXJzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgICAgIHQgPSB0aGlzLnRyYWRlcnNbaV07XG4gICAgICAgICAgICAgICAgaWYodC5vcGVuKSB7XG4gICAgICAgICAgICAgICAgICAgIHQuY2xpY2tlZCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0LmRyYXdhYmxlLmFuaW1hdGVWZWN0b3IoXCJwb3NcIiwgbmV3IFZlY3RvcjJEKDAsIDApLCAzMDAsIFwiZWFzZUluT3V0XCIsIGYpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5kcmF3YWJsZS5hbmltYXRlVmVjdG9yKFwidGV4dFBhZGRpbmdcIiwgbmV3IFZlY3RvcjJEKDAsIDApLCAxNTAsIFwiZWFzZUluXCIsIGZ1bmN0aW9uKGRvbmUsIGRyYXdhYmxlKSB7XG4gICAgICAgICAgICAgICAgZHJhd2FibGUuYW5pbWF0ZVZlY3RvcihcInRleHRQYWRkaW5nXCIsIG5ldyBWZWN0b3IyRCgxMCwgMTApLCAxNTAsIFwiZWFzZU91dFwiLCBudWxsKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5kcmF3YWJsZS5hbmltYXRlKFwidGV4dFJlcGxhY2VcIiwgMCwgMTUwLCBcImVhc2VJblwiLCBmdW5jdGlvbihkb25lLCBkcmF3YWJsZSkge1xuICAgICAgICAgICAgICAgIGRyYXdhYmxlLmFuaW1hdGUoXCJ0ZXh0UmVwbGFjZVwiLCAxNSwgMTUwLCBcImVhc2VPdXRcIiwgbnVsbCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuZHJhd2FibGUuYW5pbWF0ZShcInRleHRTaXplXCIsIDAsIDE1MCwgXCJlYXNlSW5cIiwgZnVuY3Rpb24oZG9uZSwgZHJhd2FibGUpIHtcbiAgICAgICAgICAgICAgICBkcmF3YWJsZS5zZXRUZXh0KG1lLmRpZmZlcmVuY2UudG9Mb2NhbGVTdHJpbmcoJ2JlLU5MJywgeyBzdHlsZTogJ2N1cnJlbmN5JywgY3VycmVuY3k6ICdFVVInfSkpO1xuICAgICAgICAgICAgICAgIGlmKG1lLmRpZmZlcmVuY2UgPj0gMCkge1xuICAgICAgICAgICAgICAgICAgICBkcmF3YWJsZS50ZXh0QmFja2dyb3VuZCA9IFwiIzM2QjVEQlwiO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGRyYXdhYmxlLnRleHRCYWNrZ3JvdW5kID0gXCIjRTc0QzNDXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG1lLm9wZW4gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBkcmF3YWJsZS5hbmltYXRlKFwidGV4dFNpemVcIiwgMTAsIDE1MCwgXCJlYXNlT3V0XCIsIG51bGwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5yZXF1ZXN0UmVkcmF3ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGZvcih2YXIgaSA9IDAsIGwgPSB0aGlzLnRyYWRlcnMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICBpZih0aGlzLnRyYWRlcnNbaV0uZHJhd2FibGUucmVxdWVzdFJlZHJhdykge1xuICAgICAgICAgICAgICAgIHRoaXMuZHJhd2FibGUucmVxdWVzdFJlZHJhdyA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy50cmFkZXJzW2ldLmRyYXdhYmxlLnJlcXVlc3RSZWRyYXcgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZih0aGlzLmRyYXdhYmxlLnJlcXVlc3RSZWRyYXcpIHtcbiAgICAgICAgICAgIHRoaXMuZHJhd2FibGUucmVxdWVzdFJlZHJhdyA9IGZhbHNlO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG59OyIsInZhciB0cmFkZUNhbnZhcyA9IGZ1bmN0aW9uKHVzZXIpIHtcbiAgICBpZihkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRyYWRlc1wiKSAhPT0gbnVsbCkge1xuICAgICAgICAvL2RlY2xhcmUgYmFzaWMgdmFycztcbiAgICAgICAgdmFyIG9iamVjdHMgPSBbXTtcbiAgICAgICAgdmFyIGNvbXBhbmllcyA9IFtdO1xuICAgICAgICB2YXIgcHJvZmlsZSA9IG5ldyBEcmF3YWJsZSgpO1xuICAgICAgICB2YXIgdHJhc2ggPSBuZXcgRHJhd2FibGUoKTtcblxuICAgICAgICAvL2NyZWF0ZSB0aGUgcHJvZmlsZVxuICAgICAgICBwcm9maWxlLnNldEltYWdlKHVzZXIucHJvZmlsZXBpY3R1cmUsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY2FudmFzLmRyYXcoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHByb2ZpbGUucmFkaXVzID0gMTAwO1xuICAgICAgICBwcm9maWxlLmNvbG9yID0gXCIjZmZmZmZmXCI7XG4gICAgICAgIHByb2ZpbGUuYm9yZGVyQ29sb3IgPSBcIiNlZWVlZWVcIjtcbiAgICAgICAgcHJvZmlsZS5ib3JkZXJTY2FsaW5nID0gZmFsc2U7XG4gICAgICAgIHByb2ZpbGUuYm9yZGVyV2lkdGggPSAyO1xuICAgICAgICBwcm9maWxlLnRleHRTaXplID0gMTI7XG4gICAgICAgIHByb2ZpbGUudGV4dENvbG9yID0gXCIjZmZmZmZmXCI7XG4gICAgICAgIHByb2ZpbGUudGV4dEZvbnQgPSBcIlNvdXJjZVNhbnNQcm9cIjtcbiAgICAgICAgcHJvZmlsZS50ZXh0QW5jaG9yID0gbmV3IFZlY3RvcjJEKDAuNSwgMC41KTtcbiAgICAgICAgcHJvZmlsZS50ZXh0UG9zID0gbmV3IFZlY3RvcjJEKDAsIDAuNSk7XG4gICAgICAgIHByb2ZpbGUudGV4dFBhZGRpbmcgPSBuZXcgVmVjdG9yMkQoMTAsIDEwKTtcbiAgICAgICAgcHJvZmlsZS50ZXh0UmVwbGFjZSA9IDE1O1xuXG4gICAgICAgIC8vZGVmaW5lIGhvdyB0aGUgcHJvZmlsZSBpcyBkcmF3blxuICAgICAgICBwcm9maWxlLmRyYXcgPSBmdW5jdGlvbihjdHgsIHNjYWxlKSB7XG4gICAgICAgICAgICB0aGlzLmRyYXdDaXJjbGUoY3R4KTtcbiAgICAgICAgICAgIHRoaXMuZHJhd0ltYWdlSW5DaXJjbGUoY3R4KTtcbiAgICAgICAgICAgIHRoaXMuZHJhd0JvcmRlckZvckNpcmNsZShjdHgsIHNjYWxlKTtcbiAgICAgICAgICAgIHRoaXMuZHJhd1RleHQoY3R4LCBzY2FsZSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy9jcmVhdGUgdGhlIHRyYXNoIGljb25cbiAgICAgICAgdHJhc2guc2V0SW1hZ2UoXCJkaXN0L2ltYWdlcy9taXNjL3RyYXNoLnN2Z1wiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNhbnZhcy5kcmF3KCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0cmFzaC5yYWRpdXMgPSA1MDtcbiAgICAgICAgdHJhc2guY29sb3IgPSBcIiNlZWVlZWVcIjtcbiAgICAgICAgdHJhc2guYm9yZGVyQ29sb3IgPSBcIiNlZWVlZWVcIjtcbiAgICAgICAgdHJhc2guYm9yZGVyU2NhbGluZyA9IGZhbHNlO1xuICAgICAgICB0cmFzaC5ib3JkZXJXaWR0aCA9IDI7XG4gICAgICAgIHRyYXNoLnBvcyA9IG5ldyBWZWN0b3IyRCh3aW5kb3cuaW5uZXJXaWR0aCAtIDEwMCwgd2luZG93LmlubmVySGVpZ2h0IC0gMTUwKTtcblxuICAgICAgICAvL2RlZmluZSBob3cgdGhlIGludGVyYWN0aW9uIHdpdGggdGhlIHRyYXNoIGNhbiBpcyBjYWxjdWxhdGVkXG4gICAgICAgIHRyYXNoLmludGVyYWN0aW9uID0gZnVuY3Rpb24obW91c2VQb3MpIHtcbiAgICAgICAgICAgIHZhciBtb3VzZURpZmZlcmVuY2UgPSBtb3VzZVBvcy5zdWJWZWN0b3IoY2FudmFzLm1hcmdpbikuc3ViVmVjdG9yKHRoaXMucG9zKTtcbiAgICAgICAgICAgIHZhciBkaWZmZXJlbmNlID0gdGhpcy5yYWRpdXMgKiBjYW52YXMuc2NhbGU7XG4gICAgICAgICAgICByZXR1cm4gKG1vdXNlRGlmZmVyZW5jZS5sZW5ndGgoKSA8PSBkaWZmZXJlbmNlICYmIHRoaXMuc2hvdyk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy9kZWZpbmUgaG93IHRoZSB0cmFzaCBjYW4gaXMgZHJhd25cbiAgICAgICAgdHJhc2guZHJhdyA9IGZ1bmN0aW9uKGN0eCwgc2NhbGUpIHtcbiAgICAgICAgICAgIHZhciBwID0gdGhpcy5wb3Muc3ViVmVjdG9yKGNhbnZhcy5vZmZzZXQpLnN1YlZlY3RvcihjYW52YXMuY2VudGVyKS5tdWwoMSAvIGNhbnZhcy5zY2FsZSk7XG4gICAgICAgICAgICBjdHguc2F2ZSgpO1xuICAgICAgICAgICAgY3R4LnRyYW5zbGF0ZShwLngsIHAueSk7XG4gICAgICAgICAgICB0aGlzLmRyYXdDaXJjbGUoY3R4KTtcbiAgICAgICAgICAgIHRoaXMuZHJhd0ltYWdlSW5DaXJjbGUoY3R4KTtcbiAgICAgICAgICAgIHRoaXMuZHJhd0JvcmRlckZvckNpcmNsZShjdHgsIHNjYWxlKTtcbiAgICAgICAgICAgIGN0eC5yZXN0b3JlKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy9sb2FkIHRyYWRlc1xuICAgICAgICB2YXIgZGlmZiA9IDA7XG4gICAgICAgIGZvcih2YXIgaSA9IDAsIGwgPSB1c2VyLnRyYWRlcy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgIHZhciB0ID0gdXNlci50cmFkZXNbaV07XG4gICAgICAgICAgICAvL2lmIHRyYWRlIGlzbid0IGNsb3NlZCB5ZXRcbiAgICAgICAgICAgIGlmKHQuU3RvcFN0b2NrUHJpY2UgIT09IHVuZGVmaW5lZCB8fCB0LlN0b3BTdG9ja1ByaWNlIDwgMCkge1xuICAgICAgICAgICAgICAgIHZhciBjO1xuICAgICAgICAgICAgICAgIHZhciB0cmFkZXI7XG4gICAgICAgICAgICAgICAgLy9pZiB0cmFkZSBpcyBzdGFydGVkIGJ5IGN1cnJlbnQgdXNlciwgdHJhZGVyIGlzIGN1cnJlbnQgdXNlclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdC5wYXJlbnRUcmFkZSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJhZGVyID0gbmV3IFRyYWRlcih1c2VyLmZpcnN0bmFtZSArIFwiIFwiICsgdXNlci5sYXN0bmFtZSwgKHQuQW1vdW50SW52ZXN0ZWQgLyB0LlN0YXJ0U3RvY2tQcmljZSksIHQuU3RhcnRTdG9ja1ByaWNlLCB0LklzU2hvcnQsIHQuQ29tbWVudCk7XG4gICAgICAgICAgICAgICAgICAgIHRyYWRlci5kcmF3YWJsZS5zZXRJbWFnZSh1c2VyLnByb2ZpbGVwaWN0dXJlKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL2lmIHRoZSBjb21wYW55IGlzIGFscmVhZHkgYmVpbmcgZHJhd24gb24gc2NyZWVuLCBhZGQgdGhlIHRyYWRlciB0byB0aGUgY29tcGFueVxuICAgICAgICAgICAgICAgIHZhciBjb21wYW55Rm91bmQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMCwgbSA9IGNvbXBhbmllcy5sZW5ndGg7IGogPCBtOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgYyA9IGNvbXBhbmllc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGMuaWQgPT09IHQuQ29tcGFueS5faWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBhbnlGb3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBjLnRyYWRlcnMucHVzaCh0cmFkZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy9pZiBub3QsIGNyZWF0ZSBhIG5ldyBjb21wYW55IGFuZCBhZGQgdGhlIHRyYWRlciB0byBpdFxuICAgICAgICAgICAgICAgIGlmICghY29tcGFueUZvdW5kKSB7XG4gICAgICAgICAgICAgICAgICAgIGMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IHQuQ29tcGFueS5faWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInN0b2NrUHJpY2VcIjogdC5Db21wYW55LkN1cnJlbnRTdG9ja1ByaWNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0cmFkZXJzXCI6IFt0cmFkZXJdLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJpbWFnZVwiOiB0LkNvbXBhbnkuSW1hZ2VcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgY29tcGFuaWVzLnB1c2goYyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy9mb3IgZXZlcnkgY29tcGFueSwgY3JlYXRlIGEgVHJhZGUgb2JqZWN0IGFuZCBhZGQgaXQgdG8gdGhlIGNhbnZhcyBvYmplY3RzXG4gICAgICAgIGZvcih2YXIgayA9IDAsIG4gPSBjb21wYW5pZXMubGVuZ3RoOyBrIDwgbjsgaysrKSB7XG4gICAgICAgICAgICB2YXIgdHJhZGUgPSBuZXcgVHJhZGUoY29tcGFuaWVzW2tdLmlkLCBjb21wYW5pZXNba10uc3RvY2tQcmljZSwgY29tcGFuaWVzW2tdLnRyYWRlcnMsIG51bGwpO1xuICAgICAgICAgICAgdHJhZGUuZHJhd2FibGUuc2V0SW1hZ2UoY29tcGFuaWVzW2tdLmltYWdlKTtcbiAgICAgICAgICAgIG9iamVjdHMucHVzaCh0cmFkZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvL2FkZCB0aGUgcHJvZmlsZSBhbmQgdGhlIHRyYXNoY2FuXG4gICAgICAgIG9iamVjdHMucHVzaChwcm9maWxlKTtcbiAgICAgICAgb2JqZWN0cy5wdXNoKHRyYXNoKTtcblxuICAgICAgICAvL2lmIGEgdXNlciBpcyBjdXJyZW50bHkgbWFraW5nIHByb2ZpdCwgY29sb3IgdGhlIHRleHQgYmx1ZSwgaWYgbm90LCBjb2xvciBpdCByZWRcbiAgICAgICAgaWYoZGlmZiA+PSAwKSB7XG4gICAgICAgICAgICBwcm9maWxlLnRleHRCYWNrZ3JvdW5kID0gXCIjMzZCNURCXCI7XG4gICAgICAgICAgICBwcm9maWxlLnRleHRSZXBsYWNlQ29sb3IgPSBcIiMzNkI1REJcIjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHByb2ZpbGUudGV4dEJhY2tncm91bmQgPSBcIiNFNzRDM0NcIjtcbiAgICAgICAgICAgIHByb2ZpbGUudGV4dFJlcGxhY2VDb2xvciA9IFwiI0U3NEMzQ1wiO1xuICAgICAgICB9XG4gICAgICAgIHByb2ZpbGUuc2V0VGV4dCgoTWF0aC5mbG9vcihkaWZmICogMTAwKSAvIDEwMCkudG9Mb2NhbGVTdHJpbmcoJ2JlLU5MJywge3N0eWxlOiAnY3VycmVuY3knLCBjdXJyZW5jeTogJ0VVUid9KSk7XG5cbiAgICAgICAgLy9jcmVhdGUgYSBjYW52YXMsIHNldCB0aGUgb2JqZWN0cyBhbmQgc2V0IGEgY2FsbGJhY2sgdGhhdCBoYXBwZW5zIHdoZW5ldmVyIHRoZSBjYW52YXMgaXMgcmVkcmF3blxuICAgICAgICAvL3RoZSBjYW52YXMgZG9lc24ndCBuZWVkIHRvIGJlIGRyYXduIGEgZmlyc3QgdGltZSwgaXQgd2lsbCBiZSBkcmF3biBldmVyeSB0aW1lIGFuIGltYWdlIGlzIHNldFxuICAgICAgICB2YXIgY2FudmFzID0gbmV3IENhbnZhcygwLCA1MCwgd2luZG93LmlubmVyV2lkdGgsIHdpbmRvdy5pbm5lckhlaWdodCAtIDUwLCBcInRyYWRlc1wiLCBvYmplY3RzKTtcbiAgICAgICAgY2FudmFzLmRyYXdDYWxsYmFjayA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgLy9nZXQgdGhlIHVzZXJzIGxvc3MvcHJvZml0XG4gICAgICAgICAgICB2YXIgZGlmZiA9IDA7XG4gICAgICAgICAgICBmb3IodmFyIGkgPSAwLCBsID0gY2FudmFzLm9iamVjdHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYodHlwZW9mIGNhbnZhcy5vYmplY3RzW2ldLmRpZmZlcmVuY2UgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIGRpZmYgKz0gY2FudmFzLm9iamVjdHNbaV0uZGlmZmVyZW5jZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL3NldCB0aGUgdGV4dFxuICAgICAgICAgICAgaWYoZGlmZiA+PSAwKSB7XG4gICAgICAgICAgICAgICAgcHJvZmlsZS50ZXh0QmFja2dyb3VuZCA9IFwiIzM2QjVEQlwiO1xuICAgICAgICAgICAgICAgIHByb2ZpbGUudGV4dFJlcGxhY2VDb2xvciA9IFwiIzM2QjVEQlwiO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBwcm9maWxlLnRleHRCYWNrZ3JvdW5kID0gXCIjRTc0QzNDXCI7XG4gICAgICAgICAgICAgICAgcHJvZmlsZS50ZXh0UmVwbGFjZUNvbG9yID0gXCIjRTc0QzNDXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwcm9maWxlLnNldFRleHQoKE1hdGguZmxvb3IoZGlmZiAqIDEwMCkgLyAxMDApLnRvTG9jYWxlU3RyaW5nKCdiZS1OTCcsIHtzdHlsZTogJ2N1cnJlbmN5JywgY3VycmVuY3k6ICdFVVInfSkpO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vd2hlbiBhIHVzZXIgc3RhcnRzIGludGVyYWN0aW9uIHdpdGggdGhlIGNhbnZhc1xuICAgICAgICBkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH0pO1xuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRyYWRlc1wiKS5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIGludGVyYWN0aW9uU3RhcnQoZSk7XG4gICAgICAgIH0pO1xuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRyYWRlc1wiKS5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hzdGFydFwiLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICB2YXIgdG91Y2ggPSBlLnRvdWNoZXNbMF07XG4gICAgICAgICAgICBpbnRlcmFjdGlvblN0YXJ0KHRvdWNoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHZhciBpbnRlcmFjdGlvblN0YXJ0ID0gZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgLy90ZWxsIHRoZSBjYW52YXMgdGhlIGludGVyYWN0aW9uIGhhcyBzdGFydGVkXG4gICAgICAgICAgICAvL2NhbGxiYWNrIHdpbGwgcmV0dXJuIHRoZSBvYmplY3QgdGhhdCBpcyBiZWluZyBpbnRlcmFjdGVkIHdpdGggYW5kIHRoZSBtb3VzZSBwb3NpdGlvblxuICAgICAgICAgICAgY2FudmFzLmludGVyYWN0aW9uU3RhcnQoZSwgZnVuY3Rpb24ob2JqZWN0LCBtb3VzZVBvcykge1xuICAgICAgICAgICAgICAgIHZhciBpbmRleDtcbiAgICAgICAgICAgICAgICAvL2lmIHRoZSBvYmplY3QgaXMgYSBUcmFkZSwgc2V0IGl0IHRvIGJlIHRoZSB0b3Agb2JqZWN0XG4gICAgICAgICAgICAgICAgaWYob2JqZWN0IGluc3RhbmNlb2YgVHJhZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5kZXggPSBjYW52YXMub2JqZWN0cy5pbmRleE9mKG9iamVjdCk7XG4gICAgICAgICAgICAgICAgICAgIGNhbnZhcy5vYmplY3RzLnB1c2goY2FudmFzLm9iamVjdHMuc3BsaWNlKGluZGV4LCAxKVswXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vaWYgdGhlIG9iamVjdCBpcyBhIFRyYWRlciwgbWFrZSBzdXJlIGl0IHJldHVybnMgdG8gaXRzIG9yaWdpbmFsIHBvc2l0aW9uIGFmdGVyIGludGVyYWN0aW5nXG4gICAgICAgICAgICAgICAgaWYob2JqZWN0IGluc3RhbmNlb2YgVHJhZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIG9iamVjdC5kcmF3YWJsZS5yZXR1cm5Qb3MgPSBvYmplY3QuZHJhd2FibGUucG9zO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL2lmIHRoZSBvYmplY3QgaXMgdGhlIGNhbnZhcyBpdHNlbGYsIHNldCB0aGUgdHJhc2ggY2FuIHRvIGJlIHRoZSB0b3Agb2JqZWN0XG4gICAgICAgICAgICAgICAgaWYob2JqZWN0ID09PSBcInNlbGZcIikge1xuICAgICAgICAgICAgICAgICAgICBpbmRleCA9IGNhbnZhcy5vYmplY3RzLmluZGV4T2YodHJhc2gpO1xuICAgICAgICAgICAgICAgICAgICBjYW52YXMub2JqZWN0cy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICBjYW52YXMub2JqZWN0cy5wdXNoKHRyYXNoKTtcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLmRyYXcoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy9rZWVwIHRyYWNrIG9mIHdoYXQgaGFwcGVuZWQgaW4gcHJlcGFyYXRpb24gZm9yIGZ1cnRoZXIgaW50ZXJhY3Rpb25zXG4gICAgICAgICAgICAgICAgY2FudmFzLnNlbGVjdGVkID0gb2JqZWN0O1xuICAgICAgICAgICAgICAgIGNhbnZhcy5tb3VzZVBvcyA9IG1vdXNlUG9zO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy93aGVuIGEgdXNlciBtb3ZlcyB0aGUgc2VsZWN0ZWQgb2JqZWN0XG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidHJhZGVzXCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgaW50ZXJhY3Rpb25Nb3ZlKGUpO1xuICAgICAgICB9KTtcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0cmFkZXNcIikuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNobW92ZVwiLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICB2YXIgdG91Y2ggPSBlLnRvdWNoZXNbMF07XG4gICAgICAgICAgICBpbnRlcmFjdGlvbk1vdmUodG91Y2gpO1xuICAgICAgICB9KTtcbiAgICAgICAgdmFyIGludGVyYWN0aW9uTW92ZSA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIC8vdGVsbCB0aGUgY2FudmFzIHRoZSBpbnRlcmFjdGlvbiBpcyBtb3ZpbmdcbiAgICAgICAgICAgIC8vY2FudmFzIHJldHVybnMgdGhlIG9iamVjdCBiZWluZyBpbnRlcmFjdGVkIHdpdGgsIHRoZSBjdXJyZW50IG1vdXNlIHBvc2l0aW9uIGFuZCB0aGUgZGlmZmVyZW5jZSBjb21wYXJlZCB0byB0aGUgbGFzdCBtb3VzZSBwb3NpdGlvblxuICAgICAgICAgICAgY2FudmFzLmludGVyYWN0aW9uTW92ZShlLCBmdW5jdGlvbihvYmplY3QsIG1vdXNlUG9zLCBkaWZmZXJlbmNlKSB7XG4gICAgICAgICAgICAgICAgLy9pZiB0aGUgb2JqZWN0IGlzIGEgVHJhZGUsIGxvd2VyIHRoZSBvcGFjaXR5IGFuZCBtYWtlIGl0IGZvbGxvdyB0aGUgbW91c2VcbiAgICAgICAgICAgICAgICBpZihvYmplY3QgaW5zdGFuY2VvZiBUcmFkZSkge1xuICAgICAgICAgICAgICAgICAgICBvYmplY3QuZHJhd2FibGUub3BhY2l0eSA9IDAuNTtcbiAgICAgICAgICAgICAgICAgICAgb2JqZWN0LmRyYXdhYmxlLnBvcyA9IG1vdXNlUG9zO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL2lmIHRoZSBvYmplY3QgaXMgYSBUcmFkZXIsIGxvd2VyIHRoZSBvcGFjaXR5IGFuZCBtYWtlIGl0IGZvbGxvdyB0aGUgbW91c2VcbiAgICAgICAgICAgICAgICBpZihvYmplY3QgaW5zdGFuY2VvZiBUcmFkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgb2JqZWN0LmRyYXdhYmxlLm9wYWNpdHkgPSAwLjU7XG4gICAgICAgICAgICAgICAgICAgIG9iamVjdC5kcmF3YWJsZS5wb3MgPSBvYmplY3QuZHJhd2FibGUucG9zLmFkZFZlY3RvcihkaWZmZXJlbmNlLnJvdGF0ZSgtb2JqZWN0LmRyYXdhYmxlLnJvdGF0aW9uKS5tdWwoMSAvIGNhbnZhcy5zY2FsZSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL2lmIHRoZSBvYmplY3QgaXMgaG92ZXJpbmcgb3ZlciB0aGUgdHJhc2ggY2FuLCBjb2xvciB0aGUgY2FuIHJlZFxuICAgICAgICAgICAgICAgIGlmKHRyYXNoLmludGVyYWN0aW9uKG5ldyBWZWN0b3IyRChlLnBhZ2VYLCBlLnBhZ2VZKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJhc2guY29sb3IgPSBcIiNFNzRDM0NcIjtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0cmFzaC5jb2xvciA9IFwiI2VlZWVlZVwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL3JlZHJhdyB0aGUgY2FudmFzXG4gICAgICAgICAgICAgICAgY2FudmFzLmRyYXcoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vd2hlbiBhIHVzZXIgcmVsZWFzZXMgdGhlIHNlbGVjdGVkIG9iamVjdFxuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRyYWRlc1wiKS5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICBpbnRlcmFjdGlvblN0b3AoZSk7XG4gICAgICAgIH0pO1xuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRyYWRlc1wiKS5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hlbmRcIiwgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgdmFyIHRvdWNoID0gZS50b3VjaGVzWzBdO1xuICAgICAgICAgICAgaW50ZXJhY3Rpb25TdG9wKHRvdWNoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHZhciBpbnRlcmFjdGlvblN0b3AgPSBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAvL3RlbGwgdGhlIGNhbnZhcyB0aGUgdXNlciBoYXMgcmVsZWFzZWQsIHRoZSBjYWxsYmFjayByZXR1cm5zIHRoZSBvYmplY3QgYW5kIGlmIGl0IHdhcyBjbGlja2VkIG9yIGRyYWdnZWRcbiAgICAgICAgICAgIGNhbnZhcy5pbnRlcmFjdGlvblN0b3AoZnVuY3Rpb24oY2xpY2ssIG9iamVjdCkge1xuICAgICAgICAgICAgICAgIHZhciBpLCBsO1xuICAgICAgICAgICAgICAgIC8vaWYgdGhlIG9iamVjdCB3YXMgY2xpY2tlZFxuICAgICAgICAgICAgICAgIGlmKGNsaWNrKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vaWYgdGhlIG9iamVjdCB3YXMgYSBUcmFkZSwgc2V0IHRoZSBvcGFjaXR5IGJhY2sgdG8gMSBhbmQgY2xvc2UgYWxsIFRyYWRlcyBvbiB0aGUgY2FudmFzXG4gICAgICAgICAgICAgICAgICAgIGlmKG9iamVjdCBpbnN0YW5jZW9mIFRyYWRlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvYmplY3QuZHJhd2FibGUub3BhY2l0eSA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSAwLCBsID0gY2FudmFzLm9iamVjdHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNhbnZhcy5vYmplY3RzW2ldLm9wZW4gJiYgY2FudmFzLm9iamVjdHNbaV0gIT09IG9iamVjdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYW52YXMub2JqZWN0c1tpXS5jbGlja2VkKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vaWYgdGhlIG9iamVjdCB3YXMgYSBUcmFkZXIsIHNldCB0aGUgb3BhY2l0eSBiYWNrIHRvIDFcbiAgICAgICAgICAgICAgICAgICAgaWYob2JqZWN0IGluc3RhbmNlb2YgVHJhZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvYmplY3QuZHJhd2FibGUub3BhY2l0eSA9IDE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy9pZiB0aGUgb2JqZWN0IHdhcyB0aGUgY2FudmFzLCBjbG9zZSBhbGwgb2JqZWN0c1xuICAgICAgICAgICAgICAgICAgICBpZihvYmplY3QgPT09IFwic2VsZlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSAwLCBsID0gY2FudmFzLm9iamVjdHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNhbnZhcy5vYmplY3RzW2ldLm9wZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLm9iamVjdHNbaV0uY2xpY2tlZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvL2lmIHRoZSBvYmplY3RzIGhhcyBhIGNsaWNrZWQoKSBmdW5jdGlvbiwgZXhlY3V0ZSBpdFxuICAgICAgICAgICAgICAgICAgICBpZih0eXBlb2Ygb2JqZWN0LmNsaWNrZWQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdC5jbGlja2VkKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL2lmIHRoZSBvYmplY3Qgd2FzIGRyYWdnZWRcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvL2lmIHRoZSBvYmplY3QgaXMgYSBUcmFkZSwgc2V0IGl0cyBvcGFjaXR5IGJhY2sgdG8gMVxuICAgICAgICAgICAgICAgICAgICBpZihvYmplY3QgaW5zdGFuY2VvZiBUcmFkZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0LmRyYXdhYmxlLm9wYWNpdHkgPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9pZiB0aGUgb2JqZWN0IHdhcyBob3ZlcmluZyBvdmVyIHRoZSB0cmFzaCBjYW4sIHJlbW92ZSBpdFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYodHJhc2guaW50ZXJhY3Rpb24obmV3IFZlY3RvcjJEKGUucGFnZVgsIGUucGFnZVkpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdC5kZWxldGUoY2FudmFzLm9iamVjdHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vaWYgdGhlIG9iamVjdCBpcyBhIFRyYWRlciwgc2V0IGl0cyBvcGFjaXR5IGJhY2sgdG8gMVxuICAgICAgICAgICAgICAgICAgICBpZihvYmplY3QgaW5zdGFuY2VvZiBUcmFkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdC5kcmF3YWJsZS5vcGFjaXR5ID0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vaWYgdGhlIFRyYWRlciBpc24ndCBpbiBpdHMgb3JpZ2luYWwgcG9zaXRpb24sIGFuaW1hdGUgaXQgYmFjayB0byB0aGF0IHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihvYmplY3QuZHJhd2FibGUucmV0dXJuUG9zLmxlbmd0aCgpICE9PSBvYmplY3QuZHJhd2FibGUucG9zLmxlbmd0aCgpICYmIG9iamVjdC5kcmF3YWJsZS5yZXR1cm5Qb3MueCAhPT0gb2JqZWN0LmRyYXdhYmxlLnBvcy54KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0LmRyYXdhYmxlLmFuaW1hdGVWZWN0b3IoXCJwb3NcIiwgb2JqZWN0LmRyYXdhYmxlLnJldHVyblBvcywgNTAwLCBcImVhc2VJbk91dFwiLCBudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vaWYgdGhlIFRyYWRlciB3YXMgaG92ZXJpbmcgb3ZlciB0aGUgdHJhc2ggY2FuLCByZW1vdmUgaXRcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRyYXNoLmludGVyYWN0aW9uKG5ldyBWZWN0b3IyRChlLnBhZ2VYLCBlLnBhZ2VZKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3QuZGVsZXRlKGNhbnZhcy5vYmplY3RzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL3Jlc2V0IHRoZSB0cmFzaCBjYW5zIGNvbG9yIGJhY2sgdG8gZ3JheSwgc2VlaW5nIGFzIG5vIG9iamVjdCBpcyBzZWxlY3RlZCBhbnltb3JlXG4gICAgICAgICAgICAgICAgdHJhc2guY29sb3IgPSBcIiNlZWVlZWVcIjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy9yZWRyYXcgdGhlIGNhbnZhc1xuICAgICAgICAgICAgY2FudmFzLmRyYXcoKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvL3doZW4gdGhlIHVzZXIgc2Nyb2xscyB0aGUgbW91c2Ugd2hlZWwgc29tZXdoZXJlIG9uIHRoZSBjYW52YXNcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0cmFkZXNcIikuYWRkRXZlbnRMaXN0ZW5lcihcIndoZWVsXCIsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIHNjcm9sbEludGVyYWN0aW9uKGUpO1xuICAgICAgICB9KTtcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0cmFkZXNcIikuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTU1vdXNlU2Nyb2xsXCIsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIHNjcm9sbEludGVyYWN0aW9uKGUpO1xuICAgICAgICB9KTtcbiAgICAgICAgdmFyIHNjcm9sbEludGVyYWN0aW9uID0gZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgLy9kb24ndCBzY3JvbGwgdGhlIHBhZ2VcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIC8vY3Jvc3Nicm93c2VyIGNhbGN1bGF0aW9uIG9mIHRoZSBkaWZmZXJlbmNlIGJlaW5nIHNjcm9sbGVkXG4gICAgICAgICAgICB2YXIgZGVsdGEgPSAwO1xuICAgICAgICAgICAgaWYodHlwZW9mIGUud2hlZWxEZWx0YSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICBkZWx0YSA9IGUud2hlZWxEZWx0YSAvIDMwMDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZGVsdGEgPSAtZS5kZXRhaWwgLyA1MDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vY2FsY3VsYXRlIHRoZSBuZXcgc2NhbGUgYW5kIG1ha2Ugc3VyZSBpdCBzdGF5cyBpbiBiZXR3ZWVuIHRoZSBsaW1pdHNcbiAgICAgICAgICAgIHZhciBzY2FsZSA9IGNhbnZhcy5zY2FsZSArIGRlbHRhO1xuICAgICAgICAgICAgaWYoc2NhbGUgPiAxLjgpIHtcbiAgICAgICAgICAgICAgICBzY2FsZSA9IDEuODtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKHNjYWxlIDwgMC40KSB7XG4gICAgICAgICAgICAgICAgc2NhbGUgPSAwLjQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzY2FsZSA9IE1hdGguZmxvb3Ioc2NhbGUgKiAxMDApIC8gMTAwO1xuICAgICAgICAgICAgLy9zZXQgdGhlIG5ldyBzY2FsZSwgZG9uJ3Qgc2NhbGUgdGhlIHRyYXNoIGNhbiwgYXBwbHkgdGhlIHNjYWxlIHRvIHRoZSBzbGlkZXIgYW5kIHJlZHJhdyB0aGUgY2FudmFzXG4gICAgICAgICAgICBjYW52YXMuc2NhbGUgPSBzY2FsZTtcbiAgICAgICAgICAgIHRyYXNoLnJhZGl1cyA9IDUwIC8gY2FudmFzLnNjYWxlO1xuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzY2FsZUNhbnZhc1wiKS52YWx1ZSA9IGNhbnZhcy5zY2FsZTtcbiAgICAgICAgICAgIGNhbnZhcy5kcmF3KCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy93aGVuIGEgdXNlciB1c2VzIHRoZSBzbGlkZXIsIHNjYWxlIHRoZSBjYW52YXNcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzY2FsZUNhbnZhc1wiKS5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY2FudmFzLnNjYWxlID0gcGFyc2VGbG9hdCh0aGlzLnZhbHVlKTtcbiAgICAgICAgICAgIHRyYXNoLnJhZGl1cyA9IDUwIC8gY2FudmFzLnNjYWxlO1xuICAgICAgICAgICAgY2FudmFzLmRyYXcoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy93aGVuIGEgdXNlciBjbGlja3MgdGhlIGNlbnRlciBidXR0b24sIHRlbGwgdGhlIGNhbnZhcyB0byBjZW50ZXIgaXRzZWxmXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmVzZXRPZmZzZXRcIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY2FudmFzLm1vdmVUb0NlbnRlcigpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvL3doZW4gYSB1c2VyIHJlc2l6ZXMgdGhlIHBhZ2UsIHJlc2l6ZSB0aGUgY2FudmFzIGFuZCByZXBvc2l0aW9uIHRoZSB0cmFzaCBjYW5cbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjYW52YXMuc2V0U2l6ZSh3aW5kb3cuaW5uZXJXaWR0aCwgd2luZG93LmlubmVySGVpZ2h0IC0gNTApO1xuICAgICAgICAgICAgdHJhc2gucG9zID0gbmV3IFZlY3RvcjJEKHdpbmRvdy5pbm5lcldpZHRoIC0gMTAwLCB3aW5kb3cuaW5uZXJIZWlnaHQgLSAxNTApO1xuICAgICAgICB9KTtcbiAgICB9XG5cbn07Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
