function Trader(e,t,a,r,i){this.name=e,this.amount=t,this.inAt=a,this.comment=i,this.isShort=r,this.difference=0,console.log(this.amount,this.inAt),this.drawable=new Drawable,this.drawable.color="#ffffff",this.drawable.borderColor="#B3B369",this.drawable.borderWidth=2,this.drawable.borderScaling=!1,this.drawable.textFont="SourceSansPro",this.drawable.textAnchor=new Vector2D(0,1),this.drawable.textBackground="#ffffff",this.drawable.textPadding=new Vector2D(0,0),this.drawable.textScaling=!1,this.drawable.textPos=new Vector2D(1,-1),this.drawable.textColor="#2C3E50",this.drawable.pos=new Vector2D(0,0),this.drawable.radius=25,this.drawable.show=!1,this["new"]=!0,this.open=!1,this.changeStockPrice=function(e){var r="[b]"+this.name+"[/b][align=right][color=",i=Math.floor((e-this.inAt)*this.amount*100)/100,n="#36B5DB",o="#E74C3C";this.isShort?this.difference=-i:this.difference=i,r+=this.difference>=0?n+"]":o+"]",r+=this.difference.toLocaleString("be-NL",{style:"currency",currency:"EUR"})+"[/color][/align]\n[i][color=",r+=this.isShort?o+"]":n+"]",r+=t,r+=this.isShort?" short at ":" long at ",r+=a.toLocaleString("be-NL",{style:"currency",currency:"EUR"})+"[/color][/i]\n",this.drawable.setText(r+this.comment)},this.draw=function(e,t){if(this.drawable.show){var a=this.drawable.pos.rotate(this.drawable.rotation);e.save(),e.globalAlpha*=this.drawable.opacity,e.translate(a.x,a.y),this.drawable.drawCircle(e),this.drawable.drawImageInCircle(e),this.drawable.drawBorderForCircle(e,t),e.restore()}},this.postDraw=function(e,t){if(this.drawable.show){var a=this.drawable.pos.rotate(this.drawable.rotation);e.save(),e.globalAlpha*=this.drawable.opacity,e.translate(a.x,a.y),this.drawable.drawText(e,t),e.restore()}},this.clicked=function(){var e=this;this.open?(this.drawable.animate("textSize",0,200,"easeInOut",null),this.drawable.animateVector("textPadding",new Vector2D(0,0),200,"easeInOut",function(t,a){t&&(e.open=!1)})):(this.drawable.animate("textSize",12,200,"easeInOut",null),this.drawable.animateVector("textPadding",new Vector2D(10,10),200,"easeInOut",function(t,a){t&&(e.open=!0)}))},this["delete"]=function(e,t){var a=0;"undefined"!=typeof t&&(a=t);for(var r=e.length;r>a;a++)if("undefined"!=typeof e[a].traders){var i=e[a].traders.indexOf(this);if(i>-1){e[a].traders.splice(i,1),e[a].calcTraders(),0===e[a].traders.length&&e[a].animateDelete(e,a);break}}},this.interaction=function(e,t){var a=e.subVector(this.drawable.pos.rotate(this.drawable.rotation).mul(t)),r=0;return 0!==this.drawable.radius&&(r=this.drawable.radius*t),0!==this.drawable.size.length()&&(r=this.drawable.size.length()*t),a.length()<=r&&this.drawable.show?(this["new"]&&(this["new"]=!1,this.drawable.borderColor="#eeeeee"),this):!1}}var Trade=function(e,a,r,i){this.id=e,this.stockPrice=a,this.traders=r,this.drawable=new Drawable,this.difference=0;for(var n=0,o=this.traders.length;o>n;n++)this.traders[n].changeStockPrice(this.stockPrice),this.difference+=this.traders[n].difference;if(this.difference=Math.floor(100*this.difference)/100,this.drawable.setText(this.difference.toLocaleString("be-NL",{style:"currency",currency:"EUR"})),this.difference>=0?(this.drawable.textBackground="#36B5DB",this.drawable.textReplaceColor="#36B5DB"):(this.drawable.textBackground="#E74C3C",this.drawable.textReplaceColor="#E74C3C"),this.lineColor="#B3B369",this.open=!1,this.drawable.textSize=10,this.drawable.radius=Math.floor(35*Math.random()+35),this.drawable.imgFill=!1,null===i){for(var s=Math.floor(Math.random()*window.innerWidth-window.innerWidth/2),d=Math.floor(Math.random()*(window.innerHeight-50)-(window.innerHeight-50)/2);new Vector2D(s,d).length()<100+this.drawable.radius||new Vector2D(s,d).length()>new Vector2D(window.innerWidth,window.innerHeight-50).div(2).length()-this.drawable.radius;)s=Math.floor(Math.random()*window.innerWidth-window.innerWidth/2),d=Math.floor(Math.random()*(window.innerHeight-50)-(window.innerHeight-50)/2);this.drawable.animateVector("pos",new Vector2D(s,d),1e3,"easeInOut",null)}else this.drawable.animateVector("pos",i,1e3,"easeInOut",null);this.drawable.color="#ffffff",this.drawable.borderWidth=2,this.drawable.borderColor="#B3B369",this.drawable.borderScaling=!1,this.drawable.textColor="#ffffff",this.drawable.textFont="SourceSansPro",this.drawable.textAnchor=new Vector2D(.5,.5),this.drawable.textPos=new Vector2D(0,.5),this.drawable.textPadding=new Vector2D(10,10),this.drawable.textReplace=15;var l=this;setInterval(function(){var e=Math.random()/10,t=Math.floor(2*Math.random());1===t&&(e=-e),l.stockPrice=Math.floor(100*(l.stockPrice+e))/100,l.difference=0;for(var a=0,r=l.traders.length;r>a;a++)l.traders[a].changeStockPrice(l.stockPrice),l.difference+=l.traders[a].difference;l.difference=Math.floor(100*l.difference)/100,l.open?(l.difference>=0?l.drawable.textReplaceColor="#36B5DB":l.drawable.textReplaceColor="#E74C3C",l.drawable.textBackground="#2C3E50",l.drawable.setText(l.stockPrice.toLocaleString("be-NL",{style:"currency",currency:"EUR"}))):(l.drawable.setText(l.difference.toLocaleString("be-NL",{style:"currency",currency:"EUR"})),l.difference>=0?(l.drawable.textBackground="#36B5DB",l.drawable.textReplaceColor="#36B5DB"):(l.drawable.textBackground="#E74C3C",l.drawable.textReplaceColor="#E74C3C")),l.drawable.requestRedraw=!0},2e3),this.interaction=function(e,a){var r=e.subVector(this.drawable.pos.mul(a)),i=0;if(0!==this.drawable.radius&&(i=this.drawable.radius*a),0!==this.drawable.size.length()&&(i=this.drawable.size.length()*a),r.length()<=i)return this;for(var n=e.subVector(this.drawable.pos.mul(a)),o=0,s=this.traders.length;s>o;o++){var d=this.traders[o].interaction(n,a);if(d!==!1){for(var l=0,c=this.traders.length;c>l;l++)t=this.traders[l],t.open&&t.clicked();return d}}return!1},this.calcTraders=function(){for(var e=180/(this.traders.length+1),t=0,a=this.traders.length;a>t;t++){var r=e*(t+1-(this.traders.length+1)/2)-90;this.traders[t].drawable.animate("rotation",r,300,"easeInOut",null)}},this.calcTraders(),this.preDraw=function(e,t){if(this.drawable.show){e.save(),e.globalAlpha*=this.drawable.opacity,e.strokeStyle=this.lineColor,e.lineWidth=.5;for(var a=!1,r=0,i=this.traders.length;i>r;r++)this.traders[r]["new"]&&(a=!0);a?this.lineColor="#B3B369":this.lineColor="#2C3E50",e.beginPath(),e.moveTo(0,0),e.lineTo(this.drawable.pos.x,this.drawable.pos.y),e.closePath(),e.stroke(),e.restore()}},this.draw=function(e,t){if(this.drawable.show){e.save(),e.translate(this.drawable.pos.x,this.drawable.pos.y),e.globalAlpha*=this.drawable.opacity;for(var a=!1,r=0,i=this.traders.length;i>r;r++)this.traders[r].draw(e,t),this.traders[r]["new"]&&(a=!0);a?this.drawable.borderColor="#B3B369":this.drawable.borderColor="#eeeeee",this.drawable.drawCircle(e),this.drawable.drawImageInCircle(e),this.drawable.drawBorderForCircle(e,t),this.drawable.drawText(e,t),e.restore()}},this["delete"]=function(e){for(var t=e.indexOf(this),a=0,r=this.traders.length;r>a;a++)this.traders[0]["delete"](e,t)},this.animateDelete=function(e,t){this.drawable.animate("textSize",0,300,"easeInOut",null),this.drawable.animate("textReplace",0,300,"easeInOut",null),this.drawable.animateVector("textPadding",new Vector2D(0,0),300,"easeInOut",null),this.drawable.animate("opacity",0,300,"easeInOut",null),this.drawable.animate("radius",0,300,"easeInOut",function(){e.splice(t,1)})},this.postDraw=function(e,t){if(this.drawable.show){e.save(),e.globalAlpha*=this.drawable.opacity,e.translate(this.drawable.pos.x,this.drawable.pos.y);for(var a=0,r=this.traders.length;r>a;a++)this.traders[a].postDraw(e,t);e.restore()}},this.clicked=function(){var e=0,t=0,a=null,r=this;if(this.open){var i=function(e,t){t.show=!1};for(t=this.traders.length;t>e;e++)a=this.traders[e],a.open&&a.clicked(),a.drawable.animateVector("pos",new Vector2D(0,0),300,"easeInOut",i);this.drawable.animateVector("textPadding",new Vector2D(0,0),150,"easeIn",function(e,t){t.animateVector("textPadding",new Vector2D(10,10),150,"easeOut",null)}),this.drawable.animate("textReplace",0,150,"easeIn",function(e,t){t.animate("textReplace",15,150,"easeOut",null)}),this.drawable.animate("textSize",0,150,"easeIn",function(e,t){t.setText(r.difference.toLocaleString("be-NL",{style:"currency",currency:"EUR"})),r.difference>=0?t.textBackground="#36B5DB":t.textBackground="#E74C3C",r.open=!1,t.animate("textSize",10,150,"easeOut",null)})}else{for(t=this.traders.length;t>e;e++)a=this.traders[e],a.drawable.show=!0,a.drawable.animateVector("pos",new Vector2D(0,this.drawable.radius+a.drawable.radius+15),300,"easeInOut",null);this.drawable.animateVector("textPadding",new Vector2D(0,0),150,"easeIn",function(e,t){t.animateVector("textPadding",new Vector2D(10,10),150,"easeOut",null)}),this.drawable.animate("textReplace",0,150,"easeIn",function(e,t){t.animate("textReplace",15,150,"easeOut",null)}),this.drawable.animate("textSize",0,150,"easeIn",function(e,t){t.textBackground="#2C3E50",t.setText(r.stockPrice.toLocaleString("be-NL",{style:"currency",currency:"EUR"})),r.open=!0,t.animate("textSize",10,150,"easeOut",null)})}},this.requestRedraw=function(){for(var e=0,t=this.traders.length;t>e;e++)this.traders[e].drawable.requestRedraw&&(this.drawable.requestRedraw=!0,this.traders[e].drawable.requestRedraw=!1);return this.drawable.requestRedraw?(this.drawable.requestRedraw=!1,!0):!1}},tradeCanvas=function(e){if(null!==document.getElementById("trades")){var t=[],a=[],r=new Drawable,i=new Drawable;r.setImage(e.profilepicture,function(){p.draw()}),r.radius=100,r.color="#ffffff",r.borderColor="#eeeeee",r.borderScaling=!1,r.borderWidth=2,r.textSize=12,r.textColor="#ffffff",r.textFont="SourceSansPro",r.textAnchor=new Vector2D(.5,.5),r.textPos=new Vector2D(0,.5),r.textPadding=new Vector2D(10,10),r.textReplace=15,r.draw=function(e,t){this.drawCircle(e),this.drawImageInCircle(e),this.drawBorderForCircle(e,t),this.drawText(e,t)},i.setImage("dist/images/misc/trash.svg",function(){p.draw()}),i.radius=50,i.color="#eeeeee",i.borderColor="#eeeeee",i.borderScaling=!1,i.borderWidth=2,i.pos=new Vector2D(window.innerWidth-100,window.innerHeight-150),i.interaction=function(e){var t=e.subVector(p.margin).subVector(this.pos),a=this.radius*p.scale;return t.length()<=a&&this.show},i.draw=function(e,t){var a=this.pos.subVector(p.offset).subVector(p.center).mul(1/p.scale);e.save(),e.translate(a.x,a.y),this.drawCircle(e),this.drawImageInCircle(e),this.drawBorderForCircle(e,t),e.restore()};for(var n=0,o=0,s=e.trades.length;s>o;o++){var d=e.trades[o];if(void 0!==d.StopStockPrice||d.StopStockPrice<0){var l,c;"undefined"==typeof d.parentTrade?(c=new Trader(e.firstname+" "+e.lastname,d.AmountInvested/d.StartStockPrice,d.StartStockPrice,d.IsShort,d.Comment),c.drawable.setImage(e.profilepicture)):console.log(d);for(var h=!1,w=0,u=a.length;u>w;w++)if(l=a[w],l.id===d.Company._id){h=!0,l.traders.push(c);break}h||(l={id:d.Company._id,stockPrice:d.Company.CurrentStockPrice,traders:[c],image:d.Company.Image},a.push(l))}}for(var f=0,b=a.length;b>f;f++){var g=new Trade(a[f].id,a[f].stockPrice,a[f].traders,null);g.drawable.setImage(a[f].image),t.push(g)}t.push(r),t.push(i),n>=0?(r.textBackground="#36B5DB",r.textReplaceColor="#36B5DB"):(r.textBackground="#E74C3C",r.textReplaceColor="#E74C3C"),r.setText((Math.floor(100*n)/100).toLocaleString("be-NL",{style:"currency",currency:"EUR"}));var p=new Canvas(0,50,window.innerWidth,window.innerHeight-50,"trades",t);p.drawCallback=function(){for(var e=0,t=0,a=p.objects.length;a>t;t++)"undefined"!=typeof p.objects[t].difference&&(e+=p.objects[t].difference);e>=0?(r.textBackground="#36B5DB",r.textReplaceColor="#36B5DB"):(r.textBackground="#E74C3C",r.textReplaceColor="#E74C3C"),r.setText((Math.floor(100*e)/100).toLocaleString("be-NL",{style:"currency",currency:"EUR"}))},document.body.addEventListener("touchstart",function(e){e.preventDefault()}),document.getElementById("trades").addEventListener("mousedown",function(e){m(e)}),document.getElementById("trades").addEventListener("touchstart",function(e){var t=e.touches[0];m(t)});var m=function(e){p.interactionStart(e,function(e,t){var a;e instanceof Trade&&(a=p.objects.indexOf(e),p.objects.push(p.objects.splice(a,1)[0])),e instanceof Trader&&(e.drawable.returnPos=e.drawable.pos),"self"===e&&(a=p.objects.indexOf(i),p.objects.splice(a,1),p.objects.push(i),p.draw()),p.selected=e,p.mousePos=t})};document.getElementById("trades").addEventListener("mousemove",function(e){v(e)}),document.getElementById("trades").addEventListener("touchmove",function(e){var t=e.touches[0];v(t)});var v=function(e){p.interactionMove(e,function(t,a,r){t instanceof Trade&&(t.drawable.opacity=.5,t.drawable.pos=a),t instanceof Trader&&(t.drawable.opacity=.5,t.drawable.pos=t.drawable.pos.addVector(r.rotate(-t.drawable.rotation).mul(1/p.scale))),i.interaction(new Vector2D(e.pageX,e.pageY))?i.color="#E74C3C":i.color="#eeeeee",p.draw()})};document.getElementById("trades").addEventListener("mouseup",function(e){x(e)}),document.getElementById("trades").addEventListener("touchend",function(e){var t=e.touches[0];x(t)});var x=function(e){p.interactionStop(function(t,a){var r,n;if(t){if(a instanceof Trade)for(a.drawable.opacity=1,r=0,n=p.objects.length;n>r;r++)p.objects[r].open&&p.objects[r]!==a&&p.objects[r].clicked();if(a instanceof Trader&&(a.drawable.opacity=1),"self"===a)for(r=0,n=p.objects.length;n>r;r++)p.objects[r].open&&p.objects[r].clicked();"function"==typeof a.clicked&&a.clicked()}else a instanceof Trade&&(a.drawable.opacity=1,i.interaction(new Vector2D(e.pageX,e.pageY))&&a["delete"](p.objects)),a instanceof Trader&&(a.drawable.opacity=1,a.drawable.returnPos.length()!==a.drawable.pos.length()&&a.drawable.returnPos.x!==a.drawable.pos.x&&a.drawable.animateVector("pos",a.drawable.returnPos,500,"easeInOut",null),i.interaction(new Vector2D(e.pageX,e.pageY))&&a["delete"](p.objects));i.color="#eeeeee"}),p.draw()};document.getElementById("trades").addEventListener("wheel",function(e){C(e)}),document.getElementById("trades").addEventListener("DOMMouseScroll",function(e){C(e)});var C=function(e){e.preventDefault();var t=0;t="undefined"!=typeof e.wheelDelta?e.wheelDelta/300:-e.detail/50;var a=p.scale+t;a>1.8&&(a=1.8),.4>a&&(a=.4),a=Math.floor(100*a)/100,p.scale=a,i.radius=50/p.scale,document.getElementById("scaleCanvas").value=p.scale,p.draw()};document.getElementById("scaleCanvas").addEventListener("mousemove",function(){p.scale=parseFloat(this.value),i.radius=50/p.scale,p.draw()}),document.getElementById("resetOffset").addEventListener("click",function(){p.moveToCenter()}),window.addEventListener("resize",function(){p.setSize(window.innerWidth,window.innerHeight-50),i.pos=new Vector2D(window.innerWidth-100,window.innerHeight-150)})}};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRyYWRlci5qcyIsInRyYWRlLmpzIiwidHJhZGVDYW52YXMuanMiXSwibmFtZXMiOlsiVHJhZGVyIiwibmFtZSIsImFtb3VudCIsImluQXQiLCJpc1Nob3J0IiwiY29tbWVudCIsInRoaXMiLCJkaWZmZXJlbmNlIiwiY29uc29sZSIsImxvZyIsImRyYXdhYmxlIiwiRHJhd2FibGUiLCJjb2xvciIsImJvcmRlckNvbG9yIiwiYm9yZGVyV2lkdGgiLCJib3JkZXJTY2FsaW5nIiwidGV4dEZvbnQiLCJ0ZXh0QW5jaG9yIiwiVmVjdG9yMkQiLCJ0ZXh0QmFja2dyb3VuZCIsInRleHRQYWRkaW5nIiwidGV4dFNjYWxpbmciLCJ0ZXh0UG9zIiwidGV4dENvbG9yIiwicG9zIiwicmFkaXVzIiwic2hvdyIsIm9wZW4iLCJjaGFuZ2VTdG9ja1ByaWNlIiwic3RvY2tQcmljZSIsInByZXNldCIsImRpZmYiLCJNYXRoIiwiZmxvb3IiLCJuZWciLCJ0b0xvY2FsZVN0cmluZyIsInN0eWxlIiwiY3VycmVuY3kiLCJzZXRUZXh0IiwiZHJhdyIsImN0eCIsInNjYWxlIiwicCIsInJvdGF0ZSIsInJvdGF0aW9uIiwic2F2ZSIsImdsb2JhbEFscGhhIiwib3BhY2l0eSIsInRyYW5zbGF0ZSIsIngiLCJ5IiwiZHJhd0NpcmNsZSIsImRyYXdJbWFnZUluQ2lyY2xlIiwiZHJhd0JvcmRlckZvckNpcmNsZSIsInJlc3RvcmUiLCJwb3N0RHJhdyIsImRyYXdUZXh0IiwiY2xpY2tlZCIsIm1lIiwiYW5pbWF0ZSIsImFuaW1hdGVWZWN0b3IiLCJmaW5pc2hlZCIsImVsZW1lbnQiLCJ0cmFkZXMiLCJpbmRleCIsImkiLCJsIiwibGVuZ3RoIiwidHJhZGVycyIsImluZCIsImluZGV4T2YiLCJzcGxpY2UiLCJjYWxjVHJhZGVycyIsImFuaW1hdGVEZWxldGUiLCJpbnRlcmFjdGlvbiIsIm1vdXNlUG9zIiwibW91c2VEaWZmZXJlbmNlIiwic3ViVmVjdG9yIiwibXVsIiwic2l6ZSIsIlRyYWRlIiwiaWQiLCJ0ZXh0UmVwbGFjZUNvbG9yIiwibGluZUNvbG9yIiwidGV4dFNpemUiLCJyYW5kb20iLCJpbWdGaWxsIiwid2luZG93IiwiaW5uZXJXaWR0aCIsImlubmVySGVpZ2h0IiwiZGl2IiwidGV4dFJlcGxhY2UiLCJzZXRJbnRlcnZhbCIsImQiLCJwT20iLCJyZXF1ZXN0UmVkcmF3IiwicmVsUG9zIiwibyIsImoiLCJtIiwidCIsImFuZ2xlIiwiYWxwaGEiLCJwcmVEcmF3Iiwic3Ryb2tlU3R5bGUiLCJsaW5lV2lkdGgiLCJuZXdUcmFkZXIiLCJiZWdpblBhdGgiLCJtb3ZlVG8iLCJsaW5lVG8iLCJjbG9zZVBhdGgiLCJzdHJva2UiLCJmIiwiZG9uZSIsInRyYWRlQ2FudmFzIiwidXNlciIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJvYmplY3RzIiwiY29tcGFuaWVzIiwicHJvZmlsZSIsInRyYXNoIiwic2V0SW1hZ2UiLCJwcm9maWxlcGljdHVyZSIsImNhbnZhcyIsIm1hcmdpbiIsIm9mZnNldCIsImNlbnRlciIsInVuZGVmaW5lZCIsIlN0b3BTdG9ja1ByaWNlIiwiYyIsInRyYWRlciIsInBhcmVudFRyYWRlIiwiZmlyc3RuYW1lIiwibGFzdG5hbWUiLCJBbW91bnRJbnZlc3RlZCIsIlN0YXJ0U3RvY2tQcmljZSIsIklzU2hvcnQiLCJDb21tZW50IiwiY29tcGFueUZvdW5kIiwiQ29tcGFueSIsIl9pZCIsInB1c2giLCJDdXJyZW50U3RvY2tQcmljZSIsImltYWdlIiwiSW1hZ2UiLCJrIiwibiIsInRyYWRlIiwiQ2FudmFzIiwiZHJhd0NhbGxiYWNrIiwiYm9keSIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwicHJldmVudERlZmF1bHQiLCJpbnRlcmFjdGlvblN0YXJ0IiwidG91Y2giLCJ0b3VjaGVzIiwib2JqZWN0IiwicmV0dXJuUG9zIiwic2VsZWN0ZWQiLCJpbnRlcmFjdGlvbk1vdmUiLCJhZGRWZWN0b3IiLCJwYWdlWCIsInBhZ2VZIiwiaW50ZXJhY3Rpb25TdG9wIiwiY2xpY2siLCJzY3JvbGxJbnRlcmFjdGlvbiIsImRlbHRhIiwid2hlZWxEZWx0YSIsImRldGFpbCIsInZhbHVlIiwicGFyc2VGbG9hdCIsIm1vdmVUb0NlbnRlciIsInNldFNpemUiXSwibWFwcGluZ3MiOiJBQUFBLFFBQUFBLFFBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEdBQ0FDLEtBQUFMLEtBQUFBLEVBQ0FLLEtBQUFKLE9BQUFBLEVBQ0FJLEtBQUFILEtBQUFBLEVBQ0FHLEtBQUFELFFBQUFBLEVBQ0FDLEtBQUFGLFFBQUFBLEVBQ0FFLEtBQUFDLFdBQUEsRUFFQUMsUUFBQUMsSUFBQUgsS0FBQUosT0FBQUksS0FBQUgsTUFDQUcsS0FBQUksU0FBQSxHQUFBQyxVQUVBTCxLQUFBSSxTQUFBRSxNQUFBLFVBRUFOLEtBQUFJLFNBQUFHLFlBQUEsVUFDQVAsS0FBQUksU0FBQUksWUFBQSxFQUNBUixLQUFBSSxTQUFBSyxlQUFBLEVBQ0FULEtBQUFJLFNBQUFNLFNBQUEsZ0JBQ0FWLEtBQUFJLFNBQUFPLFdBQUEsR0FBQUMsVUFBQSxFQUFBLEdBQ0FaLEtBQUFJLFNBQUFTLGVBQUEsVUFDQWIsS0FBQUksU0FBQVUsWUFBQSxHQUFBRixVQUFBLEVBQUEsR0FDQVosS0FBQUksU0FBQVcsYUFBQSxFQUNBZixLQUFBSSxTQUFBWSxRQUFBLEdBQUFKLFVBQUEsRUFBQSxJQUNBWixLQUFBSSxTQUFBYSxVQUFBLFVBRUFqQixLQUFBSSxTQUFBYyxJQUFBLEdBQUFOLFVBQUEsRUFBQSxHQUVBWixLQUFBSSxTQUFBZSxPQUFBLEdBRUFuQixLQUFBSSxTQUFBZ0IsTUFBQSxFQUVBcEIsS0FBQUEsUUFBQSxFQUNBQSxLQUFBcUIsTUFBQSxFQUVBckIsS0FBQXNCLGlCQUFBLFNBQUFDLEdBQ0EsR0FBQUMsR0FBQSxNQUFBeEIsS0FBQUwsS0FBQSwyQkFDQThCLEVBQUFDLEtBQUFDLE9BQUFKLEVBQUF2QixLQUFBSCxNQUFBRyxLQUFBSixPQUFBLEtBQUEsSUFDQXNCLEVBQUEsVUFDQVUsRUFBQSxTQUNBNUIsTUFB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LE1BQ0FBLEVBQUEsS0FFQSxHQUFBQSxJQUNBQSxFQUFBLElBRUFBLEVBQUFULEtBQUFDLE1BQUEsSUFBQVEsR0FBQSxJQUVBbUYsRUFBQW5GLE1BQUFBLEVBQ0FnRixFQUFBaEcsT0FBQSxHQUFBbUcsRUFBQW5GLE1BQ0EyRSxTQUFBQyxlQUFBLGVBQUFzRCxNQUFBL0MsRUFBQW5GLE1BQ0FtRixFQUFBckYsT0FJQTZFLFVBQUFDLGVBQUEsZUFBQW1DLGlCQUFBLFlBQUEsV0FDQTVCLEVBQUFuRixNQUFBbUksV0FBQXRLLEtBQUFxSyxPQUNBbEQsRUFBQWhHLE9BQUEsR0FBQW1HLEVBQUFuRixNQUNBbUYsRUFBQXJGLFNBSUE2RSxTQUFBQyxlQUFBLGVBQUFtQyxpQkFBQSxRQUFBLFdBQ0E1QixFQUFBaUQsaUJBSUF0RixPQUFBaUUsaUJBQUEsU0FBQSxXQUNBNUIsRUFBQWtELFFBQUF2RixPQUFBQyxXQUFBRCxPQUFBRSxZQUFBLElBQ0FnQyxFQUFBakcsSUFBQSxHQUFBTixVQUFBcUUsT0FBQUMsV0FBQSxJQUFBRCxPQUFBRSxZQUFBIiwiZmlsZSI6ImFwcC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBUcmFkZXIobmFtZSwgYW1vdW50LCBpbkF0LCBpc1Nob3J0LCBjb21tZW50KSB7XG4gICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICB0aGlzLmFtb3VudCA9IGFtb3VudDtcbiAgICB0aGlzLmluQXQgPSBpbkF0O1xuICAgIHRoaXMuY29tbWVudCA9IGNvbW1lbnQ7XG4gICAgdGhpcy5pc1Nob3J0ID0gaXNTaG9ydDtcbiAgICB0aGlzLmRpZmZlcmVuY2UgPSAwO1xuXG4gICAgY29uc29sZS5sb2codGhpcy5hbW91bnQsIHRoaXMuaW5BdCk7XG4gICAgdGhpcy5kcmF3YWJsZSA9IG5ldyBEcmF3YWJsZSgpO1xuXG4gICAgdGhpcy5kcmF3YWJsZS5jb2xvciA9IFwiI2ZmZmZmZlwiO1xuXG4gICAgdGhpcy5kcmF3YWJsZS5ib3JkZXJDb2xvciA9IFwiI0IzQjM2OVwiO1xuICAgIHRoaXMuZHJhd2FibGUuYm9yZGVyV2lkdGggPSAyO1xuICAgIHRoaXMuZHJhd2FibGUuYm9yZGVyU2NhbGluZyA9IGZhbHNlO1xuICAgIHRoaXMuZHJhd2FibGUudGV4dEZvbnQgPSBcIlNvdXJjZVNhbnNQcm9cIjtcbiAgICB0aGlzLmRyYXdhYmxlLnRleHRBbmNob3IgPSBuZXcgVmVjdG9yMkQoMCwgMSk7XG4gICAgdGhpcy5kcmF3YWJsZS50ZXh0QmFja2dyb3VuZCA9IFwiI2ZmZmZmZlwiO1xuICAgIHRoaXMuZHJhd2FibGUudGV4dFBhZGRpbmcgPSBuZXcgVmVjdG9yMkQoMCwgMCk7XG4gICAgdGhpcy5kcmF3YWJsZS50ZXh0U2NhbGluZyA9IGZhbHNlO1xuICAgIHRoaXMuZHJhd2FibGUudGV4dFBvcyA9IG5ldyBWZWN0b3IyRCgxLCAtMSk7XG4gICAgdGhpcy5kcmF3YWJsZS50ZXh0Q29sb3IgPSBcIiMyQzNFNTBcIjtcblxuICAgIHRoaXMuZHJhd2FibGUucG9zID0gbmV3IFZlY3RvcjJEKDAsIDApO1xuXG4gICAgdGhpcy5kcmF3YWJsZS5yYWRpdXMgPSAyNTtcblxuICAgIHRoaXMuZHJhd2FibGUuc2hvdyA9IGZhbHNlO1xuXG4gICAgdGhpcy5uZXcgPSB0cnVlO1xuICAgIHRoaXMub3BlbiA9IGZhbHNlO1xuXG4gICAgdGhpcy5jaGFuZ2VTdG9ja1ByaWNlID0gZnVuY3Rpb24oc3RvY2tQcmljZSkge1xuICAgICAgICB2YXIgcHJlc2V0ID0gXCJbYl1cIiArIHRoaXMubmFtZSArIFwiWy9iXVthbGlnbj1yaWdodF1bY29sb3I9XCI7XG4gICAgICAgIHZhciBkaWZmID0gTWF0aC5mbG9vcigoc3RvY2tQcmljZSAtIHRoaXMuaW5BdCkgKiB0aGlzLmFtb3VudCAqIDEwMCkgLyAxMDA7XG4gICAgICAgIHZhciBwb3MgPSBcIiMzNkI1REJcIjtcbiAgICAgICAgdmFyIG5lZyA9IFwiI0U3NEMzQ1wiO1xuICAgICAgICBpZighdGhpcy5pc1Nob3J0KSB7XG4gICAgICAgICAgICB0aGlzLmRpZmZlcmVuY2UgPSBkaWZmO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5kaWZmZXJlbmNlID0gLWRpZmY7XG4gICAgICAgIH1cbiAgICAgICAgaWYodGhpcy5kaWZmZXJlbmNlID49IDApIHtcbiAgICAgICAgICAgIHByZXNldCArPSBwb3MgKyBcIl1cIjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHByZXNldCArPSBuZWcgKyBcIl1cIjtcbiAgICAgICAgfVxuICAgICAgICBwcmVzZXQgKz0gdGhpcy5kaWZmZXJlbmNlLnRvTG9jYWxlU3RyaW5nKCdiZS1OTCcsIHtzdHlsZTogJ2N1cnJlbmN5JywgY3VycmVuY3k6ICdFVVInfSkgKyBcIlsvY29sb3JdWy9hbGlnbl1cXG5baV1bY29sb3I9XCI7XG4gICAgICAgIGlmKCF0aGlzLmlzU2hvcnQpIHtcbiAgICAgICAgICAgIHByZXNldCArPSBwb3MgKyBcIl1cIjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHByZXNldCArPSBuZWcgKyBcIl1cIjtcbiAgICAgICAgfVxuICAgICAgICBwcmVzZXQgKz0gYW1vdW50O1xuICAgICAgICBpZighdGhpcy5pc1Nob3J0KSB7XG4gICAgICAgICAgICBwcmVzZXQgKz0gXCIgbG9uZyBhdCBcIjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHByZXNldCArPSBcIiBzaG9ydCBhdCBcIjtcbiAgICAgICAgfVxuICAgICAgICBwcmVzZXQgKz0gaW5BdC50b0xvY2FsZVN0cmluZygnYmUtTkwnLCB7c3R5bGU6ICdjdXJyZW5jeScsIGN1cnJlbmN5OiAnRVVSJ30pICsgXCJbL2NvbG9yXVsvaV1cXG5cIjtcbiAgICAgICAgdGhpcy5kcmF3YWJsZS5zZXRUZXh0KHByZXNldCArIHRoaXMuY29tbWVudCk7XG4gICAgfTtcblxuICAgIHRoaXMuZHJhdyA9IGZ1bmN0aW9uKGN0eCwgc2NhbGUpIHtcbiAgICAgICAgaWYodGhpcy5kcmF3YWJsZS5zaG93KSB7XG4gICAgICAgICAgICB2YXIgcCA9IHRoaXMuZHJhd2FibGUucG9zLnJvdGF0ZSh0aGlzLmRyYXdhYmxlLnJvdGF0aW9uKTtcbiAgICAgICAgICAgIGN0eC5zYXZlKCk7XG4gICAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgKj0gdGhpcy5kcmF3YWJsZS5vcGFjaXR5O1xuICAgICAgICAgICAgY3R4LnRyYW5zbGF0ZShwLngsIHAueSk7XG4gICAgICAgICAgICB0aGlzLmRyYXdhYmxlLmRyYXdDaXJjbGUoY3R4KTtcbiAgICAgICAgICAgIHRoaXMuZHJhd2FibGUuZHJhd0ltYWdlSW5DaXJjbGUoY3R4KTtcbiAgICAgICAgICAgIHRoaXMuZHJhd2FibGUuZHJhd0JvcmRlckZvckNpcmNsZShjdHgsIHNjYWxlKTtcbiAgICAgICAgICAgIGN0eC5yZXN0b3JlKCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5wb3N0RHJhdyA9IGZ1bmN0aW9uKGN0eCwgc2NhbGUpIHtcbiAgICAgICAgaWYodGhpcy5kcmF3YWJsZS5zaG93KSB7XG4gICAgICAgICAgICB2YXIgcCA9IHRoaXMuZHJhd2FibGUucG9zLnJvdGF0ZSh0aGlzLmRyYXdhYmxlLnJvdGF0aW9uKTtcbiAgICAgICAgICAgIGN0eC5zYXZlKCk7XG4gICAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgKj0gdGhpcy5kcmF3YWJsZS5vcGFjaXR5O1xuICAgICAgICAgICAgY3R4LnRyYW5zbGF0ZShwLngsIHAueSk7XG4gICAgICAgICAgICB0aGlzLmRyYXdhYmxlLmRyYXdUZXh0KGN0eCwgc2NhbGUpO1xuICAgICAgICAgICAgY3R4LnJlc3RvcmUoKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB0aGlzLmNsaWNrZWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIG1lID0gdGhpcztcbiAgICAgICAgaWYoIXRoaXMub3Blbikge1xuICAgICAgICAgICAgdGhpcy5kcmF3YWJsZS5hbmltYXRlKFwidGV4dFNpemVcIiwgMTIsIDIwMCwgXCJlYXNlSW5PdXRcIiwgbnVsbCk7XG4gICAgICAgICAgICB0aGlzLmRyYXdhYmxlLmFuaW1hdGVWZWN0b3IoXCJ0ZXh0UGFkZGluZ1wiLCBuZXcgVmVjdG9yMkQoMTAsIDEwKSwgMjAwLCBcImVhc2VJbk91dFwiLCBmdW5jdGlvbihmaW5pc2hlZCwgZWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGlmKGZpbmlzaGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIG1lLm9wZW4gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5kcmF3YWJsZS5hbmltYXRlKFwidGV4dFNpemVcIiwgMCwgMjAwLCBcImVhc2VJbk91dFwiLCBudWxsKTtcbiAgICAgICAgICAgIHRoaXMuZHJhd2FibGUuYW5pbWF0ZVZlY3RvcihcInRleHRQYWRkaW5nXCIsIG5ldyBWZWN0b3IyRCgwLCAwKSwgMjAwLCBcImVhc2VJbk91dFwiLCBmdW5jdGlvbihmaW5pc2hlZCwgZWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGlmKGZpbmlzaGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIG1lLm9wZW4gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB0aGlzLmRlbGV0ZSA9IGZ1bmN0aW9uKHRyYWRlcywgaW5kZXgpIHtcbiAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICBpZih0eXBlb2YgaW5kZXggIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICBpID0gaW5kZXg7XG4gICAgICAgIH1cbiAgICAgICAgZm9yKHZhciBsID0gdHJhZGVzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgaWYodHlwZW9mIHRyYWRlc1tpXS50cmFkZXJzICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIHZhciBpbmQgPSB0cmFkZXNbaV0udHJhZGVycy5pbmRleE9mKHRoaXMpO1xuICAgICAgICAgICAgICAgIGlmIChpbmQgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICB0cmFkZXNbaV0udHJhZGVycy5zcGxpY2UoaW5kLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgdHJhZGVzW2ldLmNhbGNUcmFkZXJzKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmKHRyYWRlc1tpXS50cmFkZXJzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJhZGVzW2ldLmFuaW1hdGVEZWxldGUodHJhZGVzLCBpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB0aGlzLmludGVyYWN0aW9uID0gZnVuY3Rpb24obW91c2VQb3MsIHNjYWxlKSB7XG4gICAgICAgIHZhciBtb3VzZURpZmZlcmVuY2UgPSBtb3VzZVBvcy5zdWJWZWN0b3IodGhpcy5kcmF3YWJsZS5wb3Mucm90YXRlKHRoaXMuZHJhd2FibGUucm90YXRpb24pLm11bChzY2FsZSkpO1xuICAgICAgICB2YXIgZGlmZmVyZW5jZSA9IDA7XG4gICAgICAgIGlmICh0aGlzLmRyYXdhYmxlLnJhZGl1cyAhPT0gMCkge1xuICAgICAgICAgICAgZGlmZmVyZW5jZSA9IHRoaXMuZHJhd2FibGUucmFkaXVzICogc2NhbGU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZHJhd2FibGUuc2l6ZS5sZW5ndGgoKSAhPT0gMCkge1xuICAgICAgICAgICAgZGlmZmVyZW5jZSA9IHRoaXMuZHJhd2FibGUuc2l6ZS5sZW5ndGgoKSAqIHNjYWxlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtb3VzZURpZmZlcmVuY2UubGVuZ3RoKCkgPD0gZGlmZmVyZW5jZSAmJiB0aGlzLmRyYXdhYmxlLnNob3cpIHtcbiAgICAgICAgICAgIGlmKHRoaXMubmV3KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5uZXcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLmRyYXdhYmxlLmJvcmRlckNvbG9yID0gXCIjZWVlZWVlXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG59IiwidmFyIFRyYWRlID0gZnVuY3Rpb24oaWQsIHN0b2NrUHJpY2UsIHRyYWRlcnMsIHBvcykge1xuICAgIHRoaXMuaWQgPSBpZDtcbiAgICB0aGlzLnN0b2NrUHJpY2UgPSBzdG9ja1ByaWNlO1xuICAgIHRoaXMudHJhZGVycyA9IHRyYWRlcnM7XG4gICAgdGhpcy5kcmF3YWJsZSA9IG5ldyBEcmF3YWJsZSgpO1xuXG4gICAgdGhpcy5kaWZmZXJlbmNlID0gMDtcbiAgICBmb3IodmFyIGkgPSAwLCBsID0gdGhpcy50cmFkZXJzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICB0aGlzLnRyYWRlcnNbaV0uY2hhbmdlU3RvY2tQcmljZSh0aGlzLnN0b2NrUHJpY2UpO1xuICAgICAgICB0aGlzLmRpZmZlcmVuY2UgKz0gdGhpcy50cmFkZXJzW2ldLmRpZmZlcmVuY2U7XG4gICAgfVxuICAgIHRoaXMuZGlmZmVyZW5jZSA9IE1hdGguZmxvb3IodGhpcy5kaWZmZXJlbmNlICogMTAwKSAvIDEwMDtcbiAgICB0aGlzLmRyYXdhYmxlLnNldFRleHQodGhpcy5kaWZmZXJlbmNlLnRvTG9jYWxlU3RyaW5nKCdiZS1OTCcsIHsgc3R5bGU6ICdjdXJyZW5jeScsIGN1cnJlbmN5OiAnRVVSJ30pKTtcbiAgICBpZih0aGlzLmRpZmZlcmVuY2UgPj0gMCkge1xuICAgICAgICB0aGlzLmRyYXdhYmxlLnRleHRCYWNrZ3JvdW5kID0gXCIjMzZCNURCXCI7XG4gICAgICAgIHRoaXMuZHJhd2FibGUudGV4dFJlcGxhY2VDb2xvciA9IFwiIzM2QjVEQlwiO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuZHJhd2FibGUudGV4dEJhY2tncm91bmQgPSBcIiNFNzRDM0NcIjtcbiAgICAgICAgdGhpcy5kcmF3YWJsZS50ZXh0UmVwbGFjZUNvbG9yID0gXCIjRTc0QzNDXCI7XG4gICAgfVxuICAgIHRoaXMubGluZUNvbG9yID0gXCIjQjNCMzY5XCI7XG4gICAgdGhpcy5vcGVuID0gZmFsc2U7XG5cbiAgICB0aGlzLmRyYXdhYmxlLnRleHRTaXplID0gMTA7XG4gICAgdGhpcy5kcmF3YWJsZS5yYWRpdXMgPSBNYXRoLmZsb29yKChNYXRoLnJhbmRvbSgpICogMzUpICsgMzUpO1xuICAgIHRoaXMuZHJhd2FibGUuaW1nRmlsbCA9IGZhbHNlO1xuICAgIGlmKHBvcyA9PT0gbnVsbCkge1xuICAgICAgICB2YXIgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHdpbmRvdy5pbm5lcldpZHRoIC0gKHdpbmRvdy5pbm5lcldpZHRoIC8gMikpO1xuICAgICAgICB2YXIgeSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqICh3aW5kb3cuaW5uZXJIZWlnaHQgLSA1MCkgLSAoKHdpbmRvdy5pbm5lckhlaWdodCAtIDUwKSAvIDIpKTtcbiAgICAgICAgd2hpbGUobmV3IFZlY3RvcjJEKHgsIHkpLmxlbmd0aCgpIDwgKDEwMCArIHRoaXMuZHJhd2FibGUucmFkaXVzKSB8fCBuZXcgVmVjdG9yMkQoeCwgeSkubGVuZ3RoKCkgPiAobmV3IFZlY3RvcjJEKHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQgLSA1MCkuZGl2KDIpLmxlbmd0aCgpIC0gdGhpcy5kcmF3YWJsZS5yYWRpdXMpKSB7XG4gICAgICAgICAgICB4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogd2luZG93LmlubmVyV2lkdGggLSAod2luZG93LmlubmVyV2lkdGggLyAyKSk7XG4gICAgICAgICAgICB5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKHdpbmRvdy5pbm5lckhlaWdodCAtIDUwKSAtICgod2luZG93LmlubmVySGVpZ2h0IC0gNTApIC8gMikpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZHJhd2FibGUuYW5pbWF0ZVZlY3RvcihcInBvc1wiLCBuZXcgVmVjdG9yMkQoeCwgeSksIDEwMDAsIFwiZWFzZUluT3V0XCIsIG51bGwpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdGhpcy5kcmF3YWJsZS5hbmltYXRlVmVjdG9yKFwicG9zXCIsIHBvcywgMTAwMCwgXCJlYXNlSW5PdXRcIiwgbnVsbCk7XG4gICAgfVxuICAgIHRoaXMuZHJhd2FibGUuY29sb3IgPSBcIiNmZmZmZmZcIjtcbiAgICB0aGlzLmRyYXdhYmxlLmJvcmRlcldpZHRoID0gMjtcbiAgICB0aGlzLmRyYXdhYmxlLmJvcmRlckNvbG9yID0gXCIjQjNCMzY5XCI7XG4gICAgdGhpcy5kcmF3YWJsZS5ib3JkZXJTY2FsaW5nID0gZmFsc2U7XG4gICAgdGhpcy5kcmF3YWJsZS50ZXh0Q29sb3IgPSBcIiNmZmZmZmZcIjtcbiAgICB0aGlzLmRyYXdhYmxlLnRleHRGb250ID0gXCJTb3VyY2VTYW5zUHJvXCI7XG4gICAgdGhpcy5kcmF3YWJsZS50ZXh0QW5jaG9yID0gbmV3IFZlY3RvcjJEKDAuNSwgMC41KTtcbiAgICB0aGlzLmRyYXdhYmxlLnRleHRQb3MgPSBuZXcgVmVjdG9yMkQoMCwgMC41KTtcbiAgICB0aGlzLmRyYXdhYmxlLnRleHRQYWRkaW5nID0gbmV3IFZlY3RvcjJEKDEwLCAxMCk7XG4gICAgdGhpcy5kcmF3YWJsZS50ZXh0UmVwbGFjZSA9IDE1O1xuXG4gICAgdmFyIG1lID0gdGhpcztcbiAgICBzZXRJbnRlcnZhbChmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGQgPSBNYXRoLnJhbmRvbSgpIC8gMTA7XG4gICAgICAgIHZhciBwT20gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAyKTtcbiAgICAgICAgaWYocE9tID09PSAxKSB7XG4gICAgICAgICAgICBkID0gLWQ7XG4gICAgICAgIH1cbiAgICAgICAgbWUuc3RvY2tQcmljZSA9IE1hdGguZmxvb3IoKG1lLnN0b2NrUHJpY2UgKyBkKSAqIDEwMCkgLyAxMDA7XG4gICAgICAgIG1lLmRpZmZlcmVuY2UgPSAwO1xuICAgICAgICBmb3IodmFyIGkgPSAwLCBsID0gbWUudHJhZGVycy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgIG1lLnRyYWRlcnNbaV0uY2hhbmdlU3RvY2tQcmljZShtZS5zdG9ja1ByaWNlKTtcbiAgICAgICAgICAgIG1lLmRpZmZlcmVuY2UgKz0gbWUudHJhZGVyc1tpXS5kaWZmZXJlbmNlO1xuICAgICAgICB9XG4gICAgICAgIG1lLmRpZmZlcmVuY2UgPSBNYXRoLmZsb29yKG1lLmRpZmZlcmVuY2UgKiAxMDApIC8gMTAwO1xuICAgICAgICBpZighbWUub3Blbikge1xuICAgICAgICAgICAgbWUuZHJhd2FibGUuc2V0VGV4dChtZS5kaWZmZXJlbmNlLnRvTG9jYWxlU3RyaW5nKCdiZS1OTCcsIHsgc3R5bGU6ICdjdXJyZW5jeScsIGN1cnJlbmN5OiAnRVVSJ30pKTtcbiAgICAgICAgICAgIGlmKG1lLmRpZmZlcmVuY2UgPj0gMCkge1xuICAgICAgICAgICAgICAgIG1lLmRyYXdhYmxlLnRleHRCYWNrZ3JvdW5kID0gXCIjMzZCNURCXCI7XG4gICAgICAgICAgICAgICAgbWUuZHJhd2FibGUudGV4dFJlcGxhY2VDb2xvciA9IFwiIzM2QjVEQlwiO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBtZS5kcmF3YWJsZS50ZXh0QmFja2dyb3VuZCA9IFwiI0U3NEMzQ1wiO1xuICAgICAgICAgICAgICAgIG1lLmRyYXdhYmxlLnRleHRSZXBsYWNlQ29sb3IgPSBcIiNFNzRDM0NcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmKG1lLmRpZmZlcmVuY2UgPj0gMCkge1xuICAgICAgICAgICAgICAgIG1lLmRyYXdhYmxlLnRleHRSZXBsYWNlQ29sb3IgPSBcIiMzNkI1REJcIjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbWUuZHJhd2FibGUudGV4dFJlcGxhY2VDb2xvciA9IFwiI0U3NEMzQ1wiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbWUuZHJhd2FibGUudGV4dEJhY2tncm91bmQgPSBcIiMyQzNFNTBcIjtcbiAgICAgICAgICAgIG1lLmRyYXdhYmxlLnNldFRleHQobWUuc3RvY2tQcmljZS50b0xvY2FsZVN0cmluZygnYmUtTkwnLCB7IHN0eWxlOiAnY3VycmVuY3knLCBjdXJyZW5jeTogJ0VVUid9KSk7XG4gICAgICAgIH1cbiAgICAgICAgbWUuZHJhd2FibGUucmVxdWVzdFJlZHJhdyA9IHRydWU7XG4gICAgfSwgMjAwMCk7XG5cbiAgICB0aGlzLmludGVyYWN0aW9uID0gZnVuY3Rpb24obW91c2VQb3MsIHNjYWxlKSB7XG4gICAgICAgIHZhciBtb3VzZURpZmZlcmVuY2UgPSBtb3VzZVBvcy5zdWJWZWN0b3IodGhpcy5kcmF3YWJsZS5wb3MubXVsKHNjYWxlKSk7XG4gICAgICAgIHZhciBkaWZmZXJlbmNlID0gMDtcbiAgICAgICAgaWYodGhpcy5kcmF3YWJsZS5yYWRpdXMgIT09IDApIHtcbiAgICAgICAgICAgIGRpZmZlcmVuY2UgPSB0aGlzLmRyYXdhYmxlLnJhZGl1cyAqIHNjYWxlO1xuICAgICAgICB9XG4gICAgICAgIGlmKHRoaXMuZHJhd2FibGUuc2l6ZS5sZW5ndGgoKSAhPT0gMCkge1xuICAgICAgICAgICAgZGlmZmVyZW5jZSA9IHRoaXMuZHJhd2FibGUuc2l6ZS5sZW5ndGgoKSAqIHNjYWxlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtb3VzZURpZmZlcmVuY2UubGVuZ3RoKCkgPD0gZGlmZmVyZW5jZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJlbFBvcyA9IG1vdXNlUG9zLnN1YlZlY3Rvcih0aGlzLmRyYXdhYmxlLnBvcy5tdWwoc2NhbGUpKTtcbiAgICAgICAgZm9yKHZhciBpID0gMCwgbCA9IHRoaXMudHJhZGVycy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBvID0gdGhpcy50cmFkZXJzW2ldLmludGVyYWN0aW9uKHJlbFBvcywgc2NhbGUpO1xuICAgICAgICAgICAgaWYobyAhPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICBmb3IodmFyIGogPSAwLCBtID0gdGhpcy50cmFkZXJzLmxlbmd0aDsgaiA8IG07IGorKykge1xuICAgICAgICAgICAgICAgICAgICB0ID0gdGhpcy50cmFkZXJzW2pdO1xuICAgICAgICAgICAgICAgICAgICBpZiAodC5vcGVuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0LmNsaWNrZWQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gbztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcblxuICAgIHRoaXMuY2FsY1RyYWRlcnMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGFuZ2xlID0gMTgwIC8gKHRoaXMudHJhZGVycy5sZW5ndGggKyAxKTtcbiAgICAgICAgZm9yKHZhciBpID0gMCwgbCA9IHRoaXMudHJhZGVycy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhbHBoYSA9IChhbmdsZSAqIChpICsgMSAtICgodGhpcy50cmFkZXJzLmxlbmd0aCArIDEpIC8gMikpKSAtIDkwO1xuICAgICAgICAgICAgdGhpcy50cmFkZXJzW2ldLmRyYXdhYmxlLmFuaW1hdGUoXCJyb3RhdGlvblwiLCBhbHBoYSwgMzAwLCBcImVhc2VJbk91dFwiLCBudWxsKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5jYWxjVHJhZGVycygpO1xuXG4gICAgdGhpcy5wcmVEcmF3ID0gZnVuY3Rpb24oY3R4LCBzY2FsZSkge1xuICAgICAgICBpZih0aGlzLmRyYXdhYmxlLnNob3cpIHtcbiAgICAgICAgICAgIGN0eC5zYXZlKCk7XG4gICAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgKj0gdGhpcy5kcmF3YWJsZS5vcGFjaXR5O1xuICAgICAgICAgICAgY3R4LnN0cm9rZVN0eWxlID0gdGhpcy5saW5lQ29sb3I7XG4gICAgICAgICAgICBjdHgubGluZVdpZHRoID0gMC41O1xuICAgICAgICAgICAgdmFyIG5ld1RyYWRlciA9IGZhbHNlO1xuICAgICAgICAgICAgZm9yKHZhciBpID0gMCwgbCA9IHRoaXMudHJhZGVycy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZih0aGlzLnRyYWRlcnNbaV0ubmV3KSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld1RyYWRlciA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYobmV3VHJhZGVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5saW5lQ29sb3IgPSBcIiNCM0IzNjlcIjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5saW5lQ29sb3IgPSBcIiMyQzNFNTBcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgIGN0eC5tb3ZlVG8oMCwgMCk7XG4gICAgICAgICAgICBjdHgubGluZVRvKHRoaXMuZHJhd2FibGUucG9zLngsIHRoaXMuZHJhd2FibGUucG9zLnkpO1xuICAgICAgICAgICAgY3R4LmNsb3NlUGF0aCgpO1xuICAgICAgICAgICAgY3R4LnN0cm9rZSgpO1xuICAgICAgICAgICAgY3R4LnJlc3RvcmUoKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB0aGlzLmRyYXcgPSBmdW5jdGlvbihjdHgsIHNjYWxlKSB7XG4gICAgICAgIGlmKHRoaXMuZHJhd2FibGUuc2hvdykge1xuICAgICAgICAgICAgY3R4LnNhdmUoKTtcbiAgICAgICAgICAgIGN0eC50cmFuc2xhdGUodGhpcy5kcmF3YWJsZS5wb3MueCwgdGhpcy5kcmF3YWJsZS5wb3MueSk7XG4gICAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgKj0gdGhpcy5kcmF3YWJsZS5vcGFjaXR5O1xuICAgICAgICAgICAgdmFyIG5ld1RyYWRlciA9IGZhbHNlO1xuICAgICAgICAgICAgZm9yKHZhciBpID0gMCwgbCA9IHRoaXMudHJhZGVycy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRyYWRlcnNbaV0uZHJhdyhjdHgsIHNjYWxlKTtcbiAgICAgICAgICAgICAgICBpZih0aGlzLnRyYWRlcnNbaV0ubmV3KSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld1RyYWRlciA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYobmV3VHJhZGVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kcmF3YWJsZS5ib3JkZXJDb2xvciA9IFwiI0IzQjM2OVwiO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRyYXdhYmxlLmJvcmRlckNvbG9yID0gXCIjZWVlZWVlXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmRyYXdhYmxlLmRyYXdDaXJjbGUoY3R4KTtcbiAgICAgICAgICAgIHRoaXMuZHJhd2FibGUuZHJhd0ltYWdlSW5DaXJjbGUoY3R4KTtcbiAgICAgICAgICAgIHRoaXMuZHJhd2FibGUuZHJhd0JvcmRlckZvckNpcmNsZShjdHgsIHNjYWxlKTtcbiAgICAgICAgICAgIHRoaXMuZHJhd2FibGUuZHJhd1RleHQoY3R4LCBzY2FsZSk7XG4gICAgICAgICAgICBjdHgucmVzdG9yZSgpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHRoaXMuZGVsZXRlID0gZnVuY3Rpb24odHJhZGVzKSB7XG4gICAgICAgIHZhciBpbmRleCA9IHRyYWRlcy5pbmRleE9mKHRoaXMpO1xuICAgICAgICBmb3IodmFyIGkgPSAwLCBsID0gdGhpcy50cmFkZXJzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgdGhpcy50cmFkZXJzWzBdLmRlbGV0ZSh0cmFkZXMsIGluZGV4KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB0aGlzLmFuaW1hdGVEZWxldGUgPSBmdW5jdGlvbih0cmFkZXMsIGluZGV4KSB7XG4gICAgICAgIHRoaXMuZHJhd2FibGUuYW5pbWF0ZShcInRleHRTaXplXCIsIDAsIDMwMCwgXCJlYXNlSW5PdXRcIiwgbnVsbCk7XG4gICAgICAgIHRoaXMuZHJhd2FibGUuYW5pbWF0ZShcInRleHRSZXBsYWNlXCIsIDAsIDMwMCwgXCJlYXNlSW5PdXRcIiwgbnVsbCk7XG4gICAgICAgIHRoaXMuZHJhd2FibGUuYW5pbWF0ZVZlY3RvcihcInRleHRQYWRkaW5nXCIsIG5ldyBWZWN0b3IyRCgwLCAwKSwgMzAwLCBcImVhc2VJbk91dFwiLCBudWxsKTtcbiAgICAgICAgdGhpcy5kcmF3YWJsZS5hbmltYXRlKFwib3BhY2l0eVwiLCAwLCAzMDAsIFwiZWFzZUluT3V0XCIsIG51bGwpO1xuICAgICAgICB0aGlzLmRyYXdhYmxlLmFuaW1hdGUoXCJyYWRpdXNcIiwgMCwgMzAwLCBcImVhc2VJbk91dFwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRyYWRlcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgdGhpcy5wb3N0RHJhdyA9IGZ1bmN0aW9uKGN0eCwgc2NhbGUpIHtcbiAgICAgICAgaWYodGhpcy5kcmF3YWJsZS5zaG93KSB7XG4gICAgICAgICAgICBjdHguc2F2ZSgpO1xuICAgICAgICAgICAgY3R4Lmdsb2JhbEFscGhhICo9IHRoaXMuZHJhd2FibGUub3BhY2l0eTtcbiAgICAgICAgICAgIGN0eC50cmFuc2xhdGUodGhpcy5kcmF3YWJsZS5wb3MueCwgdGhpcy5kcmF3YWJsZS5wb3MueSk7XG4gICAgICAgICAgICBmb3IodmFyIGkgPSAwLCBsID0gdGhpcy50cmFkZXJzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgICAgIHRoaXMudHJhZGVyc1tpXS5wb3N0RHJhdyhjdHgsIHNjYWxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGN0eC5yZXN0b3JlKCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5jbGlja2VkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBpID0gMCwgbCA9IDAsIHQgPSBudWxsLCBtZSA9IHRoaXM7XG4gICAgICAgIGlmKCF0aGlzLm9wZW4pIHtcbiAgICAgICAgICAgIGZvcihsID0gdGhpcy50cmFkZXJzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgICAgIHQgPSB0aGlzLnRyYWRlcnNbaV07XG4gICAgICAgICAgICAgICAgdC5kcmF3YWJsZS5zaG93ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0LmRyYXdhYmxlLmFuaW1hdGVWZWN0b3IoXCJwb3NcIiwgbmV3IFZlY3RvcjJEKDAsIHRoaXMuZHJhd2FibGUucmFkaXVzICsgdC5kcmF3YWJsZS5yYWRpdXMgKyAxNSksIDMwMCwgXCJlYXNlSW5PdXRcIiwgbnVsbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmRyYXdhYmxlLmFuaW1hdGVWZWN0b3IoXCJ0ZXh0UGFkZGluZ1wiLCBuZXcgVmVjdG9yMkQoMCwgMCksIDE1MCwgXCJlYXNlSW5cIiwgZnVuY3Rpb24oZG9uZSwgZHJhd2FibGUpIHtcbiAgICAgICAgICAgICAgICBkcmF3YWJsZS5hbmltYXRlVmVjdG9yKFwidGV4dFBhZGRpbmdcIiwgbmV3IFZlY3RvcjJEKDEwLCAxMCksIDE1MCwgXCJlYXNlT3V0XCIsIG51bGwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLmRyYXdhYmxlLmFuaW1hdGUoXCJ0ZXh0UmVwbGFjZVwiLCAwLCAxNTAsIFwiZWFzZUluXCIsIGZ1bmN0aW9uKGRvbmUsIGRyYXdhYmxlKSB7XG4gICAgICAgICAgICAgICAgZHJhd2FibGUuYW5pbWF0ZShcInRleHRSZXBsYWNlXCIsIDE1LCAxNTAsIFwiZWFzZU91dFwiLCBudWxsKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5kcmF3YWJsZS5hbmltYXRlKFwidGV4dFNpemVcIiwgMCwgMTUwLCBcImVhc2VJblwiLCBmdW5jdGlvbihkb25lLCBkcmF3YWJsZSkge1xuICAgICAgICAgICAgICAgIGRyYXdhYmxlLnRleHRCYWNrZ3JvdW5kID0gXCIjMkMzRTUwXCI7XG4gICAgICAgICAgICAgICAgZHJhd2FibGUuc2V0VGV4dChtZS5zdG9ja1ByaWNlLnRvTG9jYWxlU3RyaW5nKCdiZS1OTCcsIHsgc3R5bGU6ICdjdXJyZW5jeScsIGN1cnJlbmN5OiAnRVVSJ30pKTtcbiAgICAgICAgICAgICAgICBtZS5vcGVuID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBkcmF3YWJsZS5hbmltYXRlKFwidGV4dFNpemVcIiwgMTAsIDE1MCwgXCJlYXNlT3V0XCIsIG51bGwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgZiA9IGZ1bmN0aW9uKGRvbmUsIGRyYXdhYmxlKSB7XG4gICAgICAgICAgICAgICAgZHJhd2FibGUuc2hvdyA9IGZhbHNlO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGZvcihsID0gdGhpcy50cmFkZXJzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgICAgIHQgPSB0aGlzLnRyYWRlcnNbaV07XG4gICAgICAgICAgICAgICAgaWYodC5vcGVuKSB7XG4gICAgICAgICAgICAgICAgICAgIHQuY2xpY2tlZCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0LmRyYXdhYmxlLmFuaW1hdGVWZWN0b3IoXCJwb3NcIiwgbmV3IFZlY3RvcjJEKDAsIDApLCAzMDAsIFwiZWFzZUluT3V0XCIsIGYpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5kcmF3YWJsZS5hbmltYXRlVmVjdG9yKFwidGV4dFBhZGRpbmdcIiwgbmV3IFZlY3RvcjJEKDAsIDApLCAxNTAsIFwiZWFzZUluXCIsIGZ1bmN0aW9uKGRvbmUsIGRyYXdhYmxlKSB7XG4gICAgICAgICAgICAgICAgZHJhd2FibGUuYW5pbWF0ZVZlY3RvcihcInRleHRQYWRkaW5nXCIsIG5ldyBWZWN0b3IyRCgxMCwgMTApLCAxNTAsIFwiZWFzZU91dFwiLCBudWxsKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5kcmF3YWJsZS5hbmltYXRlKFwidGV4dFJlcGxhY2VcIiwgMCwgMTUwLCBcImVhc2VJblwiLCBmdW5jdGlvbihkb25lLCBkcmF3YWJsZSkge1xuICAgICAgICAgICAgICAgIGRyYXdhYmxlLmFuaW1hdGUoXCJ0ZXh0UmVwbGFjZVwiLCAxNSwgMTUwLCBcImVhc2VPdXRcIiwgbnVsbCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuZHJhd2FibGUuYW5pbWF0ZShcInRleHRTaXplXCIsIDAsIDE1MCwgXCJlYXNlSW5cIiwgZnVuY3Rpb24oZG9uZSwgZHJhd2FibGUpIHtcbiAgICAgICAgICAgICAgICBkcmF3YWJsZS5zZXRUZXh0KG1lLmRpZmZlcmVuY2UudG9Mb2NhbGVTdHJpbmcoJ2JlLU5MJywgeyBzdHlsZTogJ2N1cnJlbmN5JywgY3VycmVuY3k6ICdFVVInfSkpO1xuICAgICAgICAgICAgICAgIGlmKG1lLmRpZmZlcmVuY2UgPj0gMCkge1xuICAgICAgICAgICAgICAgICAgICBkcmF3YWJsZS50ZXh0QmFja2dyb3VuZCA9IFwiIzM2QjVEQlwiO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGRyYXdhYmxlLnRleHRCYWNrZ3JvdW5kID0gXCIjRTc0QzNDXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG1lLm9wZW4gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBkcmF3YWJsZS5hbmltYXRlKFwidGV4dFNpemVcIiwgMTAsIDE1MCwgXCJlYXNlT3V0XCIsIG51bGwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5yZXF1ZXN0UmVkcmF3ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGZvcih2YXIgaSA9IDAsIGwgPSB0aGlzLnRyYWRlcnMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICBpZih0aGlzLnRyYWRlcnNbaV0uZHJhd2FibGUucmVxdWVzdFJlZHJhdykge1xuICAgICAgICAgICAgICAgIHRoaXMuZHJhd2FibGUucmVxdWVzdFJlZHJhdyA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy50cmFkZXJzW2ldLmRyYXdhYmxlLnJlcXVlc3RSZWRyYXcgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZih0aGlzLmRyYXdhYmxlLnJlcXVlc3RSZWRyYXcpIHtcbiAgICAgICAgICAgIHRoaXMuZHJhd2FibGUucmVxdWVzdFJlZHJhdyA9IGZhbHNlO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG59OyIsInZhciB0cmFkZUNhbnZhcyA9IGZ1bmN0aW9uKHVzZXIpIHtcbiAgICBpZihkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRyYWRlc1wiKSAhPT0gbnVsbCkge1xuICAgICAgICAvL2RlY2xhcmUgYmFzaWMgdmFycztcbiAgICAgICAgdmFyIG9iamVjdHMgPSBbXTtcbiAgICAgICAgdmFyIGNvbXBhbmllcyA9IFtdO1xuICAgICAgICB2YXIgcHJvZmlsZSA9IG5ldyBEcmF3YWJsZSgpO1xuICAgICAgICB2YXIgdHJhc2ggPSBuZXcgRHJhd2FibGUoKTtcblxuICAgICAgICAvL2NyZWF0ZSB0aGUgcHJvZmlsZVxuICAgICAgICBwcm9maWxlLnNldEltYWdlKHVzZXIucHJvZmlsZXBpY3R1cmUsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY2FudmFzLmRyYXcoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHByb2ZpbGUucmFkaXVzID0gMTAwO1xuICAgICAgICBwcm9maWxlLmNvbG9yID0gXCIjZmZmZmZmXCI7XG4gICAgICAgIHByb2ZpbGUuYm9yZGVyQ29sb3IgPSBcIiNlZWVlZWVcIjtcbiAgICAgICAgcHJvZmlsZS5ib3JkZXJTY2FsaW5nID0gZmFsc2U7XG4gICAgICAgIHByb2ZpbGUuYm9yZGVyV2lkdGggPSAyO1xuICAgICAgICBwcm9maWxlLnRleHRTaXplID0gMTI7XG4gICAgICAgIHByb2ZpbGUudGV4dENvbG9yID0gXCIjZmZmZmZmXCI7XG4gICAgICAgIHByb2ZpbGUudGV4dEZvbnQgPSBcIlNvdXJjZVNhbnNQcm9cIjtcbiAgICAgICAgcHJvZmlsZS50ZXh0QW5jaG9yID0gbmV3IFZlY3RvcjJEKDAuNSwgMC41KTtcbiAgICAgICAgcHJvZmlsZS50ZXh0UG9zID0gbmV3IFZlY3RvcjJEKDAsIDAuNSk7XG4gICAgICAgIHByb2ZpbGUudGV4dFBhZGRpbmcgPSBuZXcgVmVjdG9yMkQoMTAsIDEwKTtcbiAgICAgICAgcHJvZmlsZS50ZXh0UmVwbGFjZSA9IDE1O1xuXG4gICAgICAgIC8vZGVmaW5lIGhvdyB0aGUgcHJvZmlsZSBpcyBkcmF3blxuICAgICAgICBwcm9maWxlLmRyYXcgPSBmdW5jdGlvbihjdHgsIHNjYWxlKSB7XG4gICAgICAgICAgICB0aGlzLmRyYXdDaXJjbGUoY3R4KTtcbiAgICAgICAgICAgIHRoaXMuZHJhd0ltYWdlSW5DaXJjbGUoY3R4KTtcbiAgICAgICAgICAgIHRoaXMuZHJhd0JvcmRlckZvckNpcmNsZShjdHgsIHNjYWxlKTtcbiAgICAgICAgICAgIHRoaXMuZHJhd1RleHQoY3R4LCBzY2FsZSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy9jcmVhdGUgdGhlIHRyYXNoIGljb25cbiAgICAgICAgdHJhc2guc2V0SW1hZ2UoXCJkaXN0L2ltYWdlcy9taXNjL3RyYXNoLnN2Z1wiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNhbnZhcy5kcmF3KCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0cmFzaC5yYWRpdXMgPSA1MDtcbiAgICAgICAgdHJhc2guY29sb3IgPSBcIiNlZWVlZWVcIjtcbiAgICAgICAgdHJhc2guYm9yZGVyQ29sb3IgPSBcIiNlZWVlZWVcIjtcbiAgICAgICAgdHJhc2guYm9yZGVyU2NhbGluZyA9IGZhbHNlO1xuICAgICAgICB0cmFzaC5ib3JkZXJXaWR0aCA9IDI7XG4gICAgICAgIHRyYXNoLnBvcyA9IG5ldyBWZWN0b3IyRCh3aW5kb3cuaW5uZXJXaWR0aCAtIDEwMCwgd2luZG93LmlubmVySGVpZ2h0IC0gMTUwKTtcblxuICAgICAgICAvL2RlZmluZSBob3cgdGhlIGludGVyYWN0aW9uIHdpdGggdGhlIHRyYXNoIGNhbiBpcyBjYWxjdWxhdGVkXG4gICAgICAgIHRyYXNoLmludGVyYWN0aW9uID0gZnVuY3Rpb24obW91c2VQb3MpIHtcbiAgICAgICAgICAgIHZhciBtb3VzZURpZmZlcmVuY2UgPSBtb3VzZVBvcy5zdWJWZWN0b3IoY2FudmFzLm1hcmdpbikuc3ViVmVjdG9yKHRoaXMucG9zKTtcbiAgICAgICAgICAgIHZhciBkaWZmZXJlbmNlID0gdGhpcy5yYWRpdXMgKiBjYW52YXMuc2NhbGU7XG4gICAgICAgICAgICByZXR1cm4gKG1vdXNlRGlmZmVyZW5jZS5sZW5ndGgoKSA8PSBkaWZmZXJlbmNlICYmIHRoaXMuc2hvdyk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy9kZWZpbmUgaG93IHRoZSB0cmFzaCBjYW4gaXMgZHJhd25cbiAgICAgICAgdHJhc2guZHJhdyA9IGZ1bmN0aW9uKGN0eCwgc2NhbGUpIHtcbiAgICAgICAgICAgIHZhciBwID0gdGhpcy5wb3Muc3ViVmVjdG9yKGNhbnZhcy5vZmZzZXQpLnN1YlZlY3RvcihjYW52YXMuY2VudGVyKS5tdWwoMSAvIGNhbnZhcy5zY2FsZSk7XG4gICAgICAgICAgICBjdHguc2F2ZSgpO1xuICAgICAgICAgICAgY3R4LnRyYW5zbGF0ZShwLngsIHAueSk7XG4gICAgICAgICAgICB0aGlzLmRyYXdDaXJjbGUoY3R4KTtcbiAgICAgICAgICAgIHRoaXMuZHJhd0ltYWdlSW5DaXJjbGUoY3R4KTtcbiAgICAgICAgICAgIHRoaXMuZHJhd0JvcmRlckZvckNpcmNsZShjdHgsIHNjYWxlKTtcbiAgICAgICAgICAgIGN0eC5yZXN0b3JlKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy9sb2FkIHRyYWRlc1xuICAgICAgICB2YXIgZGlmZiA9IDA7XG4gICAgICAgIGZvcih2YXIgaSA9IDAsIGwgPSB1c2VyLnRyYWRlcy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgIHZhciB0ID0gdXNlci50cmFkZXNbaV07XG4gICAgICAgICAgICAvL2lmIHRyYWRlIGlzbid0IGNsb3NlZCB5ZXRcbiAgICAgICAgICAgIGlmKHQuU3RvcFN0b2NrUHJpY2UgIT09IHVuZGVmaW5lZCB8fCB0LlN0b3BTdG9ja1ByaWNlIDwgMCkge1xuICAgICAgICAgICAgICAgIHZhciBjO1xuICAgICAgICAgICAgICAgIHZhciB0cmFkZXI7XG4gICAgICAgICAgICAgICAgLy9pZiB0cmFkZSBpcyBzdGFydGVkIGJ5IGN1cnJlbnQgdXNlciwgdHJhZGVyIGlzIGN1cnJlbnQgdXNlclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdC5wYXJlbnRUcmFkZSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJhZGVyID0gbmV3IFRyYWRlcih1c2VyLmZpcnN0bmFtZSArIFwiIFwiICsgdXNlci5sYXN0bmFtZSwgKHQuQW1vdW50SW52ZXN0ZWQgLyB0LlN0YXJ0U3RvY2tQcmljZSksIHQuU3RhcnRTdG9ja1ByaWNlLCB0LklzU2hvcnQsIHQuQ29tbWVudCk7XG4gICAgICAgICAgICAgICAgICAgIHRyYWRlci5kcmF3YWJsZS5zZXRJbWFnZSh1c2VyLnByb2ZpbGVwaWN0dXJlKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy9pZiB0aGUgY29tcGFueSBpcyBhbHJlYWR5IGJlaW5nIGRyYXduIG9uIHNjcmVlbiwgYWRkIHRoZSB0cmFkZXIgdG8gdGhlIGNvbXBhbnlcbiAgICAgICAgICAgICAgICB2YXIgY29tcGFueUZvdW5kID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDAsIG0gPSBjb21wYW5pZXMubGVuZ3RoOyBqIDwgbTsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIGMgPSBjb21wYW5pZXNbal07XG4gICAgICAgICAgICAgICAgICAgIGlmIChjLmlkID09PSB0LkNvbXBhbnkuX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb21wYW55Rm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYy50cmFkZXJzLnB1c2godHJhZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vaWYgbm90LCBjcmVhdGUgYSBuZXcgY29tcGFueSBhbmQgYWRkIHRoZSB0cmFkZXIgdG8gaXRcbiAgICAgICAgICAgICAgICBpZiAoIWNvbXBhbnlGb3VuZCkge1xuICAgICAgICAgICAgICAgICAgICBjID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiB0LkNvbXBhbnkuX2lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzdG9ja1ByaWNlXCI6IHQuQ29tcGFueS5DdXJyZW50U3RvY2tQcmljZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidHJhZGVyc1wiOiBbdHJhZGVyXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiaW1hZ2VcIjogdC5Db21wYW55LkltYWdlXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGNvbXBhbmllcy5wdXNoKGMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vZm9yIGV2ZXJ5IGNvbXBhbnksIGNyZWF0ZSBhIFRyYWRlIG9iamVjdCBhbmQgYWRkIGl0IHRvIHRoZSBjYW52YXMgb2JqZWN0c1xuICAgICAgICBmb3IodmFyIGsgPSAwLCBuID0gY29tcGFuaWVzLmxlbmd0aDsgayA8IG47IGsrKykge1xuICAgICAgICAgICAgdmFyIHRyYWRlID0gbmV3IFRyYWRlKGNvbXBhbmllc1trXS5pZCwgY29tcGFuaWVzW2tdLnN0b2NrUHJpY2UsIGNvbXBhbmllc1trXS50cmFkZXJzLCBudWxsKTtcbiAgICAgICAgICAgIHRyYWRlLmRyYXdhYmxlLnNldEltYWdlKGNvbXBhbmllc1trXS5pbWFnZSk7XG4gICAgICAgICAgICBvYmplY3RzLnB1c2godHJhZGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9hZGQgdGhlIHByb2ZpbGUgYW5kIHRoZSB0cmFzaGNhblxuICAgICAgICBvYmplY3RzLnB1c2gocHJvZmlsZSk7XG4gICAgICAgIG9iamVjdHMucHVzaCh0cmFzaCk7XG5cbiAgICAgICAgLy9pZiBhIHVzZXIgaXMgY3VycmVudGx5IG1ha2luZyBwcm9maXQsIGNvbG9yIHRoZSB0ZXh0IGJsdWUsIGlmIG5vdCwgY29sb3IgaXQgcmVkXG4gICAgICAgIGlmKGRpZmYgPj0gMCkge1xuICAgICAgICAgICAgcHJvZmlsZS50ZXh0QmFja2dyb3VuZCA9IFwiIzM2QjVEQlwiO1xuICAgICAgICAgICAgcHJvZmlsZS50ZXh0UmVwbGFjZUNvbG9yID0gXCIjMzZCNURCXCI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBwcm9maWxlLnRleHRCYWNrZ3JvdW5kID0gXCIjRTc0QzNDXCI7XG4gICAgICAgICAgICBwcm9maWxlLnRleHRSZXBsYWNlQ29sb3IgPSBcIiNFNzRDM0NcIjtcbiAgICAgICAgfVxuICAgICAgICBwcm9maWxlLnNldFRleHQoKE1hdGguZmxvb3IoZGlmZiAqIDEwMCkgLyAxMDApLnRvTG9jYWxlU3RyaW5nKCdiZS1OTCcsIHtzdHlsZTogJ2N1cnJlbmN5JywgY3VycmVuY3k6ICdFVVInfSkpO1xuXG4gICAgICAgIC8vY3JlYXRlIGEgY2FudmFzLCBzZXQgdGhlIG9iamVjdHMgYW5kIHNldCBhIGNhbGxiYWNrIHRoYXQgaGFwcGVucyB3aGVuZXZlciB0aGUgY2FudmFzIGlzIHJlZHJhd25cbiAgICAgICAgLy90aGUgY2FudmFzIGRvZXNuJ3QgbmVlZCB0byBiZSBkcmF3biBhIGZpcnN0IHRpbWUsIGl0IHdpbGwgYmUgZHJhd24gZXZlcnkgdGltZSBhbiBpbWFnZSBpcyBzZXRcbiAgICAgICAgdmFyIGNhbnZhcyA9IG5ldyBDYW52YXMoMCwgNTAsIHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQgLSA1MCwgXCJ0cmFkZXNcIiwgb2JqZWN0cyk7XG4gICAgICAgIGNhbnZhcy5kcmF3Q2FsbGJhY2sgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIC8vZ2V0IHRoZSB1c2VycyBsb3NzL3Byb2ZpdFxuICAgICAgICAgICAgdmFyIGRpZmYgPSAwO1xuICAgICAgICAgICAgZm9yKHZhciBpID0gMCwgbCA9IGNhbnZhcy5vYmplY3RzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmKHR5cGVvZiBjYW52YXMub2JqZWN0c1tpXS5kaWZmZXJlbmNlICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgICAgICBkaWZmICs9IGNhbnZhcy5vYmplY3RzW2ldLmRpZmZlcmVuY2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9zZXQgdGhlIHRleHRcbiAgICAgICAgICAgIGlmKGRpZmYgPj0gMCkge1xuICAgICAgICAgICAgICAgIHByb2ZpbGUudGV4dEJhY2tncm91bmQgPSBcIiMzNkI1REJcIjtcbiAgICAgICAgICAgICAgICBwcm9maWxlLnRleHRSZXBsYWNlQ29sb3IgPSBcIiMzNkI1REJcIjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcHJvZmlsZS50ZXh0QmFja2dyb3VuZCA9IFwiI0U3NEMzQ1wiO1xuICAgICAgICAgICAgICAgIHByb2ZpbGUudGV4dFJlcGxhY2VDb2xvciA9IFwiI0U3NEMzQ1wiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcHJvZmlsZS5zZXRUZXh0KChNYXRoLmZsb29yKGRpZmYgKiAxMDApIC8gMTAwKS50b0xvY2FsZVN0cmluZygnYmUtTkwnLCB7c3R5bGU6ICdjdXJyZW5jeScsIGN1cnJlbmN5OiAnRVVSJ30pKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvL3doZW4gYSB1c2VyIHN0YXJ0cyBpbnRlcmFjdGlvbiB3aXRoIHRoZSBjYW52YXNcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB9KTtcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0cmFkZXNcIikuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICBpbnRlcmFjdGlvblN0YXJ0KGUpO1xuICAgICAgICB9KTtcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0cmFkZXNcIikuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoc3RhcnRcIiwgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgdmFyIHRvdWNoID0gZS50b3VjaGVzWzBdO1xuICAgICAgICAgICAgaW50ZXJhY3Rpb25TdGFydCh0b3VjaCk7XG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgaW50ZXJhY3Rpb25TdGFydCA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIC8vdGVsbCB0aGUgY2FudmFzIHRoZSBpbnRlcmFjdGlvbiBoYXMgc3RhcnRlZFxuICAgICAgICAgICAgLy9jYWxsYmFjayB3aWxsIHJldHVybiB0aGUgb2JqZWN0IHRoYXQgaXMgYmVpbmcgaW50ZXJhY3RlZCB3aXRoIGFuZCB0aGUgbW91c2UgcG9zaXRpb25cbiAgICAgICAgICAgIGNhbnZhcy5pbnRlcmFjdGlvblN0YXJ0KGUsIGZ1bmN0aW9uKG9iamVjdCwgbW91c2VQb3MpIHtcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXg7XG4gICAgICAgICAgICAgICAgLy9pZiB0aGUgb2JqZWN0IGlzIGEgVHJhZGUsIHNldCBpdCB0byBiZSB0aGUgdG9wIG9iamVjdFxuICAgICAgICAgICAgICAgIGlmKG9iamVjdCBpbnN0YW5jZW9mIFRyYWRlKSB7XG4gICAgICAgICAgICAgICAgICAgIGluZGV4ID0gY2FudmFzLm9iamVjdHMuaW5kZXhPZihvYmplY3QpO1xuICAgICAgICAgICAgICAgICAgICBjYW52YXMub2JqZWN0cy5wdXNoKGNhbnZhcy5vYmplY3RzLnNwbGljZShpbmRleCwgMSlbMF0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL2lmIHRoZSBvYmplY3QgaXMgYSBUcmFkZXIsIG1ha2Ugc3VyZSBpdCByZXR1cm5zIHRvIGl0cyBvcmlnaW5hbCBwb3NpdGlvbiBhZnRlciBpbnRlcmFjdGluZ1xuICAgICAgICAgICAgICAgIGlmKG9iamVjdCBpbnN0YW5jZW9mIFRyYWRlcikge1xuICAgICAgICAgICAgICAgICAgICBvYmplY3QuZHJhd2FibGUucmV0dXJuUG9zID0gb2JqZWN0LmRyYXdhYmxlLnBvcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy9pZiB0aGUgb2JqZWN0IGlzIHRoZSBjYW52YXMgaXRzZWxmLCBzZXQgdGhlIHRyYXNoIGNhbiB0byBiZSB0aGUgdG9wIG9iamVjdFxuICAgICAgICAgICAgICAgIGlmKG9iamVjdCA9PT0gXCJzZWxmXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5kZXggPSBjYW52YXMub2JqZWN0cy5pbmRleE9mKHRyYXNoKTtcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLm9iamVjdHMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgY2FudmFzLm9iamVjdHMucHVzaCh0cmFzaCk7XG4gICAgICAgICAgICAgICAgICAgIGNhbnZhcy5kcmF3KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8va2VlcCB0cmFjayBvZiB3aGF0IGhhcHBlbmVkIGluIHByZXBhcmF0aW9uIGZvciBmdXJ0aGVyIGludGVyYWN0aW9uc1xuICAgICAgICAgICAgICAgIGNhbnZhcy5zZWxlY3RlZCA9IG9iamVjdDtcbiAgICAgICAgICAgICAgICBjYW52YXMubW91c2VQb3MgPSBtb3VzZVBvcztcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vd2hlbiBhIHVzZXIgbW92ZXMgdGhlIHNlbGVjdGVkIG9iamVjdFxuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRyYWRlc1wiKS5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIGludGVyYWN0aW9uTW92ZShlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidHJhZGVzXCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaG1vdmVcIiwgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgdmFyIHRvdWNoID0gZS50b3VjaGVzWzBdO1xuICAgICAgICAgICAgaW50ZXJhY3Rpb25Nb3ZlKHRvdWNoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHZhciBpbnRlcmFjdGlvbk1vdmUgPSBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAvL3RlbGwgdGhlIGNhbnZhcyB0aGUgaW50ZXJhY3Rpb24gaXMgbW92aW5nXG4gICAgICAgICAgICAvL2NhbnZhcyByZXR1cm5zIHRoZSBvYmplY3QgYmVpbmcgaW50ZXJhY3RlZCB3aXRoLCB0aGUgY3VycmVudCBtb3VzZSBwb3NpdGlvbiBhbmQgdGhlIGRpZmZlcmVuY2UgY29tcGFyZWQgdG8gdGhlIGxhc3QgbW91c2UgcG9zaXRpb25cbiAgICAgICAgICAgIGNhbnZhcy5pbnRlcmFjdGlvbk1vdmUoZSwgZnVuY3Rpb24ob2JqZWN0LCBtb3VzZVBvcywgZGlmZmVyZW5jZSkge1xuICAgICAgICAgICAgICAgIC8vaWYgdGhlIG9iamVjdCBpcyBhIFRyYWRlLCBsb3dlciB0aGUgb3BhY2l0eSBhbmQgbWFrZSBpdCBmb2xsb3cgdGhlIG1vdXNlXG4gICAgICAgICAgICAgICAgaWYob2JqZWN0IGluc3RhbmNlb2YgVHJhZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgb2JqZWN0LmRyYXdhYmxlLm9wYWNpdHkgPSAwLjU7XG4gICAgICAgICAgICAgICAgICAgIG9iamVjdC5kcmF3YWJsZS5wb3MgPSBtb3VzZVBvcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy9pZiB0aGUgb2JqZWN0IGlzIGEgVHJhZGVyLCBsb3dlciB0aGUgb3BhY2l0eSBhbmQgbWFrZSBpdCBmb2xsb3cgdGhlIG1vdXNlXG4gICAgICAgICAgICAgICAgaWYob2JqZWN0IGluc3RhbmNlb2YgVHJhZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIG9iamVjdC5kcmF3YWJsZS5vcGFjaXR5ID0gMC41O1xuICAgICAgICAgICAgICAgICAgICBvYmplY3QuZHJhd2FibGUucG9zID0gb2JqZWN0LmRyYXdhYmxlLnBvcy5hZGRWZWN0b3IoZGlmZmVyZW5jZS5yb3RhdGUoLW9iamVjdC5kcmF3YWJsZS5yb3RhdGlvbikubXVsKDEgLyBjYW52YXMuc2NhbGUpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy9pZiB0aGUgb2JqZWN0IGlzIGhvdmVyaW5nIG92ZXIgdGhlIHRyYXNoIGNhbiwgY29sb3IgdGhlIGNhbiByZWRcbiAgICAgICAgICAgICAgICBpZih0cmFzaC5pbnRlcmFjdGlvbihuZXcgVmVjdG9yMkQoZS5wYWdlWCwgZS5wYWdlWSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyYXNoLmNvbG9yID0gXCIjRTc0QzNDXCI7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdHJhc2guY29sb3IgPSBcIiNlZWVlZWVcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy9yZWRyYXcgdGhlIGNhbnZhc1xuICAgICAgICAgICAgICAgIGNhbnZhcy5kcmF3KCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICAvL3doZW4gYSB1c2VyIHJlbGVhc2VzIHRoZSBzZWxlY3RlZCBvYmplY3RcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0cmFkZXNcIikuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgaW50ZXJhY3Rpb25TdG9wKGUpO1xuICAgICAgICB9KTtcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0cmFkZXNcIikuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoZW5kXCIsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIHZhciB0b3VjaCA9IGUudG91Y2hlc1swXTtcbiAgICAgICAgICAgIGludGVyYWN0aW9uU3RvcCh0b3VjaCk7XG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgaW50ZXJhY3Rpb25TdG9wID0gZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgLy90ZWxsIHRoZSBjYW52YXMgdGhlIHVzZXIgaGFzIHJlbGVhc2VkLCB0aGUgY2FsbGJhY2sgcmV0dXJucyB0aGUgb2JqZWN0IGFuZCBpZiBpdCB3YXMgY2xpY2tlZCBvciBkcmFnZ2VkXG4gICAgICAgICAgICBjYW52YXMuaW50ZXJhY3Rpb25TdG9wKGZ1bmN0aW9uKGNsaWNrLCBvYmplY3QpIHtcbiAgICAgICAgICAgICAgICB2YXIgaSwgbDtcbiAgICAgICAgICAgICAgICAvL2lmIHRoZSBvYmplY3Qgd2FzIGNsaWNrZWRcbiAgICAgICAgICAgICAgICBpZihjbGljaykge1xuICAgICAgICAgICAgICAgICAgICAvL2lmIHRoZSBvYmplY3Qgd2FzIGEgVHJhZGUsIHNldCB0aGUgb3BhY2l0eSBiYWNrIHRvIDEgYW5kIGNsb3NlIGFsbCBUcmFkZXMgb24gdGhlIGNhbnZhc1xuICAgICAgICAgICAgICAgICAgICBpZihvYmplY3QgaW5zdGFuY2VvZiBUcmFkZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0LmRyYXdhYmxlLm9wYWNpdHkgPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gMCwgbCA9IGNhbnZhcy5vYmplY3RzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYW52YXMub2JqZWN0c1tpXS5vcGVuICYmIGNhbnZhcy5vYmplY3RzW2ldICE9PSBvYmplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLm9iamVjdHNbaV0uY2xpY2tlZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvL2lmIHRoZSBvYmplY3Qgd2FzIGEgVHJhZGVyLCBzZXQgdGhlIG9wYWNpdHkgYmFjayB0byAxXG4gICAgICAgICAgICAgICAgICAgIGlmKG9iamVjdCBpbnN0YW5jZW9mIFRyYWRlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0LmRyYXdhYmxlLm9wYWNpdHkgPSAxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vaWYgdGhlIG9iamVjdCB3YXMgdGhlIGNhbnZhcywgY2xvc2UgYWxsIG9iamVjdHNcbiAgICAgICAgICAgICAgICAgICAgaWYob2JqZWN0ID09PSBcInNlbGZcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gMCwgbCA9IGNhbnZhcy5vYmplY3RzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYW52YXMub2JqZWN0c1tpXS5vcGVuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhcy5vYmplY3RzW2ldLmNsaWNrZWQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy9pZiB0aGUgb2JqZWN0cyBoYXMgYSBjbGlja2VkKCkgZnVuY3Rpb24sIGV4ZWN1dGUgaXRcbiAgICAgICAgICAgICAgICAgICAgaWYodHlwZW9mIG9iamVjdC5jbGlja2VkID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvYmplY3QuY2xpY2tlZCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy9pZiB0aGUgb2JqZWN0IHdhcyBkcmFnZ2VkXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy9pZiB0aGUgb2JqZWN0IGlzIGEgVHJhZGUsIHNldCBpdHMgb3BhY2l0eSBiYWNrIHRvIDFcbiAgICAgICAgICAgICAgICAgICAgaWYob2JqZWN0IGluc3RhbmNlb2YgVHJhZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdC5kcmF3YWJsZS5vcGFjaXR5ID0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vaWYgdGhlIG9iamVjdCB3YXMgaG92ZXJpbmcgb3ZlciB0aGUgdHJhc2ggY2FuLCByZW1vdmUgaXRcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRyYXNoLmludGVyYWN0aW9uKG5ldyBWZWN0b3IyRChlLnBhZ2VYLCBlLnBhZ2VZKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3QuZGVsZXRlKGNhbnZhcy5vYmplY3RzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvL2lmIHRoZSBvYmplY3QgaXMgYSBUcmFkZXIsIHNldCBpdHMgb3BhY2l0eSBiYWNrIHRvIDFcbiAgICAgICAgICAgICAgICAgICAgaWYob2JqZWN0IGluc3RhbmNlb2YgVHJhZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvYmplY3QuZHJhd2FibGUub3BhY2l0eSA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2lmIHRoZSBUcmFkZXIgaXNuJ3QgaW4gaXRzIG9yaWdpbmFsIHBvc2l0aW9uLCBhbmltYXRlIGl0IGJhY2sgdG8gdGhhdCBwb3NpdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYob2JqZWN0LmRyYXdhYmxlLnJldHVyblBvcy5sZW5ndGgoKSAhPT0gb2JqZWN0LmRyYXdhYmxlLnBvcy5sZW5ndGgoKSAmJiBvYmplY3QuZHJhd2FibGUucmV0dXJuUG9zLnggIT09IG9iamVjdC5kcmF3YWJsZS5wb3MueCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdC5kcmF3YWJsZS5hbmltYXRlVmVjdG9yKFwicG9zXCIsIG9iamVjdC5kcmF3YWJsZS5yZXR1cm5Qb3MsIDUwMCwgXCJlYXNlSW5PdXRcIiwgbnVsbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2lmIHRoZSBUcmFkZXIgd2FzIGhvdmVyaW5nIG92ZXIgdGhlIHRyYXNoIGNhbiwgcmVtb3ZlIGl0XG4gICAgICAgICAgICAgICAgICAgICAgICBpZih0cmFzaC5pbnRlcmFjdGlvbihuZXcgVmVjdG9yMkQoZS5wYWdlWCwgZS5wYWdlWSkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0LmRlbGV0ZShjYW52YXMub2JqZWN0cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy9yZXNldCB0aGUgdHJhc2ggY2FucyBjb2xvciBiYWNrIHRvIGdyYXksIHNlZWluZyBhcyBubyBvYmplY3QgaXMgc2VsZWN0ZWQgYW55bW9yZVxuICAgICAgICAgICAgICAgIHRyYXNoLmNvbG9yID0gXCIjZWVlZWVlXCI7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vcmVkcmF3IHRoZSBjYW52YXNcbiAgICAgICAgICAgIGNhbnZhcy5kcmF3KCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy93aGVuIHRoZSB1c2VyIHNjcm9sbHMgdGhlIG1vdXNlIHdoZWVsIHNvbWV3aGVyZSBvbiB0aGUgY2FudmFzXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidHJhZGVzXCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJ3aGVlbFwiLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICBzY3JvbGxJbnRlcmFjdGlvbihlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidHJhZGVzXCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJET01Nb3VzZVNjcm9sbFwiLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICBzY3JvbGxJbnRlcmFjdGlvbihlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHZhciBzY3JvbGxJbnRlcmFjdGlvbiA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIC8vZG9uJ3Qgc2Nyb2xsIHRoZSBwYWdlXG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAvL2Nyb3NzYnJvd3NlciBjYWxjdWxhdGlvbiBvZiB0aGUgZGlmZmVyZW5jZSBiZWluZyBzY3JvbGxlZFxuICAgICAgICAgICAgdmFyIGRlbHRhID0gMDtcbiAgICAgICAgICAgIGlmKHR5cGVvZiBlLndoZWVsRGVsdGEgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgZGVsdGEgPSBlLndoZWVsRGVsdGEgLyAzMDA7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGRlbHRhID0gLWUuZGV0YWlsIC8gNTA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL2NhbGN1bGF0ZSB0aGUgbmV3IHNjYWxlIGFuZCBtYWtlIHN1cmUgaXQgc3RheXMgaW4gYmV0d2VlbiB0aGUgbGltaXRzXG4gICAgICAgICAgICB2YXIgc2NhbGUgPSBjYW52YXMuc2NhbGUgKyBkZWx0YTtcbiAgICAgICAgICAgIGlmKHNjYWxlID4gMS44KSB7XG4gICAgICAgICAgICAgICAgc2NhbGUgPSAxLjg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZihzY2FsZSA8IDAuNCkge1xuICAgICAgICAgICAgICAgIHNjYWxlID0gMC40O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2NhbGUgPSBNYXRoLmZsb29yKHNjYWxlICogMTAwKSAvIDEwMDtcbiAgICAgICAgICAgIC8vc2V0IHRoZSBuZXcgc2NhbGUsIGRvbid0IHNjYWxlIHRoZSB0cmFzaCBjYW4sIGFwcGx5IHRoZSBzY2FsZSB0byB0aGUgc2xpZGVyIGFuZCByZWRyYXcgdGhlIGNhbnZhc1xuICAgICAgICAgICAgY2FudmFzLnNjYWxlID0gc2NhbGU7XG4gICAgICAgICAgICB0cmFzaC5yYWRpdXMgPSA1MCAvIGNhbnZhcy5zY2FsZTtcbiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2NhbGVDYW52YXNcIikudmFsdWUgPSBjYW52YXMuc2NhbGU7XG4gICAgICAgICAgICBjYW52YXMuZHJhdygpO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vd2hlbiBhIHVzZXIgdXNlcyB0aGUgc2xpZGVyLCBzY2FsZSB0aGUgY2FudmFzXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2NhbGVDYW52YXNcIikuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNhbnZhcy5zY2FsZSA9IHBhcnNlRmxvYXQodGhpcy52YWx1ZSk7XG4gICAgICAgICAgICB0cmFzaC5yYWRpdXMgPSA1MCAvIGNhbnZhcy5zY2FsZTtcbiAgICAgICAgICAgIGNhbnZhcy5kcmF3KCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vd2hlbiBhIHVzZXIgY2xpY2tzIHRoZSBjZW50ZXIgYnV0dG9uLCB0ZWxsIHRoZSBjYW52YXMgdG8gY2VudGVyIGl0c2VsZlxuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJlc2V0T2Zmc2V0XCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNhbnZhcy5tb3ZlVG9DZW50ZXIoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy93aGVuIGEgdXNlciByZXNpemVzIHRoZSBwYWdlLCByZXNpemUgdGhlIGNhbnZhcyBhbmQgcmVwb3NpdGlvbiB0aGUgdHJhc2ggY2FuXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY2FudmFzLnNldFNpemUod2luZG93LmlubmVyV2lkdGgsIHdpbmRvdy5pbm5lckhlaWdodCAtIDUwKTtcbiAgICAgICAgICAgIHRyYXNoLnBvcyA9IG5ldyBWZWN0b3IyRCh3aW5kb3cuaW5uZXJXaWR0aCAtIDEwMCwgd2luZG93LmlubmVySGVpZ2h0IC0gMTUwKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG59OyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
