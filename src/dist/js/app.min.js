function Trade(a,e,t,n,c,s){this.img=null,this.imgSrc=a,this.x=e,this.y=t,this.scX=n,this.scY=c,this.traders=s,this.percentage=0;for(var r=0;r<this.traders.length;r++)this.percentage+=this.traders[r].totalPercentage*this.traders[r].percentage;this.rad=50+100*this.percentage;var i=this,o=new Image;o.src=this.imgSrc,o.onload=function(){i.img=o}}function Trader(a,e){this.img=null,this.imgSrc=a,this.totalPercentage=e,this.percentage=0;var t=this,n=new Image;n.src=this.imgSrc,n.onload=function(){t.img=n}}function clear(){ctx.fillStyle="#eeeeee",ctx.fillRect(0,0,WIDTH,HEIGHT)}function draw(){clear();for(var a=0;a<trades.length;a++)trades[a].drawLine();for(var e=0;e<trades.length;e++)trades[e].draw();ctx.fillStyle="#2980b9",cir(cX()+xOff*scale,cY()+yOff*scale,75)}function myMove(a){dragging===canvas?(xOff+=(a.pageX-mouseX)*(1/scale),yOff+=(a.pageY-mouseY)*(1/scale),mouseX=a.pageX,mouseY=a.pageY):null!==dragging&&(dragging.scX=a.pageX-xOff*scale,dragging.scY=a.pageY-yOff*scale)}function myDown(a){clearInterval(movingCanvas),movingCanvas=null;for(var e=trades.length-1;e>=0;e--){var t=trades[e];if(Math.pow(a.pageX-(t.scX+xOff*scale),2)+Math.pow(a.pageY-(t.scY+yOff*scale),2)<=Math.pow(t.rad*scale,2)){dragging=t,trades.splice(e,1),trades.push(t),canvas.onmousemove=myMove;break}}null===dragging&&(dragging=canvas,mouseX=a.pageX,mouseY=a.pageY,canvas.onmousemove=myMove)}function myUp(){var a=sbfc(dragging.scX,dragging.scY);dragging.x=a[0],dragging.y=a[1],dragging=null,mouseX=null,mouseY=null,canvas.onmousemove=null}Trade.prototype.draw=function(){if(null!==this.img){cirImg(this.scX,this.scY,this.rad,this.img);for(var a=0;a<this.traders.length;a++){var e=this.traders[a];if(null!==e.img){var t=!0,n=!1,c=180/(this.traders.length+1),s=c*(a+1-(this.traders.length+1)/2);0>s&&(n=!0);var r=pointOnCurve((this.rad+30)*scale,s,t,n,this.scX,this.scY);cirImg(r[0],r[1],25,e.img)}}}},Trade.prototype.drawLine=function(){null!==this.img&&(ctx.strokeStyle="#2c3e50",ctx.lineWidth=.5*scale,ctx.beginPath(),ctx.moveTo(this.scX+xOff*scale,this.scY+yOff*scale),ctx.lineTo(cX()+xOff*scale,cY()+yOff*scale),ctx.stroke(),ctx.closePath())};var canvas,ctx,WIDTH,HEIGHT,xOff=0,yOff=0,mouseX=null,mouseY=null,trades=[],traders=[],scale=1,dragging=null,movingCanvas=null,logos=["logo0.png","logo1.jpg","logo2.jpg","logo3.png","logo4.png"],people=["trader0.jpg","trader1.jpg","trader2.jpg","trader3.jpg"];!function(){canvas=document.getElementById("trades"),canvas.width=window.innerWidth,canvas.height=window.innerHeight,canvas.onmousedown=myDown,canvas.onmouseup=myUp,WIDTH=window.innerWidth,HEIGHT=window.innerHeight,ctx=canvas.getContext("2d");for(var a=0;4>a;a++){var e=.15*Math.random()+.1;traders.push(new Trader("dist/images/"+people[a],e))}for(var t=0;5>t;t++){for(var n=Math.floor(Math.random()*WIDTH),c=Math.floor(Math.random()*HEIGHT),s=Math.floor(4*Math.random()+1),r=[],i=0;s>i;i++){var o=traders[i];o.percentage=.4*Math.random()+.1,r.push(o)}trades.push(new Trade("dist/images/"+logos[t],n,c,n,c,r))}document.getElementById("scaleCanvas").onmousemove=function(){scale=this.value;for(var a=trades.length-1;a>=0;a--){var e=trades[a],t=sfc(e.x,e.y);e.scX=t[0],e.scY=t[1]}},document.getElementById("resetOffset").onclick=function(){if(null===movingCanvas){var a=yOff/xOff;movingCanvas=setInterval(function(){0===xOff&&0===yOff&&(clearInterval(movingCanvas),movingCanvas=null),xOff-=xOff/30,Math.abs(xOff)<=1&&(xOff=0),isNaN(a)||(yOff=a*xOff),Math.abs(yOff)<=1&&(yOff=0)},10)}},setInterval(draw,10)}();var cX=function(){return WIDTH/2},cY=function(){return HEIGHT/2},sfc=function(a,e){var t=(e-cY())/(a-cX()),n=dfp(a,e,cX(),cY());n*=scale;var c=Math.atan(t)/Math.PI*180;return pointOnCurve(n,c,a>cX(),e>cY(),cX(),cY())},sbfc=function(a,e){var t=(e-cY())/(a-cX()),n=dfp(a,e,cX(),cY());n*=1/scale;var c=Math.atan(t)/Math.PI*180;return pointOnCurve(n,c,a>cX(),e>cY(),cX(),cY())},pointOnCurve=function(a,e,t,n,c,s){0>e&&(e=-e);var r=90-e,i=a*Math.sin(r/180*Math.PI),o=a*Math.sin(e/180*Math.PI);return t&&(i=-i),n&&(o=-o),[c-i,s-o]},dfp=function(a,e,t,n){return Math.sqrt(Math.pow(a-t,2)+Math.pow(e-n,2))},rect=function(a,e,t,n){ctx.beginPath();var c=a-t/2,s=e-n/2;ctx.rect(c,s,t*scale,n*scale),ctx.closePath(),ctx.fill()},cir=function(a,e,t){ctx.beginPath(),ctx.arc(a,e,t*scale,0,2*Math.PI,!1),ctx.closePath(),ctx.fill()},cirImg=function(a,e,t,n){ctx.fillStyle="#ffffff",cir(a+xOff*scale,e+yOff*scale,t),ctx.save(),ctx.beginPath(),ctx.arc(a+xOff*scale,e+yOff*scale,t*scale,0,2*Math.PI,!0),ctx.clip(),ctx.drawImage(n,a-t*scale+xOff*scale,e-t*scale+yOff*scale,t*scale*2,t*scale*2),ctx.restore(),ctx.beginPath(),ctx.arc(a+xOff*scale,e+yOff*scale,t*scale,0,2*Math.PI,!0),ctx.strokeStyle="#eeeeee",ctx.lineWidth=2,ctx.stroke(),ctx.closePath()};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRyYWRlLmpzIiwidHJhZGVyLmpzIiwiY2FudmFzQ29udHJvbC5qcyJdLCJuYW1lcyI6WyJUcmFkZSIsImltZ1NyYyIsIngiLCJ5Iiwic2NYIiwic2NZIiwidHJhZGVycyIsInRoaXMiLCJpbWciLCJwZXJjZW50YWdlIiwiaSIsImxlbmd0aCIsInRvdGFsUGVyY2VudGFnZSIsInJhZCIsIm1lIiwidGh1bWJJbWciLCJJbWFnZSIsInNyYyIsIm9ubG9hZCIsIlRyYWRlciIsImNsZWFyIiwiY3R4IiwiZmlsbFN0eWxlIiwiZmlsbFJlY3QiLCJXSURUSCIsIkhFSUdIVCIsImRyYXciLCJqIiwidHJhZGVzIiwiZHJhd0xpbmUiLCJjaXIiLCJjWCIsInhPZmYiLCJzY2FsZSIsImNZIiwieU9mZiIsIm15TW92ZSIsImUiLCJkcmFnZ2luZyIsImNhbnZhcyIsInBhZ2VYIiwibW91c2VYIiwicGFnZVkiLCJtb3VzZVkiLCJteURvd24iLCJjbGVhckludGVydmFsIiwibW92aW5nQ2FudmFzIiwidHJhZGUiLCJNYXRoIiwicG93Iiwic3BsaWNlIiwicHVzaCIsIm9ubW91c2Vtb3ZlIiwibXlVcCIsInAiLCJzYmZjIiwicHJvdG90eXBlIiwiY2lySW1nIiwidCIsIm1vcmVYIiwibW9yZVkiLCJjIiwiYW5nbGVZIiwicG9pbnRPbkN1cnZlIiwic3Ryb2tlU3R5bGUiLCJsaW5lV2lkdGgiLCJiZWdpblBhdGgiLCJtb3ZlVG8iLCJsaW5lVG8iLCJzdHJva2UiLCJjbG9zZVBhdGgiLCJsb2dvcyIsInBlb3BsZSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJ3aWR0aCIsIndpbmRvdyIsImlubmVyV2lkdGgiLCJoZWlnaHQiLCJpbm5lckhlaWdodCIsIm9ubW91c2Vkb3duIiwib25tb3VzZXVwIiwiZ2V0Q29udGV4dCIsInJhbmRvbSIsImZsb29yIiwiciIsInBwbCIsImsiLCJ2YWx1ZSIsInNmYyIsIm9uY2xpY2siLCJhIiwic2V0SW50ZXJ2YWwiLCJhYnMiLCJpc05hTiIsImQiLCJkZnAiLCJhdGFuIiwiUEkiLCJhbmdsZVgiLCJuWCIsInNpbiIsIm5ZIiwieDIiLCJ5MiIsInNxcnQiLCJyZWN0IiwibCIsInciLCJoIiwiZmlsbCIsImFyYyIsInNhdmUiLCJjbGlwIiwiZHJhd0ltYWdlIiwicmVzdG9yZSJdLCJtYXBwaW5ncyI6IkFBQUEsUUFBQUEsT0FBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsR0FDQUMsS0FBQUMsSUFBQSxLQUNBRCxLQUFBTixPQUFBQSxFQUNBTSxLQUFBTCxFQUFBQSxFQUNBSyxLQUFBSixFQUFBQSxFQUNBSSxLQUFBSCxJQUFBQSxFQUNBRyxLQUFBRixJQUFBQSxFQUNBRSxLQUFBRCxRQUFBQSxFQUNBQyxLQUFBRSxXQUFBLENBQ0EsS0FBQSxHQUFBQyxHQUFBLEVBQUFBLEVBQUFILEtBQUFELFFBQUFLLE9BQUFELElBQ0FILEtBQUFFLFlBQUFGLEtBQUFELFFBQUFJLEdBQUFFLGdCQUFBTCxLQUFBRCxRQUFBSSxHQUFBRCxVQUVBRixNQUFBTSxJQUFBLEdBQUEsSUFBQU4sS0FBQUUsVUFDQSxJQUFBSyxHQUFBUCxLQUNBUSxFQUFBLEdBQUFDLE1BQ0FELEdBQUFFLElBQUFWLEtBQUFOLE9BQ0FjLEVBQUFHLE9BQUEsV0FDQUosRUFBQU4sSUFBQU8sR0NqQkEsUUFBQUksUUFBQWxCLEVBQUFXLEdBQ0FMLEtBQUFDLElBQUEsS0FDQUQsS0FBQU4sT0FBQUEsRUFDQU0sS0FBQUssZ0JBQUFBLEVBQ0FMLEtBQUFFLFdBQUEsQ0FDQSxJQUFBSyxHQUFBUCxLQUNBUSxFQUFBLEdBQUFDLE1BQ0FELEdBQUFFLElBQUFWLEtBQUFOLE9BQ0FjLEVBQUFHLE9BQUEsV0FDQUosRUFBQU4sSUFBQU8sR0NtSkEsUUFBQUssU0FDQUMsSUFBQUMsVUFBQSxVQUNBRCxJQUFBRSxTQUFBLEVBQUEsRUFBQUMsTUFBQUMsUUFHQSxRQUFBQyxRQUNBTixPQUVBLEtBQUEsR0FBQU8sR0FBQSxFQUFBQSxFQUFBQyxPQUFBakIsT0FBQWdCLElBQ0FDLE9B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QTdDLElBQUEwRixJQUFBN0csRUFBQThCLEtBQUFDLE1BQUE5QixFQUFBZ0MsS0FBQUYsTUFBQXBCLEVBQUFvQixNQUFBLEVBQUEsRUFBQWUsS0FBQWtELElBQUEsR0FDQTdFLElBQUE0RixPQUNBNUYsSUFBQTZGLFVBQUExRyxFQUFBTixFQUFBVyxFQUFBb0IsTUFBQUQsS0FBQUMsTUFBQTlCLEVBQUFVLEVBQUFvQixNQUFBRSxLQUFBRixNQUFBcEIsRUFBQW9CLE1BQUEsRUFBQXBCLEVBQUFvQixNQUFBLEdBQ0FaLElBQUE4RixVQUNBOUYsSUFBQTZDLFlBQ0E3QyxJQUFBMEYsSUFBQTdHLEVBQUE4QixLQUFBQyxNQUFBOUIsRUFBQWdDLEtBQUFGLE1BQUFwQixFQUFBb0IsTUFBQSxFQUFBLEVBQUFlLEtBQUFrRCxJQUFBLEdBQ0E3RSxJQUFBMkMsWUFBQSxVQUNBM0MsSUFBQTRDLFVBQUEsRUFDQTVDLElBQUFnRCxTQUNBaEQsSUFBQWlEIiwiZmlsZSI6ImFwcC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBUcmFkZShpbWdTcmMsIHgsIHksIHNjWCwgc2NZLCB0cmFkZXJzKSB7XG4gICAgdGhpcy5pbWcgPSBudWxsO1xuICAgIHRoaXMuaW1nU3JjID0gaW1nU3JjO1xuICAgIHRoaXMueCA9IHg7XG4gICAgdGhpcy55ID0geTtcbiAgICB0aGlzLnNjWCA9IHNjWDtcbiAgICB0aGlzLnNjWSA9IHNjWTtcbiAgICB0aGlzLnRyYWRlcnMgPSB0cmFkZXJzO1xuICAgIHRoaXMucGVyY2VudGFnZSA9IDA7XG4gICAgZm9yKHZhciBpID0gMDsgaSA8IHRoaXMudHJhZGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzLnBlcmNlbnRhZ2UgKz0gdGhpcy50cmFkZXJzW2ldLnRvdGFsUGVyY2VudGFnZSAqIHRoaXMudHJhZGVyc1tpXS5wZXJjZW50YWdlO1xuICAgIH1cbiAgICB0aGlzLnJhZCA9IDUwICsgKHRoaXMucGVyY2VudGFnZSAqIDEwMCk7XG4gICAgdmFyIG1lID0gdGhpcztcbiAgICB2YXIgdGh1bWJJbWcgPSBuZXcgSW1hZ2UoKTtcbiAgICB0aHVtYkltZy5zcmMgPSB0aGlzLmltZ1NyYztcbiAgICB0aHVtYkltZy5vbmxvYWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgbWUuaW1nID0gdGh1bWJJbWc7XG4gICAgfTtcbn1cblxuVHJhZGUucHJvdG90eXBlLmRyYXcgPSBmdW5jdGlvbigpIHtcbiAgICBpZih0aGlzLmltZyAhPT0gbnVsbCkge1xuICAgICAgICBjaXJJbWcodGhpcy5zY1gsIHRoaXMuc2NZLCB0aGlzLnJhZCwgdGhpcy5pbWcpO1xuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy50cmFkZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHRoaXMudHJhZGVyc1tpXTtcbiAgICAgICAgICAgIGlmKHQuaW1nICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdmFyIG1vcmVYID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB2YXIgbW9yZVkgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB2YXIgYyA9IDE4MCAvICh0aGlzLnRyYWRlcnMubGVuZ3RoICsgMSk7XG4gICAgICAgICAgICAgICAgdmFyIGFuZ2xlWSA9IGMgKiAoaSArIDEgLSAoKHRoaXMudHJhZGVycy5sZW5ndGggKyAxKSAvIDIpKTtcbiAgICAgICAgICAgICAgICBpZihhbmdsZVkgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgIG1vcmVZID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHAgPSBwb2ludE9uQ3VydmUoKHRoaXMucmFkICsgMzApICogc2NhbGUsIGFuZ2xlWSwgbW9yZVgsIG1vcmVZLCB0aGlzLnNjWCwgdGhpcy5zY1kpO1xuICAgICAgICAgICAgICAgIGNpckltZyhwWzBdLCBwWzFdLCAyNSwgdC5pbWcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufTtcblxuVHJhZGUucHJvdG90eXBlLmRyYXdMaW5lID0gZnVuY3Rpb24oKSB7XG4gICAgaWYodGhpcy5pbWcgIT09IG51bGwpIHtcbiAgICAgICAgY3R4LnN0cm9rZVN0eWxlID0gXCIjMmMzZTUwXCI7XG4gICAgICAgIGN0eC5saW5lV2lkdGggPSAwLjUgKiBzY2FsZTtcbiAgICAgICAgY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgICBjdHgubW92ZVRvKHRoaXMuc2NYICsgKHhPZmYgKiBzY2FsZSksIHRoaXMuc2NZICsgKHlPZmYgKiBzY2FsZSkpO1xuICAgICAgICBjdHgubGluZVRvKGNYKCkgKyAoeE9mZiAqIHNjYWxlKSwgY1koKSArICh5T2ZmICogc2NhbGUpKTtcbiAgICAgICAgY3R4LnN0cm9rZSgpO1xuICAgICAgICBjdHguY2xvc2VQYXRoKCk7XG4gICAgfVxufTsiLCJmdW5jdGlvbiBUcmFkZXIoaW1nU3JjLCB0b3RhbFBlcmNlbnRhZ2UpIHtcbiAgICB0aGlzLmltZyA9IG51bGw7XG4gICAgdGhpcy5pbWdTcmMgPSBpbWdTcmM7XG4gICAgdGhpcy50b3RhbFBlcmNlbnRhZ2UgPSB0b3RhbFBlcmNlbnRhZ2U7XG4gICAgdGhpcy5wZXJjZW50YWdlID0gMDtcbiAgICB2YXIgbWUgPSB0aGlzO1xuICAgIHZhciB0aHVtYkltZyA9IG5ldyBJbWFnZSgpO1xuICAgIHRodW1iSW1nLnNyYyA9IHRoaXMuaW1nU3JjO1xuICAgIHRodW1iSW1nLm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBtZS5pbWcgPSB0aHVtYkltZztcbiAgICB9O1xufSIsInZhciBjYW52YXM7XG52YXIgY3R4O1xudmFyIFdJRFRIO1xudmFyIEhFSUdIVDtcbnZhciB4T2ZmID0gMDtcbnZhciB5T2ZmID0gMDtcbnZhciBtb3VzZVggPSBudWxsO1xudmFyIG1vdXNlWSA9IG51bGw7XG52YXIgdHJhZGVzID0gW107XG52YXIgdHJhZGVycyA9IFtdO1xudmFyIHNjYWxlID0gMTtcbnZhciBkcmFnZ2luZyA9IG51bGw7XG52YXIgbW92aW5nQ2FudmFzID0gbnVsbDtcbnZhciBsb2dvcyA9IFtcImxvZ28wLnBuZ1wiLCBcImxvZ28xLmpwZ1wiLCBcImxvZ28yLmpwZ1wiLCBcImxvZ28zLnBuZ1wiLCBcImxvZ280LnBuZ1wiXTtcbnZhciBwZW9wbGUgPSBbXCJ0cmFkZXIwLmpwZ1wiLCBcInRyYWRlcjEuanBnXCIsIFwidHJhZGVyMi5qcGdcIiwgXCJ0cmFkZXIzLmpwZ1wiXTtcblxuKGZ1bmN0aW9uKCkge1xuICAgIGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidHJhZGVzXCIpO1xuICAgIGNhbnZhcy53aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoO1xuICAgIGNhbnZhcy5oZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7XG4gICAgY2FudmFzLm9ubW91c2Vkb3duID0gbXlEb3duO1xuICAgIGNhbnZhcy5vbm1vdXNldXAgPSBteVVwO1xuICAgIFdJRFRIID0gd2luZG93LmlubmVyV2lkdGg7XG4gICAgSEVJR0hUID0gd2luZG93LmlubmVySGVpZ2h0O1xuICAgIGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XG5cbiAgICBmb3IodmFyIGogPSAwOyBqIDwgNDsgaisrKSB7XG4gICAgICAgIHZhciB0b3RhbFBlcmNlbnRhZ2UgPSAoTWF0aC5yYW5kb20oKSAqIDAuMTUpICsgMC4xMDtcbiAgICAgICAgdHJhZGVycy5wdXNoKG5ldyBUcmFkZXIoXCJkaXN0L2ltYWdlcy9cIiArIHBlb3BsZVtqXSwgdG90YWxQZXJjZW50YWdlKSk7XG4gICAgfVxuICAgIGZvcih2YXIgaSA9IDA7IGkgPCA1OyBpKyspIHtcbiAgICAgICAgdmFyIHggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBXSURUSCk7XG4gICAgICAgIHZhciB5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogSEVJR0hUKTtcbiAgICAgICAgdmFyIHIgPSBNYXRoLmZsb29yKChNYXRoLnJhbmRvbSgpICogNCkgKyAxKTtcbiAgICAgICAgdmFyIHBwbCA9IFtdO1xuICAgICAgICBmb3IodmFyIGsgPSAwOyBrIDwgcjsgaysrKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHRyYWRlcnNba107XG4gICAgICAgICAgICB0LnBlcmNlbnRhZ2UgPSAoTWF0aC5yYW5kb20oKSAqIDAuNCkgKyAwLjE7XG4gICAgICAgICAgICBwcGwucHVzaCh0KTtcbiAgICAgICAgfVxuICAgICAgICB0cmFkZXMucHVzaChuZXcgVHJhZGUoXCJkaXN0L2ltYWdlcy9cIiArIGxvZ29zW2ldLCB4LCB5LCB4LCB5LCBwcGwpKTtcbiAgICB9XG5cbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNjYWxlQ2FudmFzXCIpLm9ubW91c2Vtb3ZlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHNjYWxlID0gdGhpcy52YWx1ZTtcbiAgICAgICAgZm9yKHZhciBpID0gdHJhZGVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICB2YXIgdHJhZGUgPSB0cmFkZXNbaV07XG4gICAgICAgICAgICB2YXIgcCA9IHNmYyh0cmFkZS54LCB0cmFkZS55KTtcbiAgICAgICAgICAgIHRyYWRlLnNjWCA9IHBbMF07XG4gICAgICAgICAgICB0cmFkZS5zY1kgPSBwWzFdO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmVzZXRPZmZzZXRcIikub25jbGljayA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZihtb3ZpbmdDYW52YXMgPT09IG51bGwpIHtcbiAgICAgICAgICAgIHZhciBhID0geU9mZiAvIHhPZmY7XG4gICAgICAgICAgICBtb3ZpbmdDYW52YXMgPSBzZXRJbnRlcnZhbChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBpZih4T2ZmID09PSAwICYmIHlPZmYgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChtb3ZpbmdDYW52YXMpO1xuICAgICAgICAgICAgICAgICAgICBtb3ZpbmdDYW52YXMgPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB4T2ZmIC09ICh4T2ZmIC8gMzApO1xuICAgICAgICAgICAgICAgIGlmKE1hdGguYWJzKHhPZmYpIDw9IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgeE9mZiA9IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmKCFpc05hTihhKSkge1xuICAgICAgICAgICAgICAgICAgICB5T2ZmID0gKGEgKiB4T2ZmKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYoTWF0aC5hYnMoeU9mZikgPD0gMSkge1xuICAgICAgICAgICAgICAgICAgICB5T2ZmID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCAxMCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgc2V0SW50ZXJ2YWwoZHJhdywgMTApO1xuXG59KSgpO1xuXG52YXIgY1ggPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gKFdJRFRIIC8gMik7XG59O1xuXG52YXIgY1kgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gKEhFSUdIVCAvIDIpO1xufTtcblxudmFyIHNmYyA9IGZ1bmN0aW9uKHgsIHkpIHtcbiAgICB2YXIgYSA9ICh5IC0gY1koKSkvKHggLSBjWCgpKTtcbiAgICB2YXIgZCA9IGRmcCh4LCB5LCBjWCgpLCBjWSgpKTtcbiAgICBkID0gZCAqIHNjYWxlO1xuICAgIHZhciBhbmdsZVkgPSAoTWF0aC5hdGFuKGEpIC8gTWF0aC5QSSkgKiAxODA7XG4gICAgcmV0dXJuIHBvaW50T25DdXJ2ZShkLCBhbmdsZVksICh4ID4gY1goKSksICh5ID4gY1koKSksIGNYKCksIGNZKCkpO1xufTtcblxudmFyIHNiZmMgPSBmdW5jdGlvbih4LCB5KSB7XG4gICAgdmFyIGEgPSAoeSAtIGNZKCkpLyh4IC0gY1goKSk7XG4gICAgdmFyIGQgPSBkZnAoeCwgeSwgY1goKSwgY1koKSk7XG4gICAgZCA9IGQgKiAoMSAvIHNjYWxlKTtcbiAgICB2YXIgYW5nbGVZID0gKE1hdGguYXRhbihhKSAvIE1hdGguUEkpICogMTgwO1xuICAgIHJldHVybiBwb2ludE9uQ3VydmUoZCwgYW5nbGVZLCAoeCA+IGNYKCkpLCAoeSA+IGNZKCkpLCBjWCgpLCBjWSgpKTtcbn07XG5cbnZhciBwb2ludE9uQ3VydmUgPSBmdW5jdGlvbihkLCBhbmdsZVksIG1vcmVYLCBtb3JlWSwgeCwgeSkge1xuICAgIGlmKGFuZ2xlWSA8IDApIHtcbiAgICAgICAgYW5nbGVZID0gLWFuZ2xlWTtcbiAgICB9XG4gICAgdmFyIGFuZ2xlWCA9IDkwIC0gYW5nbGVZO1xuICAgIHZhciBuWCA9IGQgKiBNYXRoLnNpbigoKGFuZ2xlWCAvIDE4MCkgKiBNYXRoLlBJKSk7XG4gICAgdmFyIG5ZID0gZCAqIE1hdGguc2luKCgoYW5nbGVZIC8gMTgwKSAqIE1hdGguUEkpKTtcbiAgICBpZihtb3JlWCkge1xuICAgICAgICBuWCA9IC1uWDtcbiAgICB9XG4gICAgaWYobW9yZVkpIHtcbiAgICAgICAgblkgPSAtblk7XG4gICAgfVxuICAgIHJldHVybiBbeCAtIG5YLCB5IC0gblldO1xufTtcblxudmFyIGRmcCA9IGZ1bmN0aW9uKHgsIHksIHgyLCB5Mikge1xuICAgIHJldHVybiBNYXRoLnNxcnQoTWF0aC5wb3coKHggLSB4MiksIDIpICsgTWF0aC5wb3coKHkgLSB5MiksIDIpKTtcbn07XG5cbnZhciByZWN0ID0gZnVuY3Rpb24obCwgdCwgdywgaCkge1xuICAgIGN0eC5iZWdpblBhdGgoKTtcbiAgICB2YXIgeCA9IGwgLSAody8yKTtcbiAgICB2YXIgeSA9IHQgLSAoaC8yKTtcbiAgICBjdHgucmVjdCh4LCB5LCB3ICogc2NhbGUsIGggKiBzY2FsZSk7XG4gICAgY3R4LmNsb3NlUGF0aCgpO1xuICAgIGN0eC5maWxsKCk7XG59O1xuXG52YXIgY2lyID0gZnVuY3Rpb24oeCwgeSwgcmFkKSB7XG4gICAgY3R4LmJlZ2luUGF0aCgpO1xuICAgIGN0eC5hcmMoeCwgeSwgcmFkICogc2NhbGUsIDAsIDIgKiBNYXRoLlBJLCBmYWxzZSk7XG4gICAgY3R4LmNsb3NlUGF0aCgpO1xuICAgIGN0eC5maWxsKCk7XG59O1xuXG52YXIgY2lySW1nID0gZnVuY3Rpb24oeCwgeSwgcmFkLCBpbWcpIHtcbiAgICBjdHguZmlsbFN0eWxlID0gXCIjZmZmZmZmXCI7XG4gICAgY2lyKHggKyAoeE9mZiAqIHNjYWxlKSwgeSArICh5T2ZmICogc2NhbGUpLCByYWQpO1xuICAgIGN0eC5zYXZlKCk7XG4gICAgY3R4LmJlZ2luUGF0aCgpO1xuICAgIGN0eC5hcmMoeCArICh4T2ZmICogc2NhbGUpLCB5ICsgKHlPZmYgKiBzY2FsZSksIHJhZCAqIHNjYWxlLCAwLCBNYXRoLlBJICogMiwgdHJ1ZSk7XG4gICAgY3R4LmNsaXAoKTtcbiAgICBjdHguZHJhd0ltYWdlKGltZywgeCAtIChyYWQgKiBzY2FsZSkgKyAoeE9mZiAqIHNjYWxlKSwgeSAtIChyYWQgKiBzY2FsZSkgKyAoeU9mZiAqIHNjYWxlKSwgKHJhZCAqIHNjYWxlKSAqIDIsIChyYWQgKiBzY2FsZSkgKiAyKTtcbiAgICBjdHgucmVzdG9yZSgpO1xuICAgIGN0eC5iZWdpblBhdGgoKTtcbiAgICBjdHguYXJjKHggKyAoeE9mZiAqIHNjYWxlKSwgeSArICh5T2ZmICogc2NhbGUpLCByYWQgKiBzY2FsZSwgMCwgTWF0aC5QSSAqIDIsIHRydWUpO1xuICAgIGN0eC5zdHJva2VTdHlsZSA9IFwiI2VlZWVlZVwiO1xuICAgIGN0eC5saW5lV2lkdGggPSAyO1xuICAgIGN0eC5zdHJva2UoKTtcbiAgICBjdHguY2xvc2VQYXRoKCk7XG59O1xuXG5mdW5jdGlvbiBjbGVhcigpIHtcbiAgICBjdHguZmlsbFN0eWxlID0gXCIjZWVlZWVlXCI7XG4gICAgY3R4LmZpbGxSZWN0KDAsMCxXSURUSCxIRUlHSFQpO1xufVxuXG5mdW5jdGlvbiBkcmF3KCkge1xuICAgIGNsZWFyKCk7XG5cbiAgICBmb3IodmFyIGogPSAwOyBqIDwgdHJhZGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgIHRyYWRlc1tqXS5kcmF3TGluZSgpO1xuICAgIH1cblxuICAgIGZvcih2YXIgaSA9IDA7IGkgPCB0cmFkZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdHJhZGVzW2ldLmRyYXcoKTtcbiAgICB9XG5cbiAgICBjdHguZmlsbFN0eWxlID0gXCIjMjk4MGI5XCI7XG4gICAgY2lyKGNYKCkgKyAoeE9mZiAqIHNjYWxlKSwgY1koKSArICh5T2ZmICogc2NhbGUpLCA3NSk7XG59XG5cbmZ1bmN0aW9uIG15TW92ZShlKSB7XG4gICAgaWYoZHJhZ2dpbmcgPT09IGNhbnZhcykge1xuICAgICAgICB4T2ZmICs9IChlLnBhZ2VYIC0gbW91c2VYKSAqICgxIC8gc2NhbGUpO1xuICAgICAgICB5T2ZmICs9IChlLnBhZ2VZIC0gbW91c2VZKSAqICgxIC8gc2NhbGUpO1xuICAgICAgICBtb3VzZVggPSBlLnBhZ2VYO1xuICAgICAgICBtb3VzZVkgPSBlLnBhZ2VZO1xuICAgIH0gZWxzZSBpZihkcmFnZ2luZyAhPT0gbnVsbCkge1xuICAgICAgICBkcmFnZ2luZy5zY1ggPSAoZS5wYWdlWCAtICh4T2ZmICogc2NhbGUpKTtcbiAgICAgICAgZHJhZ2dpbmcuc2NZID0gKGUucGFnZVkgLSAoeU9mZiAqIHNjYWxlKSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBteURvd24oZSkge1xuICAgIGNsZWFySW50ZXJ2YWwobW92aW5nQ2FudmFzKTtcbiAgICBtb3ZpbmdDYW52YXMgPSBudWxsO1xuICAgIGZvcih2YXIgaSA9IHRyYWRlcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICB2YXIgdHJhZGUgPSB0cmFkZXNbaV07XG4gICAgICAgIGlmKChNYXRoLnBvdygoZS5wYWdlWCAtICh0cmFkZS5zY1ggKyAoeE9mZiAqIHNjYWxlKSkpLCAyKSArIE1hdGgucG93KChlLnBhZ2VZIC0gKHRyYWRlLnNjWSArICh5T2ZmICogc2NhbGUpKSksIDIpKSA8PSBNYXRoLnBvdygodHJhZGUucmFkICogc2NhbGUpLCAyKSkge1xuICAgICAgICAgICAgZHJhZ2dpbmcgPSB0cmFkZTtcbiAgICAgICAgICAgIHRyYWRlcy5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICB0cmFkZXMucHVzaCh0cmFkZSk7XG4gICAgICAgICAgICBjYW52YXMub25tb3VzZW1vdmUgPSBteU1vdmU7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZihkcmFnZ2luZyA9PT0gbnVsbCkge1xuICAgICAgICBkcmFnZ2luZyA9IGNhbnZhcztcbiAgICAgICAgbW91c2VYID0gZS5wYWdlWDtcbiAgICAgICAgbW91c2VZID0gZS5wYWdlWTtcbiAgICAgICAgY2FudmFzLm9ubW91c2Vtb3ZlID0gbXlNb3ZlO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gbXlVcCgpIHtcbiAgICB2YXIgcCA9IHNiZmMoZHJhZ2dpbmcuc2NYLCBkcmFnZ2luZy5zY1kpO1xuICAgIGRyYWdnaW5nLnggPSBwWzBdO1xuICAgIGRyYWdnaW5nLnkgPSBwWzFdO1xuICAgIGRyYWdnaW5nID0gbnVsbDtcbiAgICBtb3VzZVggPSBudWxsO1xuICAgIG1vdXNlWSA9IG51bGw7XG4gICAgY2FudmFzLm9ubW91c2Vtb3ZlID0gbnVsbDtcbn0iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
